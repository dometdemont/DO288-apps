<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>CMS5G Core Stack</title>
<style>{font-family: arial; font-size: small}body {font: 12px arial, sans-serif; color: #C6C9CA; background-color: black;}th, table { font: 12px arial, sans-serif; color: #C6C9CA; background-color: black;}h1, {color: #FF8300;}h2, h3, h4, h5 {color: #C6C9CA;}input, select {border: none; font: 12px arial, sans-serif; color: #01a982; background-color: black;}.buildButton { background-color: #FF8300; border: none; color: black; text-align: center; text-decoration: none; display: inline-block; border-radius: 2px;}.buildButton:hover { background-color: #4CAF50; color: white;}.helpButton { background-color: #32DAC8; border: none; color: black; text-align: center; text-decoration: none; display: inline-block; border-radius: 2px;}.helpButton:hover { background-color: blue; color: white;}.delButton { background-color: #0D5265; border: none; color: white; text-align: center; text-decoration: none; display: inline-block; border-radius: 2px;}.delButton:hover { background-color: #FF8300; color: black;}a:link, a:visited { text-decoration: none; color: #80746E;}</style><link href="data:image/x-icon;base64,AAABAAEAEBAAAAAAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAAAAAAAAAAAAAAAAAAAAAAAD///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////AYe0AP+ItAD/h7QA/4e0AP+ItAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4i0AP+HtAD/h7QA/4e0AP+ItAD/h7QA/4e0AP+HtAD/iLQA/4e0AP+HtAD/h7QA/4e0AP////8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wGHtAD/h7QA/4e0AP+HtAD/////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8Bh7QA/4i0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4i0AP+HtAD/iLQA/4i0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/iLQA/4e0AP+ItAD/h7QA/4e0AP+HtAD/iLQA/4e0AP+HtAD/h7QA/4e0AP+HtAD/iLQA/////wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8BAAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//w==" rel="icon" type="image/x-icon"></head>
<body>
<input id="_uniqueInputId" value="12" type="hidden" placeholder="Hidden input recording the html id for dynamic delete buttons">
<table border="0" width="100%">
<tbody><tr><td valign="top" align="left">
<h1>CMS5G Core Stack</h1>
<p><a id="vnfDescriptorWizardVersion" href="#endOfUserArea" title="Click to view version history" style="color: #01a982; text-decoration: underline;" onclick="versionHistory()">2020-06-11 Version 0.70</a></p>
<p>
<label for="quickDescription">Description :</label>
<input id="quickDescription" size="150" name="quickDescription" placeholder="One line CMS5G Core Stack stack description" value="Set of services with jenkins pipelines">
</p>
</td>
<td valign="top" align="right">
<img id="HPElogo" alt="logo.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU0AAACBCAYAAABErei/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABo/SURBVHhe7Z0JuFVV+YcXIgpqqDjhVGZqZWamleX0hAaBlg2PkuY8JIQpfzUnxKkcM6KQHMqhIjON1JzIoUwrMzKVnCg0ckYlJUVEAfd/veusb7POZp97z773XOVyf+/zfPfss9bae6+99tm/++019vJkTgghRFMsFz+FEEI0gURTCCEqINEUQogKSDSFEKICEk0hhKiARFMIISog0RRCiApINIUQogISTSGEqIBEUwghKiDRFEKICkg0hRCiAhJNIYSogERTCCEqINEUQogKSDSFEKICEk0hhKiARFMIISog0RRCiApINIUQogISTSGEqIBEUwghKiDRFEKICkg0hRCiAhJNIYSogERTCCEqINEUQogK9PJkcVt0lqyHFGWvXnFDiJ6HRLNVIJgr9nFuhRWce+utGLiM0du/mMx9vXZ9Ek7RQ5FotoJQgv7PAUNddtSeXljmh+BljlVXdr0OOde5qY9KNEWPRaLZCkw0hw9y2YjdnXttGRbN0ROce+AxiabosUg0W4GJ5p5eNEcmornSis4t183b2hYtcu71N2vbiOb/ne/c/TMkmqLHItFsBdYAtM9glx20q3PzvGhS/3fZzc694QWnVzcVTgRz4IDwz8AtWFgTzVHjnXt4pkRT9Fgkmq2g6GnOe8O5Pr1dr2HHLRbU7sq6a7ps0pjaNcnTFEL9NFtKUUf6rVD7RGC6o0HfeA1GT+lWJUQDJJpCCFEBiaYQQlRAoimEEBWQaAohRAUkmkIIUQGJZlcyP3YKp8W5OxrQz1QIkaN+mq0glKD/kw6jpHP7xGtqwtldRwXRuX2dNZw7aKhzb8bO7RpGKXo4Es1WUCaasHLf7iuYBsJJx3aQaAoh0WwJjURzWUOiKYREsyWYaO5vU8O9HoKXORDNQ5kabrpEU/RYJJqtwERz5X4u67/SMjwJcW/Xa/acWv2mRFP0UCSarcKEsycgwRQ9GImmEEJUQP00hRCiAhJNIYSogERTCCEqINEUQogKSDSFEKICEk0hhKiAuhy1kMxmBkrw5Ru3FtNsureLYn7eybwUKSurIm9nfpe2e1dGozJb2vLZXfHlKNFsBfxQ+/Xr51ZaaSX31ltvueWWW87997//DXHpj5V0q6yyiltxxRXDNmnnzJkT4t6JHzV56N+/v1t++eXD90WLFrn//e9/S8UDZg//Rz7yEffmm/VT1JG/xx57rDS8q7D8bLLJJm6FFVYI93j27Nlu1qxZS0V5geVxs802C/eUPL7wwgvBYGnJZ7fGF2Im65z5Ygw2fvx4/5tdzIABA0J4Me3kyZNjiizzopl5oV0i3dtlnHfq1KkxN1nmhb7TeWH/1NqKM0vTpGn5bI8ZM2ZkW2+9dZvHaoXZ8b1QxjNn2VVXXdXl561i5KNv376Z/2cSc5hlEyZMWKry2N1NdZot5JVXXolbNRYuXBi36jHPEp5//vng3b2TvPTSS3HLuRdffDFudQz/jLqJEye6G264wd10003u5JNPzr0fPv2Pzl1xxRXuN7/5jbvlllvcV77ylTyujEbhKXh+f//7393YsWPD92b26Qz2BgHFe740wO8pvY9z586NW6IVSDRFy/n85z/vPve5z7ldd93VDRo0KIbWQND23HNPt/vuu7shQ4a4LbfcMsY0x7x584JopUJvfPvb33bbbbdd/CZE1yDRXApBWNqyRmmMZsMtzj4BT7BIcZ+iGbadejavvvpq+EzTvfbaa3FrcTykaRoxatQot+aaa7o11lgj5PXYY4+NMTXGjBkTPi1vbVmRsjSptUfZPs1aSll80Rqlg3f6zWVZx//uQj2I6AT2Y8XTsVdEWHXVVcPrWypEpL388svdgQceGL4/99xzbqONNgoNGqSzY332s591++67b4i777773D333OOuvPLKEAcf+9jHgsf2xhtvBO9r/PjxYRve9773uREjRoTqgbvvvtvdeOONIRz233//vJFgypQp7s4773S33nqrGzx4cIh/9NFH3eabb57n2fJD49Vhhx3mhg0bFs5DfngFnzZtWogHvMctttjCHXXUUUHYgMaaH/3oR27llVcOjV4c98QTTwwNYfCHP/whnL9v377uzDPPzMsB7Nz2CaNHj3YTJkyoK6u//vWv7hOf+ETYfuaZZ9wGG2wQ4rlOXv+5HsqRuIceeiiU4/Tp00P64rkADxiPdfvttw+i/sADD7gLL7wwf+X95z//GY4NXBtlDVzD0UcfHa6td+/e4d6PGzcuiNj6668fvO9PfepTYV+O+/DDD7vrrrvO3XXXXWF/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">
</td>
</tr></tbody></table>

<h3>Summary: <a id="summary" href="#endOfUserArea">Outputs and Result<a href="#Networks" onclick="Networks.display(true);"> / Networks</a><a href="#Misc" onclick="Misc.display(true);"> / Misc</a><a href="#Nodes" onclick="Nodes.display(true);"> / Nodes</a><a href="#Flavors" onclick="Flavors.display(true);"> / Flavors</a><a href="#CinderVolumes" onclick="CinderVolumes.display(true);"> / CinderVolumes</a><a href="#PersistentVolumes" onclick="PersistentVolumes.display(true);"> / PersistentVolumes</a><a href="#Clusters" onclick="Clusters.display(true);"> / Clusters</a><a href="#NetworkFunctions" onclick="NetworkFunctions.display(true);"> / NetworkFunctions</a><a href="#DirectServices" onclick="DirectServices.display(true);"> / DirectServices</a><a href="#IndirectServices" onclick="IndirectServices.display(true);"> / IndirectServices</a><a href="#Operators" onclick="Operators.display(true);"> / Operators</a><a href="#HelmCharts" onclick="HelmCharts.display(true);"> / HelmCharts</a></a></h3>

<form>
<div id="tableInsertionPoint"><div id="NetworksSection" style="display: none;"><a name="Networks"><h2>Networks</h2></a><table border="1" id="Networks"><tbody><tr><th><input type="button" value="Add" onclick="Networks.add();"></th><th class="Networksnetwork" style="width: 80px;">network</th><th class="Networksinterface" style="width: 50px;">interface</th><th class="Networksmask" style="width: 120px;">mask</th><th class="Networksportgroup" style="width: 120px;">portgroup</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(Networks.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(Networks.help());"></div><div id="MiscSection" style="display: none;"><a name="Misc"><h2>Misc</h2></a><table border="1" id="Misc"><tbody><tr><th><input type="button" value="Add" onclick="Misc.add();"></th><th class="MiscProperty" style="width: 200px;">Property</th><th class="MiscValue" style="width: 400px;">Value</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(Misc.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(Misc.help());"></div><div id="NodesSection" style="display: none;"><a name="Nodes"><h2>Nodes</h2></a><table border="1" id="Nodes"><tbody><tr><th><input type="button" value="Add" onclick="Nodes.add();"></th><th class="NodesMGMT fqdn" style="width: 120px;">MGMT fqdn</th><th class="NodesMGMT IP addr" style="width: 120px;">MGMT IP addr</th><th class="NodesPUBLIC IP addr" style="width: 120px;">PUBLIC IP addr</th><th class="NodesMaster" style="width: 15px;">Master</th><th class="NodesEtcd" style="width: 15px;">Etcd</th><th class="NodesWorker" style="width: 15px;">Worker</th><th class="NodesTester" style="width: 15px;">Tester</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(Nodes.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(Nodes.help());"></div><div id="FlavorsSection" style="display: none;"><a name="Flavors"><h2>Flavors</h2></a><table border="1" id="Flavors"><tbody><tr><th><input type="button" value="Add" onclick="Flavors.add();"></th><th class="FlavorsInfrastructure" style="width: 100px;">Infrastructure</th><th class="FlavorsFlavor" style="width: 120px;">Flavor</th><th class="Flavorsname" style="width: 80px;">name</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(Flavors.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(Flavors.help());"></div><div id="CinderVolumesSection" style="display: none;"><a name="CinderVolumes"><h2>CinderVolumes</h2></a><table border="1" id="CinderVolumes"><tbody><tr><th><input type="button" value="Add" onclick="CinderVolumes.add();"></th><th class="CinderVolumesName" style="width: 120px;">Name</th><th class="CinderVolumesSize" style="width: 80px;">Size</th><th class="CinderVolumesDescription" style="width: 300px;">Description</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(CinderVolumes.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(CinderVolumes.help());"></div><div id="PersistentVolumesSection" style="display: none;"><a name="PersistentVolumes"><h2>PersistentVolumes</h2></a><table border="1" id="PersistentVolumes"><tbody><tr><th><input type="button" value="Add" onclick="PersistentVolumes.add();"></th><th class="PersistentVolumesName" style="width: 120px;">Name</th><th class="PersistentVolumesSize" style="width: 80px;">Size</th><th class="PersistentVolumesType" style="width: 80px;">Type</th><th class="PersistentVolumesAccess" style="width: 120px;">Access</th><th class="PersistentVolumesReclaim" style="width: 120px;">Reclaim</th><th class="PersistentVolumesCinderVolume" style="width: 120px;">CinderVolume</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(PersistentVolumes.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(PersistentVolumes.help());"></div><div id="ClustersSection" style="display: none;"><a name="Clusters"><h2>Clusters</h2></a><table border="1" id="Clusters"><tbody><tr><th><input type="button" value="Add" onclick="Clusters.add();"></th><th class="ClustersName" style="width: 80px;">Name</th><th class="ClustersEndpoint" style="width: 300px;">Endpoint</th><th class="ClustersToken" style="width: 200px;">Token</th><th class="ClustersTargeted" style="width: 15px;">Targeted</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(Clusters.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(Clusters.help());"></div><div id="NetworkFunctionsSection" style="display: none;"><a name="NetworkFunctions"><h2>NetworkFunctions</h2></a><table border="1" id="NetworkFunctions"><tbody><tr><th><input type="button" value="Add" onclick="NetworkFunctions.add();"></th><th class="NetworkFunctionsType" style="width: 100px;">Type</th><th class="NetworkFunctionsName" style="width: 80px;">Name</th><th class="NetworkFunctionsProject" style="width: 60px;">Project</th><th class="NetworkFunctionsURL" style="width: 200px;">URL</th><th class="NetworkFunctionsinsecure" style="width: 15px;">insecure</th><th class="NetworkFunctionsImage" style="width: 120px;">Image</th><th class="NetworkFunctionsTag" style="width: 120px;">Tag</th><th class="NetworkFunctionsStorage" style="width: 60px;">Storage</th><th class="NetworkFunctionsVolume" style="width: 60px;">Volume</th><th class="NetworkFunctionsReplicas" style="width: 40px;">Replicas</th><th class="NetworkFunctionsDependencies" style="width: 100px;">Dependencies</th><th class="NetworkFunctionsPipeline GIT" style="width: 200px;">Pipeline GIT</th><th class="NetworkFunctionsdirectory" style="width: 120px;">directory</th><th class="NetworkFunctionsbranch" style="width: 120px;">branch</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(NetworkFunctions.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(NetworkFunctions.help());"></div><div id="DirectServicesSection" style=""><a name="DirectServices"><h2>DirectServices</h2></a><table border="1" id="DirectServices"><tbody><tr><th><input type="button" value="Add" onclick="DirectServices.add();"></th><th class="DirectServicesType" style="width: 100px;">Type</th><th class="DirectServicesName" style="width: 80px;">Name</th><th class="DirectServicesProject" style="width: 60px;">Project</th><th class="DirectServicesURL" style="width: 200px;">URL</th><th class="DirectServicesinsecure" style="width: 15px;">insecure</th><th class="DirectServicesImage" style="width: 120px;">Image</th><th class="DirectServicesTag" style="width: 120px;">Tag</th><th class="DirectServicesStorage" style="width: 60px;">Storage</th><th class="DirectServicesVolume" style="width: 60px;">Volume</th><th class="DirectServicesReplicas" style="width: 40px;">Replicas</th><th class="DirectServicesDependencies" style="width: 100px;">Dependencies</th><th class="DirectServicesPipeline GIT" style="width: 200px;">Pipeline GIT</th><th class="DirectServicesdirectory" style="width: 120px;">directory</th><th class="DirectServicesbranch" style="width: 120px;">branch</th></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton1" onclick="DirectServices.delete('delButton1');"></td><td class="DirectServicesType" style="width: 100px;"><select class="DirectServicesType" style="width: 100px;"><option value="ignite" selected="selected">ignite</option><option value="redis">redis</option><option value="influxdb">influxdb</option><option value="fluentd">fluentd</option></select></td><td class="DirectServicesName" style="width: 80px;"><input class="DirectServicesName" type="text" value="gridgain" style="width: 80px;"></td><td class="DirectServicesProject" style="width: 60px;"><input class="DirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="DirectServicesURL" style="width: 200px;"><input class="DirectServicesURL" type="text" value="docker.io/gridgain" style="width: 200px;"></td><td class="DirectServicesinsecure" style="width: 15px;"><input class="DirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="DirectServicesImage" style="width: 120px;"><input class="DirectServicesImage" type="text" value="community" style="width: 120px;"></td><td class="DirectServicesTag" style="width: 120px;"><input class="DirectServicesTag" type="text" value="8.7.14" style="width: 120px;"></td><td class="DirectServicesStorage" style="width: 60px;"><input class="DirectServicesStorage" type="text" value="250Mi" style="width: 60px;"></td><td class="DirectServicesVolume" style="width: 60px;"><input class="DirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="DirectServicesReplicas" style="width: 40px;"><input class="DirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="DirectServicesDependencies" style="width: 100px;"><input class="DirectServicesDependencies" type="text" style="width: 100px;"></td><td class="DirectServicesPipeline GIT" style="width: 200px;"><input class="DirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="DirectServicesdirectory" style="width: 120px;"><input class="DirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="DirectServicesbranch" style="width: 120px;"><input class="DirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton2" onclick="DirectServices.delete('delButton2');"></td><td class="DirectServicesType" style="width: 100px;"><select class="DirectServicesType" style="width: 100px;"><option value="ignite">ignite</option><option value="redis">redis</option><option value="influxdb" selected="selected">influxdb</option><option value="fluentd">fluentd</option></select></td><td class="DirectServicesName" style="width: 80px;"><input class="DirectServicesName" type="text" value="udsf-flux" style="width: 80px;"></td><td class="DirectServicesProject" style="width: 60px;"><input class="DirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="DirectServicesURL" style="width: 200px;"><input class="DirectServicesURL" type="text" value="docker.io/bitnami" style="width: 200px;"></td><td class="DirectServicesinsecure" style="width: 15px;"><input class="DirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="DirectServicesImage" style="width: 120px;"><input class="DirectServicesImage" type="text" value="influxdb" style="width: 120px;"></td><td class="DirectServicesTag" style="width: 120px;"><input class="DirectServicesTag" type="text" value="1.7.10" style="width: 120px;"></td><td class="DirectServicesStorage" style="width: 60px;"><input class="DirectServicesStorage" type="text" value="1Gi" style="width: 60px;"></td><td class="DirectServicesVolume" style="width: 60px;"><input class="DirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="DirectServicesReplicas" style="width: 40px;"><input class="DirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="DirectServicesDependencies" style="width: 100px;"><input class="DirectServicesDependencies" type="text" style="width: 100px;"></td><td class="DirectServicesPipeline GIT" style="width: 200px;"><input class="DirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="DirectServicesdirectory" style="width: 120px;"><input class="DirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="DirectServicesbranch" style="width: 120px;"><input class="DirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton3" onclick="DirectServices.delete('delButton3');"></td><td class="DirectServicesType" style="width: 100px;"><select class="DirectServicesType" style="width: 100px;"><option value="ignite">ignite</option><option value="redis" selected="selected">redis</option><option value="influxdb">influxdb</option><option value="fluentd">fluentd</option></select></td><td class="DirectServicesName" style="width: 80px;"><input class="DirectServicesName" type="text" value="myredis" style="width: 80px;"></td><td class="DirectServicesProject" style="width: 60px;"><input class="DirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="DirectServicesURL" style="width: 200px;"><input class="DirectServicesURL" type="text" value="docker.io/bitnami" style="width: 200px;"></td><td class="DirectServicesinsecure" style="width: 15px;"><input class="DirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="DirectServicesImage" style="width: 120px;"><input class="DirectServicesImage" type="text" value="redis" style="width: 120px;"></td><td class="DirectServicesTag" style="width: 120px;"><input class="DirectServicesTag" type="text" value="latest" style="width: 120px;"></td><td class="DirectServicesStorage" style="width: 60px;"><input class="DirectServicesStorage" type="text" value="100Mi" style="width: 60px;"></td><td class="DirectServicesVolume" style="width: 60px;"><input class="DirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="DirectServicesReplicas" style="width: 40px;"><input class="DirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="DirectServicesDependencies" style="width: 100px;"><input class="DirectServicesDependencies" type="text" style="width: 100px;"></td><td class="DirectServicesPipeline GIT" style="width: 200px;"><input class="DirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="DirectServicesdirectory" style="width: 120px;"><input class="DirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="DirectServicesbranch" style="width: 120px;"><input class="DirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(DirectServices.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(DirectServices.help());"></div><div id="IndirectServicesSection" style=""><a name="IndirectServices"><h2>IndirectServices</h2></a><table border="1" id="IndirectServices"><tbody><tr><th><input type="button" value="Add" onclick="IndirectServices.add();"></th><th class="IndirectServicesType" style="width: 100px;">Type</th><th class="IndirectServicesName" style="width: 80px;">Name</th><th class="IndirectServicesProject" style="width: 60px;">Project</th><th class="IndirectServicesURL" style="width: 200px;">URL</th><th class="IndirectServicesinsecure" style="width: 15px;">insecure</th><th class="IndirectServicesImage" style="width: 120px;">Image</th><th class="IndirectServicesTag" style="width: 120px;">Tag</th><th class="IndirectServicesStorage" style="width: 60px;">Storage</th><th class="IndirectServicesVolume" style="width: 60px;">Volume</th><th class="IndirectServicesReplicas" style="width: 40px;">Replicas</th><th class="IndirectServicesDependencies" style="width: 100px;">Dependencies</th><th class="IndirectServicesPipeline GIT" style="width: 200px;">Pipeline GIT</th><th class="IndirectServicesdirectory" style="width: 120px;">directory</th><th class="IndirectServicesbranch" style="width: 120px;">branch</th></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton4" onclick="IndirectServices.delete('delButton4');"></td><td class="IndirectServicesType" style="width: 100px;"><select class="IndirectServicesType" style="width: 100px;"><option value="jenkins" selected="selected">jenkins</option><option value="elasticsearch">elasticsearch</option><option value="prometheus-alertmanager">prometheus-alertmanager</option><option value="prometheus">prometheus</option><option value="kube-state-metrics">kube-state-metrics</option><option value="pushgateway">pushgateway</option><option value="grafana">grafana</option></select></td><td class="IndirectServicesName" style="width: 80px;"><input class="IndirectServicesName" type="text" value="myjenkins" style="width: 80px;"></td><td class="IndirectServicesProject" style="width: 60px;"><input class="IndirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesURL" style="width: 200px;"><input class="IndirectServicesURL" type="text" value="quay.io/openshift" style="width: 200px;"></td><td class="IndirectServicesinsecure" style="width: 15px;"><input class="IndirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="IndirectServicesImage" style="width: 120px;"><input class="IndirectServicesImage" type="text" value="origin-jenkins" style="width: 120px;"></td><td class="IndirectServicesTag" style="width: 120px;"><input class="IndirectServicesTag" type="text" value="latest" style="width: 120px;"></td><td class="IndirectServicesStorage" style="width: 60px;"><input class="IndirectServicesStorage" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesVolume" style="width: 60px;"><input class="IndirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesReplicas" style="width: 40px;"><input class="IndirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="IndirectServicesDependencies" style="width: 100px;"><input class="IndirectServicesDependencies" type="text" style="width: 100px;"></td><td class="IndirectServicesPipeline GIT" style="width: 200px;"><input class="IndirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="IndirectServicesdirectory" style="width: 120px;"><input class="IndirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="IndirectServicesbranch" style="width: 120px;"><input class="IndirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton5" onclick="IndirectServices.delete('delButton5');"></td><td class="IndirectServicesType" style="width: 100px;"><select class="IndirectServicesType" style="width: 100px;"><option value="jenkins">jenkins</option><option value="elasticsearch" selected="selected">elasticsearch</option><option value="prometheus-alertmanager">prometheus-alertmanager</option><option value="prometheus">prometheus</option><option value="kube-state-metrics">kube-state-metrics</option><option value="pushgateway">pushgateway</option><option value="grafana">grafana</option></select></td><td class="IndirectServicesName" style="width: 80px;"><input class="IndirectServicesName" type="text" value="myelastic" style="width: 80px;"></td><td class="IndirectServicesProject" style="width: 60px;"><input class="IndirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesURL" style="width: 200px;"><input class="IndirectServicesURL" type="text" value="docker.elastic.co/elasticsearch" style="width: 200px;"></td><td class="IndirectServicesinsecure" style="width: 15px;"><input class="IndirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="IndirectServicesImage" style="width: 120px;"><input class="IndirectServicesImage" type="text" value="elasticsearch-oss" style="width: 120px;"></td><td class="IndirectServicesTag" style="width: 120px;"><input class="IndirectServicesTag" type="text" value="6.7.0" style="width: 120px;"></td><td class="IndirectServicesStorage" style="width: 60px;"><input class="IndirectServicesStorage" type="text" value="4Gi" style="width: 60px;"></td><td class="IndirectServicesVolume" style="width: 60px;"><input class="IndirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesReplicas" style="width: 40px;"><input class="IndirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="IndirectServicesDependencies" style="width: 100px;"><input class="IndirectServicesDependencies" type="text" style="width: 100px;"></td><td class="IndirectServicesPipeline GIT" style="width: 200px;"><input class="IndirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="IndirectServicesdirectory" style="width: 120px;"><input class="IndirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="IndirectServicesbranch" style="width: 120px;"><input class="IndirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton6" onclick="IndirectServices.delete('delButton6');"></td><td class="IndirectServicesType" style="width: 100px;"><select class="IndirectServicesType" style="width: 100px;"><option value="jenkins">jenkins</option><option value="elasticsearch">elasticsearch</option><option value="prometheus-alertmanager" selected="selected">prometheus-alertmanager</option><option value="prometheus">prometheus</option><option value="kube-state-metrics">kube-state-metrics</option><option value="pushgateway">pushgateway</option><option value="grafana">grafana</option></select></td><td class="IndirectServicesName" style="width: 80px;"><input class="IndirectServicesName" type="text" value="myalert" style="width: 80px;"></td><td class="IndirectServicesProject" style="width: 60px;"><input class="IndirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesURL" style="width: 200px;"><input class="IndirectServicesURL" type="text" value="docker.io/prom" style="width: 200px;"></td><td class="IndirectServicesinsecure" style="width: 15px;"><input class="IndirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="IndirectServicesImage" style="width: 120px;"><input class="IndirectServicesImage" type="text" value="alertmanager" style="width: 120px;"></td><td class="IndirectServicesTag" style="width: 120px;"><input class="IndirectServicesTag" type="text" value="v0.20.0" style="width: 120px;"></td><td class="IndirectServicesStorage" style="width: 60px;"><input class="IndirectServicesStorage" type="text" value="8Gi" style="width: 60px;"></td><td class="IndirectServicesVolume" style="width: 60px;"><input class="IndirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesReplicas" style="width: 40px;"><input class="IndirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="IndirectServicesDependencies" style="width: 100px;"><input class="IndirectServicesDependencies" type="text" style="width: 100px;"></td><td class="IndirectServicesPipeline GIT" style="width: 200px;"><input class="IndirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="IndirectServicesdirectory" style="width: 120px;"><input class="IndirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="IndirectServicesbranch" style="width: 120px;"><input class="IndirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton7" onclick="IndirectServices.delete('delButton7');"></td><td class="IndirectServicesType" style="width: 100px;"><select class="IndirectServicesType" style="width: 100px;"><option value="jenkins">jenkins</option><option value="elasticsearch">elasticsearch</option><option value="prometheus-alertmanager">prometheus-alertmanager</option><option value="prometheus" selected="selected">prometheus</option><option value="kube-state-metrics">kube-state-metrics</option><option value="pushgateway">pushgateway</option><option value="grafana">grafana</option></select></td><td class="IndirectServicesName" style="width: 80px;"><input class="IndirectServicesName" type="text" value="myprom" style="width: 80px;"></td><td class="IndirectServicesProject" style="width: 60px;"><input class="IndirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesURL" style="width: 200px;"><input class="IndirectServicesURL" type="text" value="docker.io/prom" style="width: 200px;"></td><td class="IndirectServicesinsecure" style="width: 15px;"><input class="IndirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="IndirectServicesImage" style="width: 120px;"><input class="IndirectServicesImage" type="text" value="prometheus" style="width: 120px;"></td><td class="IndirectServicesTag" style="width: 120px;"><input class="IndirectServicesTag" type="text" value="v2.16.0" style="width: 120px;"></td><td class="IndirectServicesStorage" style="width: 60px;"><input class="IndirectServicesStorage" type="text" value="200Mi" style="width: 60px;"></td><td class="IndirectServicesVolume" style="width: 60px;"><input class="IndirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesReplicas" style="width: 40px;"><input class="IndirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="IndirectServicesDependencies" style="width: 100px;"><input class="IndirectServicesDependencies" type="text" style="width: 100px;"></td><td class="IndirectServicesPipeline GIT" style="width: 200px;"><input class="IndirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="IndirectServicesdirectory" style="width: 120px;"><input class="IndirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="IndirectServicesbranch" style="width: 120px;"><input class="IndirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton8" onclick="IndirectServices.delete('delButton8');"></td><td class="IndirectServicesType" style="width: 100px;"><select class="IndirectServicesType" style="width: 100px;"><option value="jenkins">jenkins</option><option value="elasticsearch">elasticsearch</option><option value="prometheus-alertmanager">prometheus-alertmanager</option><option value="prometheus">prometheus</option><option value="kube-state-metrics">kube-state-metrics</option><option value="pushgateway" selected="selected">pushgateway</option><option value="grafana">grafana</option></select></td><td class="IndirectServicesName" style="width: 80px;"><input class="IndirectServicesName" type="text" value="mygateway" style="width: 80px;"></td><td class="IndirectServicesProject" style="width: 60px;"><input class="IndirectServicesProject" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesURL" style="width: 200px;"><input class="IndirectServicesURL" type="text" value="docker.io/prom" style="width: 200px;"></td><td class="IndirectServicesinsecure" style="width: 15px;"><input class="IndirectServicesinsecure" type="checkbox" style="width: 15px;"></td><td class="IndirectServicesImage" style="width: 120px;"><input class="IndirectServicesImage" type="text" value="pushgateway" style="width: 120px;"></td><td class="IndirectServicesTag" style="width: 120px;"><input class="IndirectServicesTag" type="text" value="v1.0.1" style="width: 120px;"></td><td class="IndirectServicesStorage" style="width: 60px;"><input class="IndirectServicesStorage" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesVolume" style="width: 60px;"><input class="IndirectServicesVolume" type="text" value="" style="width: 60px;"></td><td class="IndirectServicesReplicas" style="width: 40px;"><input class="IndirectServicesReplicas" type="text" value="1" style="width: 40px;"></td><td class="IndirectServicesDependencies" style="width: 100px;"><input class="IndirectServicesDependencies" type="text" style="width: 100px;"></td><td class="IndirectServicesPipeline GIT" style="width: 200px;"><input class="IndirectServicesPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="IndirectServicesdirectory" style="width: 120px;"><input class="IndirectServicesdirectory" type="text" value="" style="width: 120px;"></td><td class="IndirectServicesbranch" style="width: 120px;"><input class="IndirectServicesbranch" type="text" value="" style="width: 120px;"></td></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(IndirectServices.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(IndirectServices.help());"></div><div id="OperatorsSection" style=""><a name="Operators"><h2>Operators</h2></a><table border="1" id="Operators"><tbody><tr><th><input type="button" value="Add" onclick="Operators.add();"></th><th class="OperatorsType" style="width: 140px;">Type</th><th class="OperatorsName" style="width: 100px;">Name</th><th class="OperatorsProject" style="width: 60px;">Project</th><th class="OperatorsPipeline GIT" style="width: 200px;">Pipeline GIT</th><th class="Operatorsdirectory" style="width: 120px;">directory</th><th class="Operatorsbranch" style="width: 120px;">branch</th></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton9" onclick="Operators.delete('delButton9');"></td><td class="OperatorsType" style="width: 140px;"><select class="OperatorsType" style="width: 140px;"><option value="jaeger" selected="selected">jaeger</option><option value="kiali">kiali</option><option value="svc-mesh-ctlplane">svc-mesh-ctlplane</option><option value="kafka">kafka</option><option value="elasticSearchOperator">elasticSearchOperator</option></select></td><td class="OperatorsName" style="width: 100px;"><input class="OperatorsName" type="text" value="mike" style="width: 100px;"></td><td class="OperatorsProject" style="width: 60px;"><input class="OperatorsProject" type="text" value="" style="width: 60px;"></td><td class="OperatorsPipeline GIT" style="width: 200px;"><input class="OperatorsPipeline GIT" type="text" value="https://github.hpe.com/CMS-5GCS/automated-deployer" style="width: 200px;"></td><td class="Operatorsdirectory" style="width: 120px;"><input class="Operatorsdirectory" type="text" value="pipelines/manual_approval" style="width: 120px;"></td><td class="Operatorsbranch" style="width: 120px;"><input class="Operatorsbranch" type="text" value="master" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton10" onclick="Operators.delete('delButton10');"></td><td class="OperatorsType" style="width: 140px;"><select class="OperatorsType" style="width: 140px;"><option value="jaeger">jaeger</option><option value="kiali">kiali</option><option value="svc-mesh-ctlplane" selected="selected">svc-mesh-ctlplane</option><option value="kafka">kafka</option><option value="elasticSearchOperator">elasticSearchOperator</option></select></td><td class="OperatorsName" style="width: 100px;"><input class="OperatorsName" type="text" value="myplane" style="width: 100px;"></td><td class="OperatorsProject" style="width: 60px;"><input class="OperatorsProject" type="text" value="" style="width: 60px;"></td><td class="OperatorsPipeline GIT" style="width: 200px;"><input class="OperatorsPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="Operatorsdirectory" style="width: 120px;"><input class="Operatorsdirectory" type="text" value="" style="width: 120px;"></td><td class="Operatorsbranch" style="width: 120px;"><input class="Operatorsbranch" type="text" value="" style="width: 120px;"></td></tr><tr><td><input type="button" value="Del" class="delButton" id="delButton11" onclick="Operators.delete('delButton11');"></td><td class="OperatorsType" style="width: 140px;"><select class="OperatorsType" style="width: 140px;"><option value="jaeger">jaeger</option><option value="kiali">kiali</option><option value="svc-mesh-ctlplane">svc-mesh-ctlplane</option><option value="kafka" selected="selected">kafka</option><option value="elasticSearchOperator">elasticSearchOperator</option></select></td><td class="OperatorsName" style="width: 100px;"><input class="OperatorsName" type="text" value="kaaaaa" style="width: 100px;"></td><td class="OperatorsProject" style="width: 60px;"><input class="OperatorsProject" type="text" value="" style="width: 60px;"></td><td class="OperatorsPipeline GIT" style="width: 200px;"><input class="OperatorsPipeline GIT" type="text" value="" style="width: 200px;"></td><td class="Operatorsdirectory" style="width: 120px;"><input class="Operatorsdirectory" type="text" value="" style="width: 120px;"></td><td class="Operatorsbranch" style="width: 120px;"><input class="Operatorsbranch" type="text" value="" style="width: 120px;"></td></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(Operators.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(Operators.help());"></div><div id="HelmChartsSection" style="display: none;"><a name="HelmCharts"><h2>HelmCharts</h2></a><table border="1" id="HelmCharts"><tbody><tr><th><input type="button" value="Add" onclick="HelmCharts.add();"></th><th class="HelmChartsType" style="width: 140px;">Type</th><th class="HelmChartsName" style="width: 100px;">Name</th><th class="HelmChartsProject" style="width: 60px;">Project</th><th class="HelmChartsChart" style="width: 200px;">Chart</th><th class="HelmChartsValues" style="width: 200px;">Values</th><th class="HelmChartsPipeline GIT" style="width: 200px;">Pipeline GIT</th><th class="HelmChartsdirectory" style="width: 120px;">directory</th><th class="HelmChartsbranch" style="width: 120px;">branch</th></tr></tbody></table><table></table><input type="button" value="Apply" class="buildButton" onclick="userOutput(HelmCharts.build());"><input type="button" value="Help" class="helpButton" onclick="userOutput(HelmCharts.help());"></div></div>
</form>

<hr>

<table>
<tbody><tr><td valign="top"><fieldset>
    <legend>Build</legend>
<table>
<tbody><tr><td valign="top">Get help on the environment setup and topology definition</td><td valign="top"><input class="helpButton" type="button" value="Help" onclick="deploymentHelp()"></td>
</tr>
<tr><td valign="top">Build the installer deploying HPE5G resources on OpenShift clusters</td><td valign="top"><input class="buildButton" type="button" value="Resources" onclick="buildNetworkFunctions()"></td></tr>
<tr><td valign="top">Build the OpenStack Heat template deploying OpenShift version<select id="oc_version">
<option name="3.11">3.11</option>
<option name="3.9" selected="">3.9</option></select> and the HPE5G resources</td>
<td valign="top"><input class="buildButton" type="button" value="Full Stack" onclick="buildHeatTemplate()"></td> 
</tr>
</tbody></table>
</fieldset></td>
<td valign="top"><fieldset>
    <legend>Session</legend>
<table id="controlArea">
<tbody><tr><td valign="top" colspan="2">Get help</td><td valign="top"><input class="helpButton" type="button" value="Help" onclick="sessionHelp()"></td></tr>
<tr><td valign="top" colspan="2"><label>Save as html</label></td><td><input class="helpButton" type="button" value="Save" onclick="saveSession()"></td></tr>
<tr><td valign="top" colspan="2">View and save as Json</td><td valign="top"><input class="buildButton" type="button" value="Dump" onclick="jsonSession()"></td></tr>
</tbody><tr><td valign="top">Import...</td><td valign="top"><input type="file" id="importedSession_inputId" class="buildButton" onchange="importedSession.load(event)"></td><td valign="top"><input type="button" class="helpButton" value="Review" onclick="importedSession.view(event)"></td><td valign="top"><input type="button" class="delButton" value="Clear" onclick="importedSession.clear(event)"></td></tr></table>
</fieldset></td>
<td valign="top"><fieldset>
    <legend>Catalog</legend>
<table id="catalogArea">
<tbody><tr><td valign="top" colspan="2">Get help</td><td valign="top"><input class="helpButton" type="button" value="Help" onclick="catalogHelp()"></td></tr>
<tr>
<td valign="top" colspan="2">Display depth
<select id="catalog_display_depth">
<option>1</option>
<option>2</option>
<option selected="">all</option>
</select>ellipsis<select id="catalog_display_ellipse">
<option>50</option>
<option>200</option>
<option>1000</option>
<option selected="">none</option>
</select></td><td valign="top"><input class="helpButton" type="button" value="Display" onclick="displayCatalog()"></td>
</tr><tr><td valign="top" colspan="2">Export Json</td><td valign="top"><input class="buildButton" type="button" value="Export" onclick="exportCatalog()"></td></tr>
</tbody><tr><td valign="top">Import Json...</td><td valign="top"><input type="file" id="catalogImport_inputId" class="buildButton" onchange="catalogImport.load(event)"></td><td valign="top"><input type="button" class="helpButton" value="Review" onclick="catalogImport.view(event)"></td><td valign="top"><input type="button" class="delButton" value="Clear" onclick="catalogImport.clear(event)"></td></tr></table>
</fieldset></td>
</tr></tbody></table>

<!-- Link to the end of the user area, useful to focus the user on the result on long pages -->
<p>Quick links: <a id="endOfUserArea" href="#endOfUserArea">Outputs and Result<a href="#Networks" onclick="Networks.display(true);"> / Networks</a><a href="#Misc" onclick="Misc.display(true);"> / Misc</a><a href="#Nodes" onclick="Nodes.display(true);"> / Nodes</a><a href="#Flavors" onclick="Flavors.display(true);"> / Flavors</a><a href="#CinderVolumes" onclick="CinderVolumes.display(true);"> / CinderVolumes</a><a href="#PersistentVolumes" onclick="PersistentVolumes.display(true);"> / PersistentVolumes</a><a href="#Clusters" onclick="Clusters.display(true);"> / Clusters</a><a href="#NetworkFunctions" onclick="NetworkFunctions.display(true);"> / NetworkFunctions</a><a href="#DirectServices" onclick="DirectServices.display(true);"> / DirectServices</a><a href="#IndirectServices" onclick="IndirectServices.display(true);"> / IndirectServices</a><a href="#Operators" onclick="Operators.display(true);"> / Operators</a><a href="#HelmCharts" onclick="HelmCharts.display(true);"> / HelmCharts</a></a></p>
<p>
<textarea readonly="" rows="20" cols="200" id="userArea">Import summary
VNF description: Set of services with jenkins pipelines
DirectServices
	ignite	gridgain	docker.io/gridgain	community	8.7.14	250Mi	1
	influxdb	udsf-flux	docker.io/bitnami	influxdb	1.7.10	1Gi	1
	redis	myredis	docker.io/bitnami	redis	latest	100Mi	1
IndirectServices
	jenkins	myjenkins	quay.io/openshift	origin-jenkins	latest	1
	elasticsearch	myelastic	docker.elastic.co/elasticsearch	elasticsearch-oss	6.7.0	4Gi	1
	prometheus-alertmanager	myalert	docker.io/prom	alertmanager	v0.20.0	8Gi	1
	prometheus	myprom	docker.io/prom	prometheus	v2.16.0	200Mi	1
	pushgateway	mygateway	docker.io/prom	pushgateway	v1.0.1	1
Operators
	jaeger	mike	https://github.hpe.com/CMS-5GCS/automated-deployer	pipelines/manual_approval	master
	svc-mesh-ctlplane	myplane
	kafka	kaaaaa</textarea>
<a name="endOfUserArea"></a>
</p>
<iframe width="1500" height="200" name="importedDocument" style="display:none"></iframe>
<p class="copyright">© 2020 Hewlett Packard Enterprise Development LP</p>
<script>
// Gratitude to https://github.com/jeremyfa/yaml.js/blob/develop/dist/yaml.min.js for this minified YAML parser 
// Usage: YAML.parse(YAML string)
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){var Dumper,Inline,Utils;Utils=require("./Utils");Inline=require("./Inline");Dumper=function(){function Dumper(){}Dumper.indentation=4;Dumper.prototype.dump=function(input,inline,indent,exceptionOnInvalidType,objectEncoder){var i,key,len,output,prefix,value,willBeInlined;if(inline==null){inline=0}if(indent==null){indent=0}if(exceptionOnInvalidType==null){exceptionOnInvalidType=false}if(objectEncoder==null){objectEncoder=null}output="";if(typeof input==="function"){return output}prefix=indent?Utils.strRepeat(" ",indent):"";if(inline<=0||typeof input!=="object"||input instanceof Date||Utils.isEmpty(input)){output+=prefix+Inline.dump(input,exceptionOnInvalidType,objectEncoder)}else{if(input instanceof Array){for(i=0,len=input.length;i<len;i++){value=input[i];willBeInlined=inline-1<=0||typeof value!=="object"||Utils.isEmpty(value);output+=prefix+"-"+(willBeInlined?" ":"\n")+this.dump(value,inline-1,willBeInlined?0:indent+this.indentation,exceptionOnInvalidType,objectEncoder)+(willBeInlined?"\n":"")}}else{for(key in input){value=input[key];willBeInlined=inline-1<=0||typeof value!=="object"||Utils.isEmpty(value);output+=prefix+Inline.dump(key,exceptionOnInvalidType,objectEncoder)+":"+(willBeInlined?" ":"\n")+this.dump(value,inline-1,willBeInlined?0:indent+this.indentation,exceptionOnInvalidType,objectEncoder)+(willBeInlined?"\n":"")}}}return output};return Dumper}();module.exports=Dumper},{"./Inline":6,"./Utils":10}],2:[function(require,module,exports){var Escaper,Pattern;Pattern=require("./Pattern");Escaper=function(){var ch;function Escaper(){}Escaper.LIST_ESCAPEES=["\\","\\\\",'\\"','"',"\0","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","","","","","","","","","","","","","",(ch=String.fromCharCode)(133),ch(160),ch(8232),ch(8233)];Escaper.LIST_ESCAPED=["\\\\",'\\"','\\"','\\"',"\\0","\\x01","\\x02","\\x03","\\x04","\\x05","\\x06","\\a","\\b","\\t","\\n","\\v","\\f","\\r","\\x0e","\\x0f","\\x10","\\x11","\\x12","\\x13","\\x14","\\x15","\\x16","\\x17","\\x18","\\x19","\\x1a","\\e","\\x1c","\\x1d","\\x1e","\\x1f","\\N","\\_","\\L","\\P"];Escaper.MAPPING_ESCAPEES_TO_ESCAPED=function(){var i,j,mapping,ref;mapping={};for(i=j=0,ref=Escaper.LIST_ESCAPEES.length;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j){mapping[Escaper.LIST_ESCAPEES[i]]=Escaper.LIST_ESCAPED[i]}return mapping}();Escaper.PATTERN_CHARACTERS_TO_ESCAPE=new Pattern("[\\x00-\\x1f]|Â|Â |â¨|â©");Escaper.PATTERN_MAPPING_ESCAPEES=new Pattern(Escaper.LIST_ESCAPEES.join("|").split("\\").join("\\\\"));Escaper.PATTERN_SINGLE_QUOTING=new Pattern("[\\s'\":{}[\\],&*#?]|^[-?|<>=!%@`]");Escaper.requiresDoubleQuoting=function(value){return this.PATTERN_CHARACTERS_TO_ESCAPE.test(value)};Escaper.escapeWithDoubleQuotes=function(value){var result;result=this.PATTERN_MAPPING_ESCAPEES.replace(value,function(_this){return function(str){return _this.MAPPING_ESCAPEES_TO_ESCAPED[str]}}(this));return'"'+result+'"'};Escaper.requiresSingleQuoting=function(value){return this.PATTERN_SINGLE_QUOTING.test(value)};Escaper.escapeWithSingleQuotes=function(value){return"'"+value.replace(/'/g,"''")+"'"};return Escaper}();module.exports=Escaper},{"./Pattern":8}],3:[function(require,module,exports){var DumpException,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;DumpException=function(superClass){extend(DumpException,superClass);function DumpException(message,parsedLine,snippet){DumpException.__super__.constructor.call(this,message);this.message=message;this.parsedLine=parsedLine;this.snippet=snippet}DumpException.prototype.toString=function(){if(this.parsedLine!=null&&this.snippet!=null){return"<DumpException> "+this.message+" (line "+this.parsedLine+": '"+this.snippet+"')"}else{return"<DumpException> "+this.message}};return DumpException}(Error);module.exports=DumpException},{}],4:[function(require,module,exports){var ParseException,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;ParseException=function(superClass){extend(ParseException,superClass);function ParseException(message,parsedLine,snippet){ParseException.__super__.constructor.call(this,message);this.message=message;this.parsedLine=parsedLine;this.snippet=snippet}ParseException.prototype.toString=function(){if(this.parsedLine!=null&&this.snippet!=null){return"<ParseException> "+this.message+" (line "+this.parsedLine+": '"+this.snippet+"')"}else{return"<ParseException> "+this.message}};return ParseException}(Error);module.exports=ParseException},{}],5:[function(require,module,exports){var ParseMore,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;ParseMore=function(superClass){extend(ParseMore,superClass);function ParseMore(message,parsedLine,snippet){ParseMore.__super__.constructor.call(this,message);this.message=message;this.parsedLine=parsedLine;this.snippet=snippet}ParseMore.prototype.toString=function(){if(this.parsedLine!=null&&this.snippet!=null){return"<ParseMore> "+this.message+" (line "+this.parsedLine+": '"+this.snippet+"')"}else{return"<ParseMore> "+this.message}};return ParseMore}(Error);module.exports=ParseMore},{}],6:[function(require,module,exports){var DumpException,Escaper,Inline,ParseException,ParseMore,Pattern,Unescaper,Utils,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};Pattern=require("./Pattern");Unescaper=require("./Unescaper");Escaper=require("./Escaper");Utils=require("./Utils");ParseException=require("./Exception/ParseException");ParseMore=require("./Exception/ParseMore");DumpException=require("./Exception/DumpException");Inline=function(){function Inline(){}Inline.REGEX_QUOTED_STRING="(?:\"(?:[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\"|'(?:[^']*(?:''[^']*)*)')";Inline.PATTERN_TRAILING_COMMENTS=new Pattern("^\\s*#.*$");Inline.PATTERN_QUOTED_SCALAR=new Pattern("^"+Inline.REGEX_QUOTED_STRING);Inline.PATTERN_THOUSAND_NUMERIC_SCALAR=new Pattern("^(-|\\+)?[0-9,]+(\\.[0-9]+)?$");Inline.PATTERN_SCALAR_BY_DELIMITERS={};Inline.settings={};Inline.configure=function(exceptionOnInvalidType,objectDecoder){if(exceptionOnInvalidType==null){exceptionOnInvalidType=null}if(objectDecoder==null){objectDecoder=null}this.settings.exceptionOnInvalidType=exceptionOnInvalidType;this.settings.objectDecoder=objectDecoder};Inline.parse=function(value,exceptionOnInvalidType,objectDecoder){var context,result;if(exceptionOnInvalidType==null){exceptionOnInvalidType=false}if(objectDecoder==null){objectDecoder=null}this.settings.exceptionOnInvalidType=exceptionOnInvalidType;this.settings.objectDecoder=objectDecoder;if(value==null){return""}value=Utils.trim(value);if(0===value.length){return""}context={exceptionOnInvalidType:exceptionOnInvalidType,objectDecoder:objectDecoder,i:0};switch(value.charAt(0)){case"[":result=this.parseSequence(value,context);++context.i;break;case"{":result=this.parseMapping(value,context);++context.i;break;default:result=this.parseScalar(value,null,['"',"'"],context)}if(this.PATTERN_TRAILING_COMMENTS.replace(value.slice(context.i),"")!==""){throw new ParseException('Unexpected characters near "'+value.slice(context.i)+'".')}return result};Inline.dump=function(value,exceptionOnInvalidType,objectEncoder){var ref,result,type;if(exceptionOnInvalidType==null){exceptionOnInvalidType=false}if(objectEncoder==null){objectEncoder=null}if(value==null){return"null"}type=typeof value;if(type==="object"){if(value instanceof Date){return value.toISOString()}else if(objectEncoder!=null){result=objectEncoder(value);if(typeof result==="string"||result!=null){return result}}return this.dumpObject(value)}if(type==="boolean"){return value?"true":"false"}if(Utils.isDigits(value)){return type==="string"?"'"+value+"'":String(parseInt(value))}if(Utils.isNumeric(value)){return type==="string"?"'"+value+"'":String(parseFloat(value))}if(type==="number"){return value===Infinity?".Inf":value===-Infinity?"-.Inf":isNaN(value)?".NaN":value}if(Escaper.requiresDoubleQuoting(value)){return Escaper.escapeWithDoubleQuotes(value)}if(Escaper.requiresSingleQuoting(value)){return Escaper.escapeWithSingleQuotes(value)}if(""===value){return'""'}if(Utils.PATTERN_DATE.test(value)){return"'"+value+"'"}if((ref=value.toLowerCase())==="null"||ref==="~"||ref==="true"||ref==="false"){return"'"+value+"'"}return value};Inline.dumpObject=function(value,exceptionOnInvalidType,objectSupport){var j,key,len1,output,val;if(objectSupport==null){objectSupport=null}if(value instanceof Array){output=[];for(j=0,len1=value.length;j<len1;j++){val=value[j];output.push(this.dump(val))}return"["+output.join(", ")+"]"}else{output=[];for(key in value){val=value[key];output.push(this.dump(key)+": "+this.dump(val))}return"{"+output.join(", ")+"}"}};Inline.parseScalar=function(scalar,delimiters,stringDelimiters,context,evaluate){var i,joinedDelimiters,match,output,pattern,ref,ref1,strpos,tmp;if(delimiters==null){delimiters=null}if(stringDelimiters==null){stringDelimiters=['"',"'"]}if(context==null){context=null}if(evaluate==null){evaluate=true}if(context==null){context={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0}}i=context.i;if(ref=scalar.charAt(i),indexOf.call(stringDelimiters,ref)>=0){output=this.parseQuotedScalar(scalar,context);i=context.i;if(delimiters!=null){tmp=Utils.ltrim(scalar.slice(i)," ");if(!(ref1=tmp.charAt(0),indexOf.call(delimiters,ref1)>=0)){throw new ParseException("Unexpected characters ("+scalar.slice(i)+").")}}}else{if(!delimiters){output=scalar.slice(i);i+=output.length;strpos=output.indexOf(" #");if(strpos!==-1){output=Utils.rtrim(output.slice(0,strpos))}}else{joinedDelimiters=delimiters.join("|");pattern=this.PATTERN_SCALAR_BY_DELIMITERS[joinedDelimiters];if(pattern==null){pattern=new Pattern("^(.+?)("+joinedDelimiters+")");this.PATTERN_SCALAR_BY_DELIMITERS[joinedDelimiters]=pattern}if(match=pattern.exec(scalar.slice(i))){output=match[1];i+=output.length}else{throw new ParseException("Malformed inline YAML string ("+scalar+").")}}if(evaluate){output=this.evaluateScalar(output,context)}}context.i=i;return output};Inline.parseQuotedScalar=function(scalar,context){var i,match,output;i=context.i;if(!(match=this.PATTERN_QUOTED_SCALAR.exec(scalar.slice(i)))){throw new ParseMore("Malformed inline YAML string ("+scalar.slice(i)+").")}output=match[0].substr(1,match[0].length-2);if('"'===scalar.charAt(i)){output=Unescaper.unescapeDoubleQuotedString(output)}else{output=Unescaper.unescapeSingleQuotedString(output)}i+=match[0].length;context.i=i;return output};Inline.parseSequence=function(sequence,context){var e,error,i,isQuoted,len,output,ref,value;output=[];len=sequence.length;i=context.i;i+=1;while(i<len){context.i=i;switch(sequence.charAt(i)){case"[":output.push(this.parseSequence(sequence,context));i=context.i;break;case"{":output.push(this.parseMapping(sequence,context));i=context.i;break;case"]":return output;case",":case" ":case"\n":break;default:isQuoted=(ref=sequence.charAt(i))==='"'||ref==="'";value=this.parseScalar(sequence,[",","]"],['"',"'"],context);i=context.i;if(!isQuoted&&typeof value==="string"&&(value.indexOf(": ")!==-1||value.indexOf(":\n")!==-1)){try{value=this.parseMapping("{"+value+"}")}catch(error){e=error}}output.push(value);--i}++i}throw new ParseMore("Malformed inline YAML string "+sequence)};Inline.parseMapping=function(mapping,context){var done,i,key,len,output,shouldContinueWhileLoop,value;output={};len=mapping.length;i=context.i;i+=1;shouldContinueWhileLoop=false;while(i<len){context.i=i;switch(mapping.charAt(i)){case" ":case",":case"\n":++i;context.i=i;shouldContinueWhileLoop=true;break;case"}":return output}if(shouldContinueWhileLoop){shouldContinueWhileLoop=false;continue}key=this.parseScalar(mapping,[":"," ","\n"],['"',"'"],context,false);i=context.i;done=false;while(i<len){context.i=i;switch(mapping.charAt(i)){case"[":value=this.parseSequence(mapping,context);i=context.i;if(output[key]===void 0){output[key]=value}done=true;break;case"{":value=this.parseMapping(mapping,context);i=context.i;if(output[key]===void 0){output[key]=value}done=true;break;case":":case" ":case"\n":break;default:value=this.parseScalar(mapping,[",","}"],['"',"'"],context);i=context.i;if(output[key]===void 0){output[key]=value}done=true;--i}++i;if(done){break}}}throw new ParseMore("Malformed inline YAML string "+mapping)};Inline.evaluateScalar=function(scalar,context){var cast,date,exceptionOnInvalidType,firstChar,firstSpace,firstWord,objectDecoder,raw,scalarLower,subValue,trimmedScalar;scalar=Utils.trim(scalar);scalarLower=scalar.toLowerCase();switch(scalarLower){case"null":case"":case"~":return null;case"true":return true;case"false":return false;case".inf":return Infinity;case".nan":return NaN;case"-.inf":return Infinity;default:firstChar=scalarLower.charAt(0);switch(firstChar){case"!":firstSpace=scalar.indexOf(" ");if(firstSpace===-1){firstWord=scalarLower}else{firstWord=scalarLower.slice(0,firstSpace)}switch(firstWord){case"!":if(firstSpace!==-1){return parseInt(this.parseScalar(scalar.slice(2)))}return null;case"!str":return Utils.ltrim(scalar.slice(4));case"!!str":return Utils.ltrim(scalar.slice(5));case"!!int":return parseInt(this.parseScalar(scalar.slice(5)));case"!!bool":return Utils.parseBoolean(this.parseScalar(scalar.slice(6)),false);case"!!float":return parseFloat(this.parseScalar(scalar.slice(7)));case"!!timestamp":return Utils.stringToDate(Utils.ltrim(scalar.slice(11)));default:if(context==null){context={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0}}objectDecoder=context.objectDecoder,exceptionOnInvalidType=context.exceptionOnInvalidType;if(objectDecoder){trimmedScalar=Utils.rtrim(scalar);firstSpace=trimmedScalar.indexOf(" ");if(firstSpace===-1){return objectDecoder(trimmedScalar,null)}else{subValue=Utils.ltrim(trimmedScalar.slice(firstSpace+1));if(!(subValue.length>0)){subValue=null}return objectDecoder(trimmedScalar.slice(0,firstSpace),subValue)}}if(exceptionOnInvalidType){throw new ParseException("Custom object support when parsing a YAML file has been disabled.")}return null}break;case"0":if("0x"===scalar.slice(0,2)){return Utils.hexDec(scalar)}else if(Utils.isDigits(scalar)){return Utils.octDec(scalar)}else if(Utils.isNumeric(scalar)){return parseFloat(scalar)}else{return scalar}break;case"+":if(Utils.isDigits(scalar)){raw=scalar;cast=parseInt(raw);if(raw===String(cast)){return cast}else{return raw}}else if(Utils.isNumeric(scalar)){return parseFloat(scalar)}else if(this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(scalar)){return parseFloat(scalar.replace(",",""))}return scalar;case"-":if(Utils.isDigits(scalar.slice(1))){if("0"===scalar.charAt(1)){return-Utils.octDec(scalar.slice(1))}else{raw=scalar.slice(1);cast=parseInt(raw);if(raw===String(cast)){return-cast}else{return-raw}}}else if(Utils.isNumeric(scalar)){return parseFloat(scalar)}else if(this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(scalar)){return parseFloat(scalar.replace(",",""))}return scalar;default:if(date=Utils.stringToDate(scalar)){return date}else if(Utils.isNumeric(scalar)){return parseFloat(scalar)}else if(this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(scalar)){return parseFloat(scalar.replace(",",""))}return scalar}}};return Inline}();module.exports=Inline},{"./Escaper":2,"./Exception/DumpException":3,"./Exception/ParseException":4,"./Exception/ParseMore":5,"./Pattern":8,"./Unescaper":9,"./Utils":10}],7:[function(require,module,exports){var Inline,ParseException,ParseMore,Parser,Pattern,Utils;Inline=require("./Inline");Pattern=require("./Pattern");Utils=require("./Utils");ParseException=require("./Exception/ParseException");ParseMore=require("./Exception/ParseMore");Parser=function(){Parser.prototype.PATTERN_FOLDED_SCALAR_ALL=new Pattern("^(?:(?<type>![^\\|>]*)\\s+)?(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$");Parser.prototype.PATTERN_FOLDED_SCALAR_END=new Pattern("(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$");Parser.prototype.PATTERN_SEQUENCE_ITEM=new Pattern("^\\-((?<leadspaces>\\s+)(?<value>.+?))?\\s*$");Parser.prototype.PATTERN_ANCHOR_VALUE=new Pattern("^&(?<ref>[^ ]+) *(?<value>.*)");Parser.prototype.PATTERN_COMPACT_NOTATION=new Pattern("^(?<key>"+Inline.REGEX_QUOTED_STRING+"|[^ '\"\\{\\[].*?) *\\:(\\s+(?<value>.+?))?\\s*$");Parser.prototype.PATTERN_MAPPING_ITEM=new Pattern("^(?<key>"+Inline.REGEX_QUOTED_STRING+"|[^ '\"\\[\\{].*?) *\\:(\\s+(?<value>.+?))?\\s*$");Parser.prototype.PATTERN_DECIMAL=new Pattern("\\d+");Parser.prototype.PATTERN_INDENT_SPACES=new Pattern("^ +");Parser.prototype.PATTERN_TRAILING_LINES=new Pattern("(\n*)$");Parser.prototype.PATTERN_YAML_HEADER=new Pattern("^\\%YAML[: ][\\d\\.]+.*\n","m");Parser.prototype.PATTERN_LEADING_COMMENTS=new Pattern("^(\\#.*?\n)+","m");Parser.prototype.PATTERN_DOCUMENT_MARKER_START=new Pattern("^\\-\\-\\-.*?\n","m");Parser.prototype.PATTERN_DOCUMENT_MARKER_END=new Pattern("^\\.\\.\\.\\s*$","m");Parser.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION={};Parser.prototype.CONTEXT_NONE=0;Parser.prototype.CONTEXT_SEQUENCE=1;Parser.prototype.CONTEXT_MAPPING=2;function Parser(offset){this.offset=offset!=null?offset:0;this.lines=[];this.currentLineNb=-1;this.currentLine="";this.refs={}}Parser.prototype.parse=function(value,exceptionOnInvalidType,objectDecoder){var alias,allowOverwrite,block,c,context,data,e,error,error1,error2,first,i,indent,isRef,j,k,key,l,lastKey,len,len1,len2,len3,lineCount,m,matches,mergeNode,n,name,parsed,parsedItem,parser,ref,ref1,ref2,refName,refValue,val,values;if(exceptionOnInvalidType==null){exceptionOnInvalidType=false}if(objectDecoder==null){objectDecoder=null}this.currentLineNb=-1;this.currentLine="";this.lines=this.cleanup(value).split("\n");data=null;context=this.CONTEXT_NONE;allowOverwrite=false;while(this.moveToNextLine()){if(this.isCurrentLineEmpty()){continue}if("\t"===this.currentLine[0]){throw new ParseException("A YAML file cannot contain tabs as indentation.",this.getRealCurrentLineNb()+1,this.currentLine)}isRef=mergeNode=false;if(values=this.PATTERN_SEQUENCE_ITEM.exec(this.currentLine)){if(this.CONTEXT_MAPPING===context){throw new ParseException("You cannot define a sequence item when in a mapping")}context=this.CONTEXT_SEQUENCE;if(data==null){data=[]}if(values.value!=null&&(matches=this.PATTERN_ANCHOR_VALUE.exec(values.value))){isRef=matches.ref;values.value=matches.value}if(!(values.value!=null)||""===Utils.trim(values.value," ")||Utils.ltrim(values.value," ").indexOf("#")===0){if(this.currentLineNb<this.lines.length-1&&!this.isNextLineUnIndentedCollection()){c=this.getRealCurrentLineNb()+1;parser=new Parser(c);parser.refs=this.refs;data.push(parser.parse(this.getNextEmbedBlock(null,true),exceptionOnInvalidType,objectDecoder))}else{data.push(null)}}else{if(((ref=values.leadspaces)!=null?ref.length:void 0)&&(matches=this.PATTERN_COMPACT_NOTATION.exec(values.value))){c=this.getRealCurrentLineNb();parser=new Parser(c);parser.refs=this.refs;block=values.value;indent=this.getCurrentLineIndentation();if(this.isNextLineIndented(false)){block+="\n"+this.getNextEmbedBlock(indent+values.leadspaces.length+1,true)}data.push(parser.parse(block,exceptionOnInvalidType,objectDecoder))}else{data.push(this.parseValue(values.value,exceptionOnInvalidType,objectDecoder))}}}else if((values=this.PATTERN_MAPPING_ITEM.exec(this.currentLine))&&values.key.indexOf(" #")===-1){if(this.CONTEXT_SEQUENCE===context){throw new ParseException("You cannot define a mapping item when in a sequence")}context=this.CONTEXT_MAPPING;if(data==null){data={}}Inline.configure(exceptionOnInvalidType,objectDecoder);try{key=Inline.parseScalar(values.key)}catch(error){e=error;e.parsedLine=this.getRealCurrentLineNb()+1;e.snippet=this.currentLine;throw e}if("<<"===key){mergeNode=true;allowOverwrite=true;if(((ref1=values.value)!=null?ref1.indexOf("*"):void 0)===0){refName=values.value.slice(1);if(this.refs[refName]==null){throw new ParseException('Reference "'+refName+'" does not exist.',this.getRealCurrentLineNb()+1,this.currentLine)}refValue=this.refs[refName];if(typeof refValue!=="object"){throw new ParseException("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine)}if(refValue instanceof Array){for(i=j=0,len=refValue.length;j<len;i=++j){value=refValue[i];if(data[name=String(i)]==null){data[name]=value}}}else{for(key in refValue){value=refValue[key];if(data[key]==null){data[key]=value}}}}else{if(values.value!=null&&values.value!==""){value=values.value}else{value=this.getNextEmbedBlock()}c=this.getRealCurrentLineNb()+1;parser=new Parser(c);parser.refs=this.refs;parsed=parser.parse(value,exceptionOnInvalidType);if(typeof parsed!=="object"){throw new ParseException("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine)}if(parsed instanceof Array){for(l=0,len1=parsed.length;l<len1;l++){parsedItem=parsed[l];if(typeof parsedItem!=="object"){throw new ParseException("Merge items must be objects.",this.getRealCurrentLineNb()+1,parsedItem)}if(parsedItem instanceof Array){for(i=m=0,len2=parsedItem.length;m<len2;i=++m){value=parsedItem[i];k=String(i);if(!data.hasOwnProperty(k)){data[k]=value}}}else{for(key in parsedItem){value=parsedItem[key];if(!data.hasOwnProperty(key)){data[key]=value}}}}}else{for(key in parsed){value=parsed[key];if(!data.hasOwnProperty(key)){data[key]=value}}}}}else if(values.value!=null&&(matches=this.PATTERN_ANCHOR_VALUE.exec(values.value))){isRef=matches.ref;values.value=matches.value}if(mergeNode){}else if(!(values.value!=null)||""===Utils.trim(values.value," ")||Utils.ltrim(values.value," ").indexOf("#")===0){if(!this.isNextLineIndented()&&!this.isNextLineUnIndentedCollection()){if(allowOverwrite||data[key]===void 0){data[key]=null}}else{c=this.getRealCurrentLineNb()+1;parser=new Parser(c);parser.refs=this.refs;val=parser.parse(this.getNextEmbedBlock(),exceptionOnInvalidType,objectDecoder);if(allowOverwrite||data[key]===void 0){data[key]=val}}}else{val=this.parseValue(values.value,exceptionOnInvalidType,objectDecoder);if(allowOverwrite||data[key]===void 0){data[key]=val}}}else{lineCount=this.lines.length;if(1===lineCount||2===lineCount&&Utils.isEmpty(this.lines[1])){try{value=Inline.parse(this.lines[0],exceptionOnInvalidType,objectDecoder)}catch(error1){e=error1;e.parsedLine=this.getRealCurrentLineNb()+1;e.snippet=this.currentLine;throw e}if(typeof value==="object"){if(value instanceof Array){first=value[0]}else{for(key in value){first=value[key];break}}if(typeof first==="string"&&first.indexOf("*")===0){data=[];for(n=0,len3=value.length;n<len3;n++){alias=value[n];data.push(this.refs[alias.slice(1)])}value=data}}return value}else if((ref2=Utils.ltrim(value).charAt(0))==="["||ref2==="{"){try{return Inline.parse(value,exceptionOnInvalidType,objectDecoder)}catch(error2){e=error2;e.parsedLine=this.getRealCurrentLineNb()+1;e.snippet=this.currentLine;throw e}}throw new ParseException("Unable to parse.",this.getRealCurrentLineNb()+1,this.currentLine)}if(isRef){if(data instanceof Array){this.refs[isRef]=data[data.length-1]}else{lastKey=null;for(key in data){lastKey=key}this.refs[isRef]=data[lastKey]}}}if(Utils.isEmpty(data)){return null}else{return data}};Parser.prototype.getRealCurrentLineNb=function(){return this.currentLineNb+this.offset};Parser.prototype.getCurrentLineIndentation=function(){return this.currentLine.length-Utils.ltrim(this.currentLine," ").length};Parser.prototype.getNextEmbedBlock=function(indentation,includeUnindentedCollection){var data,indent,isItUnindentedCollection,newIndent,removeComments,removeCommentsPattern,unindentedEmbedBlock;if(indentation==null){indentation=null}if(includeUnindentedCollection==null){includeUnindentedCollection=false}this.moveToNextLine();if(indentation==null){newIndent=this.getCurrentLineIndentation();unindentedEmbedBlock=this.isStringUnIndentedCollectionItem(this.currentLine);if(!this.isCurrentLineEmpty()&&0===newIndent&&!unindentedEmbedBlock){throw new ParseException("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}}else{newIndent=indentation}data=[this.currentLine.slice(newIndent)];if(!includeUnindentedCollection){isItUnindentedCollection=this.isStringUnIndentedCollectionItem(this.currentLine)}removeCommentsPattern=this.PATTERN_FOLDED_SCALAR_END;removeComments=!removeCommentsPattern.test(this.currentLine);while(this.moveToNextLine()){indent=this.getCurrentLineIndentation();if(indent===newIndent){removeComments=!removeCommentsPattern.test(this.currentLine)}if(removeComments&&this.isCurrentLineComment()){continue}if(this.isCurrentLineBlank()){data.push(this.currentLine.slice(newIndent));continue}if(isItUnindentedCollection&&!this.isStringUnIndentedCollectionItem(this.currentLine)&&indent===newIndent){this.moveToPreviousLine();break}if(indent>=newIndent){data.push(this.currentLine.slice(newIndent))}else if(Utils.ltrim(this.currentLine).charAt(0)==="#"){}else if(0===indent){this.moveToPreviousLine();break}else{throw new ParseException("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}}return data.join("\n")};Parser.prototype.moveToNextLine=function(){if(this.currentLineNb>=this.lines.length-1){return false}this.currentLine=this.lines[++this.currentLineNb];return true};Parser.prototype.moveToPreviousLine=function(){this.currentLine=this.lines[--this.currentLineNb]};Parser.prototype.parseValue=function(value,exceptionOnInvalidType,objectDecoder){var e,error,foldedIndent,matches,modifiers,pos,ref,ref1,val;if(0===value.indexOf("*")){pos=value.indexOf("#");if(pos!==-1){value=value.substr(1,pos-2)}else{value=value.slice(1)}if(this.refs[value]===void 0){throw new ParseException('Reference "'+value+'" does not exist.',this.currentLine)}return this.refs[value]}if(matches=this.PATTERN_FOLDED_SCALAR_ALL.exec(value)){modifiers=(ref=matches.modifiers)!=null?ref:"";foldedIndent=Math.abs(parseInt(modifiers));if(isNaN(foldedIndent)){foldedIndent=0}val=this.parseFoldedScalar(matches.separator,this.PATTERN_DECIMAL.replace(modifiers,""),foldedIndent);if(matches.type!=null){Inline.configure(exceptionOnInvalidType,objectDecoder);return Inline.parseScalar(matches.type+" "+val)}else{return val}}if((ref1=value.charAt(0))==="["||ref1==="{"||ref1==='"'||ref1==="'"){while(true){try{return Inline.parse(value,exceptionOnInvalidType,objectDecoder)}catch(error){e=error;if(e instanceof ParseMore&&this.moveToNextLine()){value+="\n"+Utils.trim(this.currentLine," ")}else{e.parsedLine=this.getRealCurrentLineNb()+1;e.snippet=this.currentLine;throw e}}}}else{if(this.isNextLineIndented()){value+="\n"+this.getNextEmbedBlock()}return Inline.parse(value,exceptionOnInvalidType,objectDecoder)}};Parser.prototype.parseFoldedScalar=function(separator,indicator,indentation){var isCurrentLineBlank,j,len,line,matches,newText,notEOF,pattern,ref,text;if(indicator==null){indicator=""}if(indentation==null){indentation=0}notEOF=this.moveToNextLine();if(!notEOF){return""}isCurrentLineBlank=this.isCurrentLineBlank();text="";while(notEOF&&isCurrentLineBlank){if(notEOF=this.moveToNextLine()){text+="\n";isCurrentLineBlank=this.isCurrentLineBlank()}}if(0===indentation){if(matches=this.PATTERN_INDENT_SPACES.exec(this.currentLine)){indentation=matches[0].length}}if(indentation>0){pattern=this.PATTERN_FOLDED_SCALAR_BY_INDENTATION[indentation];if(pattern==null){pattern=new Pattern("^ {"+indentation+"}(.*)$");Parser.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION[indentation]=pattern}while(notEOF&&(isCurrentLineBlank||(matches=pattern.exec(this.currentLine)))){if(isCurrentLineBlank){text+=this.currentLine.slice(indentation)}else{text+=matches[1]}if(notEOF=this.moveToNextLine()){text+="\n";isCurrentLineBlank=this.isCurrentLineBlank()}}}else if(notEOF){text+="\n"}if(notEOF){this.moveToPreviousLine()}if(">"===separator){newText="";ref=text.split("\n");for(j=0,len=ref.length;j<len;j++){line=ref[j];if(line.length===0||line.charAt(0)===" "){newText=Utils.rtrim(newText," ")+line+"\n"}else{newText+=line+" "}}text=newText}if("+"!==indicator){text=Utils.rtrim(text)}if(""===indicator){text=this.PATTERN_TRAILING_LINES.replace(text,"\n")}else if("-"===indicator){text=this.PATTERN_TRAILING_LINES.replace(text,"")}return text};Parser.prototype.isNextLineIndented=function(ignoreComments){var EOF,currentIndentation,ret;if(ignoreComments==null){ignoreComments=true}currentIndentation=this.getCurrentLineIndentation();EOF=!this.moveToNextLine();if(ignoreComments){while(!EOF&&this.isCurrentLineEmpty()){EOF=!this.moveToNextLine()}}else{while(!EOF&&this.isCurrentLineBlank()){EOF=!this.moveToNextLine()}}if(EOF){return false}ret=false;if(this.getCurrentLineIndentation()>currentIndentation){ret=true}this.moveToPreviousLine();return ret};Parser.prototype.isCurrentLineEmpty=function(){var trimmedLine;trimmedLine=Utils.trim(this.currentLine," ");return trimmedLine.length===0||trimmedLine.charAt(0)==="#"};Parser.prototype.isCurrentLineBlank=function(){return""===Utils.trim(this.currentLine," ")};Parser.prototype.isCurrentLineComment=function(){var ltrimmedLine;ltrimmedLine=Utils.ltrim(this.currentLine," ");return ltrimmedLine.charAt(0)==="#"};Parser.prototype.cleanup=function(value){var count,i,indent,j,l,len,len1,line,lines,ref,ref1,ref2,smallestIndent,trimmedValue;if(value.indexOf("\r")!==-1){value=value.split("\r\n").join("\n").split("\r").join("\n")}count=0;ref=this.PATTERN_YAML_HEADER.replaceAll(value,""),value=ref[0],count=ref[1];this.offset+=count;ref1=this.PATTERN_LEADING_COMMENTS.replaceAll(value,"",1),trimmedValue=ref1[0],count=ref1[1];if(count===1){this.offset+=Utils.subStrCount(value,"\n")-Utils.subStrCount(trimmedValue,"\n");value=trimmedValue}ref2=this.PATTERN_DOCUMENT_MARKER_START.replaceAll(value,"",1),trimmedValue=ref2[0],count=ref2[1];if(count===1){this.offset+=Utils.subStrCount(value,"\n")-Utils.subStrCount(trimmedValue,"\n");value=trimmedValue;value=this.PATTERN_DOCUMENT_MARKER_END.replace(value,"")}lines=value.split("\n");smallestIndent=-1;for(j=0,len=lines.length;j<len;j++){line=lines[j];if(Utils.trim(line," ").length===0){continue}indent=line.length-Utils.ltrim(line).length;if(smallestIndent===-1||indent<smallestIndent){smallestIndent=indent}}if(smallestIndent>0){for(i=l=0,len1=lines.length;l<len1;i=++l){line=lines[i];lines[i]=line.slice(smallestIndent)}value=lines.join("\n")}return value};Parser.prototype.isNextLineUnIndentedCollection=function(currentIndentation){var notEOF,ret;if(currentIndentation==null){currentIndentation=null}if(currentIndentation==null){currentIndentation=this.getCurrentLineIndentation()}notEOF=this.moveToNextLine();while(notEOF&&this.isCurrentLineEmpty()){notEOF=this.moveToNextLine()}if(false===notEOF){return false}ret=false;if(this.getCurrentLineIndentation()===currentIndentation&&this.isStringUnIndentedCollectionItem(this.currentLine)){ret=true}this.moveToPreviousLine();return ret};Parser.prototype.isStringUnIndentedCollectionItem=function(){return this.currentLine==="-"||this.currentLine.slice(0,2)==="- "};return Parser}();module.exports=Parser},{"./Exception/ParseException":4,"./Exception/ParseMore":5,"./Inline":6,"./Pattern":8,"./Utils":10}],8:[function(require,module,exports){var Pattern;Pattern=function(){Pattern.prototype.regex=null;Pattern.prototype.rawRegex=null;Pattern.prototype.cleanedRegex=null;Pattern.prototype.mapping=null;function Pattern(rawRegex,modifiers){var _char,capturingBracketNumber,cleanedRegex,i,len,mapping,name,part,subChar;if(modifiers==null){modifiers=""}cleanedRegex="";len=rawRegex.length;mapping=null;capturingBracketNumber=0;i=0;while(i<len){_char=rawRegex.charAt(i);if(_char==="\\"){cleanedRegex+=rawRegex.slice(i,+(i+1)+1||9e9);i++}else if(_char==="("){if(i<len-2){part=rawRegex.slice(i,+(i+2)+1||9e9);if(part==="(?:"){i+=2;cleanedRegex+=part}else if(part==="(?<"){capturingBracketNumber++;i+=2;name="";while(i+1<len){subChar=rawRegex.charAt(i+1);if(subChar===">"){cleanedRegex+="(";i++;if(name.length>0){if(mapping==null){mapping={}}mapping[name]=capturingBracketNumber}break}else{name+=subChar}i++}}else{cleanedRegex+=_char;capturingBracketNumber++}}else{cleanedRegex+=_char}}else{cleanedRegex+=_char}i++}this.rawRegex=rawRegex;this.cleanedRegex=cleanedRegex;this.regex=new RegExp(this.cleanedRegex,"g"+modifiers.replace("g",""));this.mapping=mapping}Pattern.prototype.exec=function(str){var index,matches,name,ref;this.regex.lastIndex=0;matches=this.regex.exec(str);if(matches==null){return null}if(this.mapping!=null){ref=this.mapping;for(name in ref){index=ref[name];matches[name]=matches[index]}}return matches};Pattern.prototype.test=function(str){this.regex.lastIndex=0;return this.regex.test(str)};Pattern.prototype.replace=function(str,replacement){this.regex.lastIndex=0;return str.replace(this.regex,replacement)};Pattern.prototype.replaceAll=function(str,replacement,limit){var count;if(limit==null){limit=0}this.regex.lastIndex=0;count=0;while(this.regex.test(str)&&(limit===0||count<limit)){this.regex.lastIndex=0;str=str.replace(this.regex,replacement);count++}return[str,count]};return Pattern}();module.exports=Pattern},{}],9:[function(require,module,exports){var Pattern,Unescaper,Utils;Utils=require("./Utils");Pattern=require("./Pattern");Unescaper=function(){function Unescaper(){}Unescaper.PATTERN_ESCAPED_CHARACTER=new Pattern('\\\\([0abt\tnvfre "\\/\\\\N_LP]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|U[0-9a-fA-F]{8})');Unescaper.unescapeSingleQuotedString=function(value){return value.replace(/\'\'/g,"'")};Unescaper.unescapeDoubleQuotedString=function(value){if(this._unescapeCallback==null){this._unescapeCallback=function(_this){return function(str){return _this.unescapeCharacter(str)}}(this)}return this.PATTERN_ESCAPED_CHARACTER.replace(value,this._unescapeCallback)};Unescaper.unescapeCharacter=function(value){var ch;ch=String.fromCharCode;switch(value.charAt(1)){case"0":return ch(0);case"a":return ch(7);case"b":return ch(8);case"t":return"\t";case"\t":return"\t";case"n":return"\n";case"v":return ch(11);case"f":return ch(12);case"r":return ch(13);case"e":return ch(27);case" ":return" ";case'"':return'"';case"/":return"/";case"\\":return"\\";case"N":return ch(133);case"_":return ch(160);case"L":return ch(8232);case"P":return ch(8233);case"x":return Utils.utf8chr(Utils.hexDec(value.substr(2,2)));case"u":return Utils.utf8chr(Utils.hexDec(value.substr(2,4)));case"U":return Utils.utf8chr(Utils.hexDec(value.substr(2,8)));default:return""}};return Unescaper}();module.exports=Unescaper},{"./Pattern":8,"./Utils":10}],10:[function(require,module,exports){var Pattern,Utils,hasProp={}.hasOwnProperty;Pattern=require("./Pattern");Utils=function(){function Utils(){}Utils.REGEX_LEFT_TRIM_BY_CHAR={};Utils.REGEX_RIGHT_TRIM_BY_CHAR={};Utils.REGEX_SPACES=/\s+/g;Utils.REGEX_DIGITS=/^\d+$/;Utils.REGEX_OCTAL=/[^0-7]/gi;Utils.REGEX_HEXADECIMAL=/[^a-f0-9]/gi;Utils.PATTERN_DATE=new Pattern("^"+"(?<year>[0-9][0-9][0-9][0-9])"+"-(?<month>[0-9][0-9]?)"+"-(?<day>[0-9][0-9]?)"+"(?:(?:[Tt]|[ \t]+)"+"(?<hour>[0-9][0-9]?)"+":(?<minute>[0-9][0-9])"+":(?<second>[0-9][0-9])"+"(?:.(?<fraction>[0-9]*))?"+"(?:[ \t]*(?<tz>Z|(?<tz_sign>[-+])(?<tz_hour>[0-9][0-9]?)"+"(?::(?<tz_minute>[0-9][0-9]))?))?)?"+"$","i");Utils.LOCAL_TIMEZONE_OFFSET=(new Date).getTimezoneOffset()*60*1e3;Utils.trim=function(str,_char){var regexLeft,regexRight;if(_char==null){_char="\\s"}regexLeft=this.REGEX_LEFT_TRIM_BY_CHAR[_char];if(regexLeft==null){this.REGEX_LEFT_TRIM_BY_CHAR[_char]=regexLeft=new RegExp("^"+_char+""+_char+"*")}regexLeft.lastIndex=0;regexRight=this.REGEX_RIGHT_TRIM_BY_CHAR[_char];if(regexRight==null){this.REGEX_RIGHT_TRIM_BY_CHAR[_char]=regexRight=new RegExp(_char+""+_char+"*$")}regexRight.lastIndex=0;return str.replace(regexLeft,"").replace(regexRight,"")};Utils.ltrim=function(str,_char){var regexLeft;if(_char==null){_char="\\s"}regexLeft=this.REGEX_LEFT_TRIM_BY_CHAR[_char];if(regexLeft==null){this.REGEX_LEFT_TRIM_BY_CHAR[_char]=regexLeft=new RegExp("^"+_char+""+_char+"*")}regexLeft.lastIndex=0;return str.replace(regexLeft,"")};Utils.rtrim=function(str,_char){var regexRight;if(_char==null){_char="\\s"}regexRight=this.REGEX_RIGHT_TRIM_BY_CHAR[_char];if(regexRight==null){this.REGEX_RIGHT_TRIM_BY_CHAR[_char]=regexRight=new RegExp(_char+""+_char+"*$")}regexRight.lastIndex=0;return str.replace(regexRight,"")};Utils.isEmpty=function(value){return!value||value===""||value==="0"||value instanceof Array&&value.length===0||this.isEmptyObject(value)};Utils.isEmptyObject=function(value){var k;return value instanceof Object&&function(){var results;results=[];for(k in value){if(!hasProp.call(value,k))continue;results.push(k)}return results}().length===0};Utils.subStrCount=function(string,subString,start,length){var c,i,j,len,ref,sublen;c=0;string=""+string;subString=""+subString;if(start!=null){string=string.slice(start)}if(length!=null){string=string.slice(0,length)}len=string.length;sublen=subString.length;for(i=j=0,ref=len;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j){if(subString===string.slice(i,sublen)){c++;i+=sublen-1}}return c};Utils.isDigits=function(input){this.REGEX_DIGITS.lastIndex=0;return this.REGEX_DIGITS.test(input)};Utils.octDec=function(input){this.REGEX_OCTAL.lastIndex=0;return parseInt((input+"").replace(this.REGEX_OCTAL,""),8)};Utils.hexDec=function(input){this.REGEX_HEXADECIMAL.lastIndex=0;input=this.trim(input);if((input+"").slice(0,2)==="0x"){input=(input+"").slice(2)}return parseInt((input+"").replace(this.REGEX_HEXADECIMAL,""),16)};Utils.utf8chr=function(c){var ch;ch=String.fromCharCode;if(128>(c%=2097152)){return ch(c)}if(2048>c){return ch(192|c>>6)+ch(128|c&63)}if(65536>c){return ch(224|c>>12)+ch(128|c>>6&63)+ch(128|c&63)}return ch(240|c>>18)+ch(128|c>>12&63)+ch(128|c>>6&63)+ch(128|c&63)};Utils.parseBoolean=function(input,strict){var lowerInput;if(strict==null){strict=true}if(typeof input==="string"){lowerInput=input.toLowerCase();if(!strict){if(lowerInput==="no"){return false}}if(lowerInput==="0"){return false}if(lowerInput==="false"){return false}if(lowerInput===""){return false}return true}return!!input};Utils.isNumeric=function(input){this.REGEX_SPACES.lastIndex=0;return typeof input==="number"||typeof input==="string"&&!isNaN(input)&&input.replace(this.REGEX_SPACES,"")!==""};Utils.stringToDate=function(str){var date,day,fraction,hour,info,minute,month,second,tz_hour,tz_minute,tz_offset,year;if(!(str!=null?str.length:void 0)){return null}info=this.PATTERN_DATE.exec(str);if(!info){return null}year=parseInt(info.year,10);month=parseInt(info.month,10)-1;day=parseInt(info.day,10);if(info.hour==null){date=new Date(Date.UTC(year,month,day));return date}hour=parseInt(info.hour,10);minute=parseInt(info.minute,10);second=parseInt(info.second,10);if(info.fraction!=null){fraction=info.fraction.slice(0,3);while(fraction.length<3){fraction+="0"}fraction=parseInt(fraction,10)}else{fraction=0}if(info.tz!=null){tz_hour=parseInt(info.tz_hour,10);if(info.tz_minute!=null){tz_minute=parseInt(info.tz_minute,10)}else{tz_minute=0}tz_offset=(tz_hour*60+tz_minute)*6e4;if("-"===info.tz_sign){tz_offset*=-1}}date=new Date(Date.UTC(year,month,day,hour,minute,second,fraction));if(tz_offset){date.setTime(date.getTime()-tz_offset)}return date};Utils.strRepeat=function(str,number){var i,res;res="";i=0;while(i<number){res+=str;i++}return res};Utils.getStringFromFile=function(path,callback){var data,fs,j,len1,name,ref,req,xhr;if(callback==null){callback=null}xhr=null;if(typeof window!=="undefined"&&window!==null){if(window.XMLHttpRequest){xhr=new XMLHttpRequest}else if(window.ActiveXObject){ref=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(j=0,len1=ref.length;j<len1;j++){name=ref[j];try{xhr=new ActiveXObject(name)}catch(undefined){}}}}if(xhr!=null){if(callback!=null){xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200||xhr.status===0){return callback(xhr.responseText)}else{return callback(null)}}};xhr.open("GET",path,true);return xhr.send(null)}else{xhr.open("GET",path,false);xhr.send(null);if(xhr.status===200||xhr.status===0){return xhr.responseText}return null}}else{req=require;fs=req("fs");if(callback!=null){return fs.readFile(path,function(err,data){if(err){return callback(null)}else{return callback(String(data))}})}else{data=fs.readFileSync(path);if(data!=null){return String(data)}return null}}};return Utils}();module.exports=Utils},{"./Pattern":8}],11:[function(require,module,exports){var Dumper,Parser,Utils,Yaml;Parser=require("./Parser");Dumper=require("./Dumper");Utils=require("./Utils");Yaml=function(){function Yaml(){}Yaml.parse=function(input,exceptionOnInvalidType,objectDecoder){if(exceptionOnInvalidType==null){exceptionOnInvalidType=false}if(objectDecoder==null){objectDecoder=null}return(new Parser).parse(input,exceptionOnInvalidType,objectDecoder)};Yaml.parseFile=function(path,callback,exceptionOnInvalidType,objectDecoder){var input;if(callback==null){callback=null}if(exceptionOnInvalidType==null){exceptionOnInvalidType=false}if(objectDecoder==null){objectDecoder=null}if(callback!=null){return Utils.getStringFromFile(path,function(_this){return function(input){var result;result=null;if(input!=null){result=_this.parse(input,exceptionOnInvalidType,objectDecoder)}callback(result)}}(this))}else{input=Utils.getStringFromFile(path);if(input!=null){return this.parse(input,exceptionOnInvalidType,objectDecoder)}return null}};Yaml.dump=function(input,inline,indent,exceptionOnInvalidType,objectEncoder){var yaml;if(inline==null){inline=2}if(indent==null){indent=4}if(exceptionOnInvalidType==null){exceptionOnInvalidType=false}if(objectEncoder==null){objectEncoder=null}yaml=new Dumper;yaml.indentation=indent;return yaml.dump(input,inline,0,exceptionOnInvalidType,objectEncoder)};Yaml.stringify=function(input,inline,indent,exceptionOnInvalidType,objectEncoder){return this.dump(input,inline,indent,exceptionOnInvalidType,objectEncoder)};Yaml.load=function(path,callback,exceptionOnInvalidType,objectDecoder){return this.parseFile(path,callback,exceptionOnInvalidType,objectDecoder)};return Yaml}();if(typeof window!=="undefined"&&window!==null){window.YAML=Yaml}if(typeof window==="undefined"||window===null){this.YAML=Yaml}module.exports=Yaml},{"./Dumper":1,"./Parser":7,"./Utils":10}]},{},[11]);

// Define an HPE standard style
var HPEStyle = "{font-family: arial; font-size: small}"+
	"body {font: 12px arial, sans-serif; color: #C6C9CA; background-color: black;}"+
	"th, table { font: 12px arial, sans-serif; color: #C6C9CA; background-color: black;}"+
	"h1, {color: #FF8300;}"+
	"h2, h3, h4, h5 {color: #C6C9CA;}"+
	"input, select {border: none; font: 12px arial, sans-serif; color: #01a982; background-color: black;}"+
	".buildButton { background-color: #FF8300; border: none; color: black; text-align: center; text-decoration: none; display: inline-block; border-radius: 2px;}"+
	".buildButton:hover { background-color: #4CAF50; color: white;}"+
	".helpButton { background-color: #32DAC8; border: none; color: black; text-align: center; text-decoration: none; display: inline-block; border-radius: 2px;}"+
	".helpButton:hover { background-color: blue; color: white;}"+
	".delButton { background-color: #0D5265; border: none; color: white; text-align: center; text-decoration: none; display: inline-block; border-radius: 2px;}"+
	".delButton:hover { background-color: #FF8300; color: black;}"+
	"a:link, a:visited { text-decoration: none; color: #80746E;}";
// Base 64 encoded logo and icon
var HPEicon="AAABAAEAEBAAAAAAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAAAAAAAAAAAAAAAAAAAAAAAD///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////AYe0AP+ItAD/h7QA/4e0AP+ItAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4i0AP+HtAD/h7QA/4e0AP+ItAD/h7QA/4e0AP+HtAD/iLQA/4e0AP+HtAD/h7QA/4e0AP////8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wGHtAD/h7QA/4e0AP+HtAD/////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8Bh7QA/4i0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4i0AP+HtAD/iLQA/4i0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/h7QA/4e0AP+HtAD/iLQA/4e0AP+ItAD/h7QA/4e0AP+HtAD/iLQA/4e0AP+HtAD/h7QA/4e0AP+HtAD/iLQA/////wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8B////Af///wH///8BAAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//w==";
var HPElogo="iVBORw0KGgoAAAANSUhEUgAAAU0AAACBCAYAAABErei/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABo/SURBVHhe7Z0JuFVV+YcXIgpqqDjhVGZqZWamleX0hAaBlg2PkuY8JIQpfzUnxKkcM6KQHMqhIjON1JzIoUwrMzKVnCg0ckYlJUVEAfd/veusb7POZp97z773XOVyf+/zfPfss9bae6+99tm/++019vJkTgghRFMsFz+FEEI0gURTCCEqINEUQogKSDSFEKICEk0hhKiARFMIISog0RRCiApINIUQogISTSGEqIBEUwghKiDRFEKICkg0hRCiAhJNIYSogERTCCEqINEUQogKSDSFEKICEk0hhKiARFMIISog0RRCiApINIUQogISTSGEqIBEUwghKiDRFEKICkg0hRCiAhJNIYSogERTCCEqINEUQogK9PJkcVt0lqyHFGWvXnFDiJ6HRLNVIJgr9nFuhRWce+utGLiM0du/mMx9vXZ9Ek7RQ5FotoJQgv7PAUNddtSeXljmh+BljlVXdr0OOde5qY9KNEWPRaLZCkw0hw9y2YjdnXttGRbN0ROce+AxiabosUg0W4GJ5p5eNEcmornSis4t183b2hYtcu71N2vbiOb/ne/c/TMkmqLHItFsBdYAtM9glx20q3PzvGhS/3fZzc694QWnVzcVTgRz4IDwz8AtWFgTzVHjnXt4pkRT9Fgkmq2g6GnOe8O5Pr1dr2HHLRbU7sq6a7ps0pjaNcnTFEL9NFtKUUf6rVD7RGC6o0HfeA1GT+lWJUQDJJpCCFEBiaYQQlRAoimEEBWQaAohRAUkmkIIUQGJZlcyP3YKp8W5OxrQz1QIkaN+mq0glKD/kw6jpHP7xGtqwtldRwXRuX2dNZw7aKhzb8bO7RpGKXo4Es1WUCaasHLf7iuYBsJJx3aQaAoh0WwJjURzWUOiKYREsyWYaO5vU8O9HoKXORDNQ5kabrpEU/RYJJqtwERz5X4u67/SMjwJcW/Xa/acWv2mRFP0UCSarcKEsycgwRQ9GImmEEJUQP00hRCiAhJNIYSogERTCCEqINEUQogKSDSFEKICEk0hhKiAuhy1kMxmBkrw5Ru3FtNsureLYn7eybwUKSurIm9nfpe2e1dGozJb2vLZXfHlKNFsBfxQ+/Xr51ZaaSX31ltvueWWW87997//DXHpj5V0q6yyiltxxRXDNmnnzJkT4t6JHzV56N+/v1t++eXD90WLFrn//e9/S8UDZg//Rz7yEffmm/VT1JG/xx57rDS8q7D8bLLJJm6FFVYI93j27Nlu1qxZS0V5geVxs802C/eUPL7wwgvBYGnJZ7fGF2Im65z5Ygw2fvx4/5tdzIABA0J4Me3kyZNjiizzopl5oV0i3dtlnHfq1KkxN1nmhb7TeWH/1NqKM0vTpGn5bI8ZM2ZkW2+9dZvHaoXZ8b1QxjNn2VVXXdXl561i5KNv376Z/2cSc5hlEyZMWKry2N1NdZot5JVXXolbNRYuXBi36jHPEp5//vng3b2TvPTSS3HLuRdffDFudQz/jLqJEye6G264wd10003u5JNPzr0fPv2Pzl1xxRXuN7/5jbvlllvcV77ylTyujEbhKXh+f//7393YsWPD92b26Qz2BgHFe740wO8pvY9z586NW6IVSDRFy/n85z/vPve5z7ldd93VDRo0KIbWQND23HNPt/vuu7shQ4a4LbfcMsY0x7x584JopUJvfPvb33bbbbdd/CZE1yDRXApBWNqyRmmMZsMtzj4BT7BIcZ+iGbadejavvvpq+EzTvfbaa3FrcTykaRoxatQot+aaa7o11lgj5PXYY4+NMTXGjBkTPi1vbVmRsjSptUfZPs1aSll80Rqlg3f6zWVZx//uQj2I6AT2Y8XTsVdEWHXVVcPrWypEpL388svdgQceGL4/99xzbqONNgoNGqSzY332s591++67b4i777773D333OOuvPLKEAcf+9jHgsf2xhtvBO9r/PjxYRve9773uREjRoTqgbvvvtvdeOONIRz233//vJFgypQp7s4773S33nqrGzx4cIh/9NFH3eabb57n2fJD49Vhhx3mhg0bFs5DfngFnzZtWogHvMctttjCHXXUUUHYgMaaH/3oR27llVcOjV4c98QTTwwNYfCHP/whnL9v377uzDPPzMsB7Nz2CaNHj3YTJkyoK6u//vWv7hOf+ETYfuaZZ9wGG2wQ4rlOXv+5HsqRuIceeiiU4/Tp00P64rkADxiPdfvttw+i/sADD7gLL7wwf+X95z//GY4NXBtlDVzD0UcfHa6td+/e4d6PGzcuiNj6668fvO9PfepTYV+O+/DDD7vrrrvO3XXXXWF/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";

var localStyle = document.createElement('style');
localStyle.innerHTML = HPEStyle;
document.head.appendChild(localStyle)
var localIcon = document.createElement('link');
localIcon.href = "data:image/x-icon;base64,"+HPEicon;
localIcon.rel="icon";
localIcon.type="image/x-icon";
document.head.appendChild(localIcon)
document.getElementById("HPElogo").src="data:image/png;base64,"+HPElogo;

// Display version history in the user output area
function versionHistory(){userOutput(`Version history:
2020-06-11 0.70	Allow multiple instances of the same type in one project: add a new optional attribute in resources, Dependencies, to resolve ambiguity in dependencies
    More nudm stuff in the default catalog: nudm-li-tf, nudm-ueau, nudm-uecm
2020-06-09 0.69	Undeploy feature for interactive and headless modes; improve idempotence for udsf, udr, udm
2020-06-04 0.68	Remove admin privilege requirements when possible (nudsf-dr sde-udr-nudr-dr sde-udr-nudr-prov hpe-nnrf-reg-agent udm prometheus influxdb ignite)
2020-06-02 0.67	headless mode for RESTful invocation, including json dump and import; file type: init properly during import
    Misc section: headless and default project variables, with override capability from a headless invocation
    Manage admin privileges requirement for some types by warning the user at build and deployment time; make this information part of the catalog
    In the built installer: cleanup tempoary files if successful, and skip security relaxation if system:admin is not loggable
2020-05-07 0.65	Disable shell parameters expansion in templates deployed over REST API to support pods configuration files using shell parameters
2020-05-06 0.64	Full stack deployment: update the ansible controller setup procedure to CenOS8/Python3
    New section 'Clusters' defining on which OpenShift clusters the resources are to be deployed over REST API
    Default catalog cleanup of privileged resources like ClusterRole and ClusterRoleBinding, demoted as RoleBinding to 'view' default role for REST API deployment
2020-04-22 0.63	support optional persistent storage for ignite
2020-04-21 0.62	5G catalog management: offer display/import/export catalog of deployable resources in a dedicated fieldset.
    Offer nudm-sdm and nudm-notify deployment from native OpenShift templates.
2020-04-15 0.61	Welcome message cleanup; new section for Helm charts deployments; elasticSearch operator added
    deployment script logs cleanup; colors update for HPE compliance; group common actions in fieldsets.
2020-04-07 0.60	redis and influxdb deployment; nudm network function preview; start with an empty set of resources but welcome and help display
2020-03-31 0.59	add Operators section to deploy services from available operators.
2020-03-30 0.58	split the NetworkFunctions section in three categories: NetworkFunctions, DirectServices, IndirectServices
2020-03-25 0.57	add fluentd and grafana services.
2020-03-23 0.56	add prometheus services; move labels from app to name for service exposure
2020-03-18 0.55	define storage size per network function with target volume; ElasticSearch with storage; ImageStreams target directly secure registries; fix cinder volume Id resolution.
2020-03-12 0.54	udr and udr-prov deployment with traffic from tester. Jenkins pipelines deployment. ElasticSearch preview. Default images updated.
2020-03-06 0.53	In addition to full stack deployment, support network functions only deployment, with idempotence. More nudr stuff (still preview)
2020-03-06 0.52	CMS5G Core Stack automated deployer moved to https://github.hpe.com/CMS-5GCS/automated-deployer.git; manage multiple openshift versions (3.9, 3.11)
    nudr preview (missing dependencies)
2020-02-25 0.5	CMS5G Core Stack automated deployer hosted on github.hpe.com:cms5g/Carrier-Stack; Switch to OpenShift v3.11 with automated git clone
    CMS5G Core Stack tester automated deployment; OpenShift internal registry population and projects creation automated. 
2020-01-28 0.4	Add the NetworkFunctions section to deploy ignite and nudsf-dr, supporting multiple OpenShift projects
2020-01-10 0.3	Fix the generated ansible inventory by removing labels on non master nodes; Help button beside the Build button delivering the user guide.
2020-01-09 0.2	Cinder and OpenShift volumes management, output in a dedicated section ready for OpenShift template creation
2020-01-06 0.1	Very first draft`
	);
}

// Display information to the user in the userArea frame
// Keep a copy of the last displayed data in a global variable, accessible to an headless application, free of any HTML rendering
// (typically special characters escaping)
var rawUserOutput;
function userOutput(aText){
	document.getElementById("userArea").innerHTML=aText;
	document.getElementById("endOfUserArea").click();
	rawUserOutput=aText;
}

// Class implementing a unique role
var uniqueRole = function(aName){
	this.v = false;
	this.name = aName;
}
uniqueRole.prototype.init = function(){this.v = false;}
uniqueRole.prototype.v = this.v;
// Set if y, unless already true; in that case, return a duplication alert for role
uniqueRole.prototype.setIfNotOrAlert = function(y){
	if(y){
		if(this.v)return "\nNodes section: role " + this.name + " is duplicated."
		this.v = true;
	}
	return "";
}

// Class implementing a file which content is loaded from the user file system (content)
// to be dropped on the VNF at a specified path (path)
// Interface:
// - a constructor 
// - methods to load, display and clear the content.
// - public members: content, contentType and path
// - public methods: 
//   . isDefined to check if the element already exists in the DOM
//   . getDomElement to retrieve the HTML code exposing and controling the element
// Constructor: 
// - name of the variable instantiated: required to link the user's events to the object's methods
// - label describing the purpose of this file, displayed besides the 'browse' button
// - (optional) function to call upon loading, defaults to displaying the loaded content
// Usage example from a section
// - instantiate the object; parameter: the name of the HTML input button Id to allow clearance  
// 	var uspmAuxDescInput = new userLoadedFile("uspmAuxDescInput", "Import USPM auxiliary descriptor..."); 
// - pass this variable while constructing a section to get the file controls browse/view/clear
// new vnfResource("Misc", [...], [uspmAuxDescInput, ...]);
// - use the content: 
//	if(aUserFile.isDefined()){result += aUserFile.content;}else{ manage error...} 
// Usage example out of a section, directly in the DOM: controls to import a session
// - instantiate the object: parameters: name of the object, label, associated action: importSession
//   var importedSession = new userLoadedFile("importedSession", "Import...", importSession);
// - insert the HTML behind the 'controlArea' element unless it exists already
//   if(!importedSession.isDefined())document.getElementById("controlArea").appendChild(importedSession.getDomElement());
	
var userLoadedFile = function(aVarName, aLabel, anAction){
	this.label = aLabel;
	this.var = aVarName;
	this.inputId = aVarName+"_inputId";
	this.content = undefined;
	this.contentType = undefined;
	this.path = undefined;
	this.action = this.view;
	if(anAction != undefined)this.action = anAction;
	this.isDefined = function(){return document.getElementById(this.inputId) != undefined;};
	
	this.getDomElement = function(){
		var trFile = document.createElement('TR');
		var tdLabel = document.createElement('TD');
		tdLabel.setAttribute("valign", "top");
		tdLabel.appendChild(document.createTextNode(this.label));
		if(this.label!=undefined)trFile.appendChild(tdLabel);
		
		var tdBrowse = document.createElement('TD');
		tdBrowse.setAttribute("valign", "top");
		var browseButton = document.createElement('INPUT');
		browseButton.type="file";
		browseButton.id=this.inputId;
		browseButton.className="buildButton";
		//browseButton.value="Import...";
		browseButton.setAttribute("onchange", this.var + ".load(event)");
		tdBrowse.appendChild(browseButton);
		trFile.appendChild(tdBrowse);
		
		var tdView = document.createElement('TD');
		tdView.setAttribute("valign", "top");
		var viewButton = document.createElement('INPUT');
		viewButton.type="button";
		viewButton.className="helpButton";
		viewButton.value="Review";
		viewButton.setAttribute("onClick", this.var + ".view(event)");
		tdView.appendChild(viewButton);
		trFile.appendChild(tdView);
		
		var tdClear = document.createElement('TD');
		tdClear.setAttribute("valign", "top");
		var clearButton = document.createElement('INPUT');
		clearButton.type="button";
		clearButton.className="delButton";
		clearButton.value="Clear";
		clearButton.setAttribute("onClick", this.var + ".clear(event)");
		tdClear.appendChild(clearButton);
		trFile.appendChild(tdClear);
		return trFile; 
	}
}
userLoadedFile.prototype.load = function(event){
	// Gratitude to https://stackoverflow.com/questions/27254735/filereader-onload-with-result-and-parameter
	var file = event.target.files[0];
	this.contentType = file.name.split('.').pop();
	var reader = new FileReader();
    reader.onload = ( function(target){ return function(e){
    	// Store the file content in the original object
    	target.content = this.result;
    	// Action 
    	target.action();
    	}
    })(this);
    reader.readAsText(file);
}
userLoadedFile.prototype.clear = function(){
	this.content=undefined; 
	userOutput(''); 
	if(this.inputId != undefined)document.getElementById(this.inputId).value= null;
}
userLoadedFile.prototype.view = function(){
	userOutput(this.content);
}
// Ensure that both the content and the path are defined
userLoadedFile.prototype.isDefined = function(){
	return this.content != undefined && this.content != '' && this.path != undefined && this.path != '';
}
// Ensure that neither the content nor the path are defined
userLoadedFile.prototype.isUndefined = function(){
	return (this.content == undefined || this.content == '') && (this.path == undefined || this.path == '');
}
// Check that both path and content are either defined or undefined
userLoadedFile.prototype.isConsistent = function(){
	return this.isDefined() || this.isUndefined();
}

// Class implementing a Heat node: a short name, and a flavor, plus a boolean identifying a EMS role receiving OpenShift templates defining the network functions
// Plus a list of network interfaces identified by the integer behind the 'eth' prefix, -1 for the external network used to connect floating IPs
// Plus 2 booleans: isVIP if this node is a VIP and hasVIP if this node hosts VIP(s)
// And a table holding all IP addresses for this node, for infrastructure not allocating dynamically IP addresses (vmware, static)
var heatPublicInterface = -1;   
var cloudNode = function(aName, aFQDN){
	this.flavor = 'flavorSmall';
	this.name = aName;
	this.fqdn = aFQDN;
	this.interfaces = new Array();
	this.isEms = false;
	this.isVIP = false;
	this.hasVIP = false;
	this.ipAddresses = undefined;
	this.domain = aFQDN.substr(aFQDN.indexOf('.')+1);
}

// Class implementing a Heat volume: name, size and description
var cloudVolume = function(aName, aSize, aDescription){
	this.name=aName;
	this.size=aSize;
	this.description=aDescription;
}

// Class implementing a openshift volume: name, size, type, access and cinder volume
var openshiftVolume = function(aName, aSize, aType, anAccess, aReclaim, aCinder){
	this.name=aName;
	this.size=aSize;
	this.type=aType;
	this.access=anAccess;
	this.reclaim=aReclaim;
	this.cinder=aCinder;
}

// Class implementing a port opened as a value, a protocol and a description
var vnfPort = function(aPort, aProtocol, aDescription){
	this.port = aPort;
	this.protocol = 'UDP';
	if(aProtocol != "")this.protocol = aProtocol;
	this.description = aDescription;
}
// List of exposed ports in the whole VNF
var vnfPorts = new Array();

var consistency = new Object;

consistency.initSingle = function (){

}
consistency.init = function (){
	consistency.initSingle();
}

consistency.check = function (){
	// Cross sections consistency checks, cannot be executed locally to the sections
	var warnings = "";
	if(!Networks.search('network','MGMT'))warnings+="\nNetworks section: management interface is mandatory";
	return warnings;
}

// Class defining a VNF resource named 'title' as an extensible table with a set of 'columns'
// Each column needs to define a 
// - name
// - type (optional)
//		. bool to define a check box
//		. choice to define a drop down menu
//			for that type, a 'choices' attribute is expected to define the list of choices
//		. text (default)
// - value (optional: the default value)
// Two methods linked to buttons at the bottom of the table are to be provided for each VNF resource:
// - build: returns the MSE Descriptor section for this resource as a string; if any issue prevents this build, the check variable should return the error messages 
// - help: provides hints for this resource as a text string
// Convenient methods are offered for a resource:
// search(column, value): to search for a text value in a given column
// display(column, value): set the display style attribute for a given column, where 'value' typically is 'none' to hide a column, and id one by default
// count(column, value): count the number of occurrences of a specific value in a specific column
// isEmpty(): check if the table is empty
// A optional parameter user file list, allowing the resource to load a set of user file, as a list of objects instantiated from userLoadedFile class
 
// Cell width control
var cellWidth="85px";
var boolCellWidth="15px";
var choiceCellWidth="200px";

// Ensure unicity of ids for all the dynamic delete buttons by incrementing an integer at each button creation
// This value has to be recorded in the DOM so that when starting from an existing document, the new ids will not clash with the existing ones
// Default to 1 if nothing valid is recorded in the DOM
var _uniqueInputId=1;
var _uniqueInputIdDOM=document.getElementById("_uniqueInputId");
if(_uniqueInputIdDOM != undefined){
	var candidate = Number(_uniqueInputIdDOM.value);
	if(!isNaN(candidate))_uniqueInputId=candidate;
}

// List of VNF resources for applying actions to multiples resources
vnfResources = new Array();

var vnfResource = function(title, columns, userFiles){
	this.result = "\nWARNING: " + title + " section is not defined yet: please apply and rebuild\n";
	var self = this;
	
	var table = document.createElement('TABLE');
	table.border='1';
	table.id=title;
	
	var tableCaption = document.createElement('CAPTION');
	tableCaption.appendChild(document.createTextNode(title));

	var tableBody = document.createElement('TBODY');
	table.appendChild(tableBody);
	
	var tr = document.createElement('TR');
	tableBody.appendChild(tr);
	var td = document.createElement('TH');
	var addButton = document.createElement('INPUT');
	addButton.type="button";
	addButton.value="Add";
	addButton.setAttribute("onClick", title + ".add();");
	td.appendChild(addButton);
	tr.appendChild(td);

	// Create all columns in this table; set a class concatenating the table and column names for further search
	// Build an array of the names for easy search with name key  when calling the build function
	// The first cell is used for the delete button, skip it
	var iName = new Array(columns.length + 1);
	for (i=0; i<columns.length; i++){
		var td = document.createElement('TH');
		td.className = title + columns[i].name;
		td.appendChild(document.createTextNode(columns[i].name));
		iName[i+1] = columns[i].name;
		var localWidth = cellWidth;
		switch(columns[i].type){
			case 'bool':
				localWidth = boolCellWidth;
				break;
			case 'choice':
				localWidth = choiceCellWidth;
				break;
		}
		if(columns[i].width != undefined)localWidth = columns[i].width;
		td.style.width = localWidth;
		tr.appendChild(td);
	}

	// Attach useful variables to this current object for further asynchronous reference
	self.title = title;
	self.nameIndexes = iName;
	self.columns = columns;
	self.check = "";
	
	// For each user file, add a set of buttons to load, view and clear the associated text. 
	var tableFiles = document.createElement('TABLE');
	if(userFiles != undefined)userFiles.forEach(function(aFile){
		tableFiles.appendChild(aFile.getDomElement());
	});
	
	// Add a button to trigger the MSE Descriptor build for this section
	var buildButton = document.createElement('INPUT');
	buildButton.type="button";
	buildButton.value="Apply";
	buildButton.className="buildButton";
	buildButton.setAttribute("onClick", "userOutput(" + title + ".build());");
	
	// Add a button to show help 
	var helpButton = document.createElement('INPUT');
	helpButton.type="button";
	helpButton.value="Help";
	helpButton.padding="5px";
	helpButton.className = "helpButton";
	helpButton.setAttribute("onClick", "userOutput(" + title + ".help());");
	
	// Append the new elements to the DOM behind the insertion point, if they dot not exist already
	if(document.getElementById(title) == undefined){
		var myTableDiv = document.getElementById("tableInsertionPoint");
		// Create an anchor for quick reference to this table
		var anchorTable = document.createElement('A');
		anchorTable.setAttribute("name", title);
		// Add a link to this table just before the user result area: a click on this link displays the related section 
		var linkToTable = document.createElement('A');
		linkToTable.setAttribute("href", "#"+title);
		linkToTable.innerHTML=" / "+title;
		linkToTable.setAttribute("onClick", this.title + ".display(true);");
		var userArea = document.getElementById("endOfUserArea");
		userArea.appendChild(linkToTable);
		var linkToTableSummary = linkToTable.cloneNode(true);
		var summary = document.getElementById("summary");
		summary.appendChild(linkToTableSummary);
		var headerTable = document.createElement('H2');
		headerTable.innerHTML=title;

		anchorTable.appendChild(headerTable);
		// Create a specific div for this section, easing management, hide, show, etc.
		var thisTableDiv = document.createElement('div');
		thisTableDiv.id = title+'Section';
		thisTableDiv.appendChild(anchorTable);
		thisTableDiv.appendChild(table);
		thisTableDiv.appendChild(tableFiles);
		thisTableDiv.appendChild(buildButton);
		thisTableDiv.appendChild(helpButton);
		myTableDiv.appendChild(thisTableDiv);
	}
	
	// update the list of VNF resources for actions applying to all elements, like build, import...
	vnfResources.push(this);
};
// Default help 
vnfResource.prototype.help = function(){
	return "No help available";
}
// Default build
vnfResource.prototype.build = function(){
	return "No build instructions defined";
}
// Delete the current line in the table
vnfResource.prototype.delete = function(inputId){
	var table = document.getElementById(this.title);
	var theInput = document.getElementById(inputId);
	var index = theInput.parentNode.parentNode.rowIndex;
	table.deleteRow(index);	
}
// Add a new line in the table
// Optional values can be provided as a table of dictionaries of column / value like [{column:"columnA", value:"a"}, {column:"columnB", value:"b"}, {column:"columnD", value:"d"}, ...]
// For 'choice' types, the init value is checked against the valide set: if not valid, an error message is returned.
// Otherwise, undefined is returned
vnfResource.prototype.add = function(values){
	var table = document.getElementById(this.title);
	var columns = this.columns;
	var result="";
	
	if(values){
		// Check for unknown columns
		var section=this.title;
		var validColumns=columns.map(function(c){return c.name;})
		values.forEach(function(v){if(validColumns.indexOf(v.column) < 0)result+="Unknown attribute "+v.column+" in section "+section+" ignored.\n\tExpecting one of: "+validColumns.join()+"\n"});
	}
 
	var rowCount = table.rows.length;
	var row = table.insertRow(rowCount);
	var delButton = document.createElement('INPUT');
	delButton.type="button";
	delButton.value="Del";
	delButton.className="delButton";
	delButton.id="delButton"+(_uniqueInputId++);
	_uniqueInputIdDOM.setAttribute("value", _uniqueInputId);
	delButton.setAttribute("onClick", this.title + ".delete('"+delButton.id+"');");
	var cell = row.insertCell(0);
	cell.appendChild(delButton);
	for (i=0; i<columns.length; i++){
		var cell = row.insertCell(i+1);
		cell.className = this.title + columns[i].name;
		// Initial value: first element of values with a matching column name
		var init=undefined;
		if(values){
			var initValues = values.filter(function(e){return e.column == columns[i].name;});
			if(initValues.length > 0)init=initValues[0].value;
		}
		switch(columns[i].type){
			case 'bool':
				var checkCell = document.createElement('INPUT');
				checkCell.className = this.title + columns[i].name;
				checkCell.type = "checkbox";
				cell.style.width = checkCell.style.width = boolCellWidth;
				if(init)checkCell.setAttribute("checked", "checked");
				cell.appendChild(checkCell);
				break;
			case 'choice':
				var _choices=columns[i].choices;
				// if the list of choices is not a function, assume an array and return this array through a function
				if(typeof _choices != "function")_choices=function(){return columns[i].choices;};
				var selectCell = document.createElement('SELECT');
				selectCell.className = this.title + columns[i].name;
				var localWidth = choiceCellWidth;
				if(columns[i].width != undefined)localWidth = columns[i].width;
				cell.style.width = selectCell.style.width = localWidth;
				for (j=0; j<_choices().length; j++){
					var option = document.createElement('OPTION');
					option.value = _choices()[j];
					option.innerHTML = option.value;
					selectCell.appendChild(option);
				}
				// if the default value is not a null string, avoid adding always the same selection:
				// set a default value according to the row in the table, instead of the first choice
				if(_choices()[0] != "")selectCell.value = _choices()[rowCount-1];
				if(init != undefined){
					// Make sure the init value is a valid choice
					if(_choices().indexOf(init) < 0)result+="Unknown selection "+init+" for attribute "+columns[i].name+" in section "+this.title+"\n\tExpecting one of: "+_choices().join()+"\n";
					selectCell.value = init;
				}
				cell.appendChild(selectCell);
				break;
			case 'file':
				// userLoadedFile needs a javascript variable: build it dynamically as the section name, the column name and the delete button id which is unique
				var dynJSvar=this.title + "_" + columns[i].name + "_" + delButton.id;
				var tableFiles = document.createElement('TABLE');
				tableFiles.className=this.title + columns[i].name+" userLoadedFile";
				tableFiles.id=dynJSvar;
				window[dynJSvar] = new userLoadedFile(dynJSvar);
				tableFiles.appendChild(window[dynJSvar].getDomElement());
				window[dynJSvar].content=init;
				cell.appendChild(tableFiles);
				break;
			default:
				var inputCell = document.createElement('INPUT');
				inputCell.className = this.title + columns[i].name;
				var localWidth = cellWidth;
				if(columns[i].width != undefined)localWidth = columns[i].width;
				cell.style.width = inputCell.style.width = localWidth;
				inputCell.type = "text";
				if(columns[i].value != undefined)inputCell.value = columns[i].value;
				if(init != undefined)inputCell.value = init;
				cell.appendChild(inputCell);
				break;
		}
	}
	// hide unused columns if the method is available
	if(this['hideUnused'] != undefined)this.hideUnused();
	return result;
}

// Import from a provided document
// Returns a text string summarizing the import
vnfResource.prototype.import = function(importedDocument){
	var summary = "";
	var table = document.getElementById(this.title);
	var importedTable = importedDocument.getElementById(this.title);
	if(importedTable == null)return summary;
	
	var rowCount = table.rows.length;
	var importedRowCount = importedTable.rows.length;
	var columns = this.columns;
	
	for(var i=1; i < importedRowCount; i++, rowCount++){
		if(summary == "")summary = "\n" + this.title;
		summary += "\n";
		
		// one more line
		this.add();
		
		for (j=0; j<columns.length; j++){
			// Source: 2 cells expected: one for the td element, the second for the input element
			var source = Array.prototype.slice.call(importedTable.rows[i].getElementsByClassName(this.title + columns[j].name));
			// Otherwise, this column is missing in the source document, continue
			if(source.length < 2)continue;
			
			// Destination: j+1 as the first cell is dedicated to the delete button
			var destination=table.rows[rowCount].cells[j+1].childNodes[0];
			switch(columns[j].type){
				case 'bool':
					destination.removeAttribute("checked");
					if(source[1].checked){
						destination.setAttribute("checked", "checked");
					}
					break;
				case 'choice':
					var selectedOption = source[1].selectedIndex;
					var selectedValue = source[1].options[selectedOption].value;
					if(selectedOption != -1){
						// looping over the destination options to select the selected value
						for (selectedOption=destination.options.length;selectedOption--;) { 
						  if(destination.options[selectedOption].value == selectedValue)
						  	break;
						}
						destination.options.selectedIndex=selectedOption;
						if(selectedOption != -1){
							destination.options[selectedOption].setAttribute("selected", "selected");
							if(destination.options[selectedOption].value != "")summary += "\t" + destination.options[selectedOption].value;
						}
					}
					break;
				case 'file':
					// userLoadedFile has a javascript variable associated, which name is the id, built as the section name, the column name and the delete button id which is unique: 
					var dynJSvar=source[1].id;
					window[dynJSvar] = new userLoadedFile(dynJSvar);
					summary += "\tPlease load a file to populate "+columns[j].name+" at line "+i+" in section "+this.title;
					break;
				default:
					destination.value = source[1].value;
					destination.removeAttribute("value");
					destination.setAttribute("value", source[1].value);
					if(destination.value != "")summary += "\t" + destination.value;
					break;
			}	 
		}
	}
	return summary;
}

// Returns the current object as a table of rows, each row being a table of attribute:value
vnfResource.prototype.dump = function(){
	var result = new Array();
	var table = document.getElementById(this.title);
	
	var rowCount = table.rows.length;
	var columns = this.columns;
	
	for(var i=1; i < rowCount; i++){
		// one more line
		var line = new Array();
		
		for (j=0; j<columns.length; j++){
			var val;
			// Source: 2 cells expected: one for the td element, the second for the input element
			var source = Array.prototype.slice.call(table.rows[i].getElementsByClassName(this.title + columns[j].name));
			// Otherwise, this column is missing in the source document, continue
			if(source.length < 2)continue;
			
			switch(columns[j].type){
				case 'bool': val = source[1].checked; break;
				case 'choice':
					var selectedOption = source[1].selectedIndex;
					val = source[1].options[selectedOption].value;
					break;
				case 'file':
					var delButton=table.rows[i].getElementsByClassName("delButton")[0];
					var dynJSvar=this.title + "_" + columns[j].name + "_" + delButton.id;
					val=window[dynJSvar].content;
					break;
				default:
					val = source[1].value;
					break;
			}
			if(val)line.push({[columns[j].name]:val});
		}
		result.push(line);
	}
	return result;
}

// Search for a specific value in a specific column
vnfResource.prototype.search = function(column, value){
	var table = document.getElementById(this.title);

	// Search for the column by class name
	var cells = Array.prototype.slice.call( table.getElementsByClassName(this.title + column) );
	return cells.some(function(e,i){
		var boolValue = "___this_should_never_match___";
		var textValue = "___this_should_never_match___";
		if(e.value != undefined)textValue=e.value.valueOf();
		// check box case
		if(e.checked != undefined)boolValue=e.checked.toString();
		var refValue = this.valueOf();
		return boolValue === refValue || textValue === refValue;
		}, 
		value);	// this parameter is passed as this to the function
}

// Count the number of occurrences of a specific value in a specific column
//  If the value is undefined or an empty string, return the count of unique values in this column
vnfResource.prototype.count = function(column, value){
	var table = document.getElementById(this.title);
	if(value == undefined)value = new String("");

	// Search for the column by class name
	var cells = Array.prototype.slice.call( table.getElementsByClassName(this.title + column));
	// Retain values
	var values = cells.map(function(e,i){
		if(e.value != undefined){
			return String(e.value.valueOf());
		} else if(e.checked != undefined) {
			// check box case
			return String(e.checked.toString());
		}
		return String("");
	});
	var filtered = values.filter(function(e,i,t){
		// where e: element in the table, i: index in the table, t: table
		var b = this.valueOf();
		if(b == ""){
			// counting the number of unique occurrences
			// ignore empty items
			if(e == "")return false;
			// Gratitude to https://stackoverflow.com/questions/9229645/remove-duplicates-from-javascript-array
			var firstOccurence = t.indexOf(e);
			return  firstOccurence === i;
		}
		else
			return e === b;
		}, 
		value);	// this parameter is passed as this to the function
		
	return filtered.length;
}
// Hide or show a specific column, or the full section if no column specified
vnfResource.prototype.display = function(column, display){
	var table = document.getElementById(this.title);
	var section = document.getElementById(this.title+'Section');
	if(display == undefined){
		// The first parameter drives the visibility of the section as a boolean
		section.style.display = column ? '' : 'none';
	}else{
		// Search for the column by class name
		var cells = Array.prototype.slice.call( table.getElementsByClassName(this.title + column) );
		cells.forEach(function(e,i){e.style.display = display ? '' : 'none';});
	}
}

// Check if the table is empty, ie with no cell
vnfResource.prototype.isEmpty = function(){
	var table = document.getElementById(this.title);

	// Search for any cell in the table
	var cells = Array.prototype.slice.call( table.getElementsByTagName('td') );
	
	return cells.length == 0;
}

// Retrieve from the 'row' the value of an input field named 'column' in the list of columns'names 'nameIndexes' 
// Set the attribute of this element accordingly so that the DOM contains it for further saving
vnfResource.prototype.getAndSetValue = function(row, nameIndexes, column, defaultValue, promptText){
	if(nameIndexes.indexOf(column) < 0)return '';
	var elem=row.cells[nameIndexes.indexOf(column)].childNodes[0];
	var x=elem.value;
	if(x == "" && defaultValue != undefined && defaultValue != ""){
		if(promptText == undefined)promptText = this.title + " section: " + column + " cannot be blank.";
		elem.value = x = Misc.getValue('headless') ? defaultValue : prompt(promptText, defaultValue);
	}
	elem.removeAttribute("value");
	elem.setAttribute("value", x);
	return x;
}
vnfResource.prototype.getAndSetChecked = function(row, nameIndexes, column){
	if(nameIndexes.indexOf(column) < 0)return '';
	var elem=row.cells[nameIndexes.indexOf(column)].childNodes[0];
	var x=elem.checked;
	elem.removeAttribute("checked");
	if(x){
		elem.setAttribute("checked", "checked");
	}
	return x;
}
vnfResource.prototype.getAndSetSelection = function(row, nameIndexes, column, defaultSelection){
	if(nameIndexes.indexOf(column) < 0)return '';
	var elem=row.cells[nameIndexes.indexOf(column)].childNodes[0];
	var selectedOption=elem.options.selectedIndex;
	if(selectedOption == -1 && defaultSelection != undefined){
		elem.options.selectedIndex=selectedOption=defaultSelection;
	}
	// Remove all existing selected attributes
	for (var i=elem.options.length;i--;) { // looping over the options
	  elem.options[i].removeAttribute("selected");
	}
	var s = elem.options[selectedOption];
	if(s != undefined)s.setAttribute("selected", "selected");
	var x=elem.value;
	return x;
}

// ==================
// Network interfaces
// ==================
var Networks = new vnfResource("Networks", [
	{name:'network', type:'choice', width: '80px', choices:['MGMT', 'PUBLIC']}, 
	{name:'interface', type:'text', width: '50px', value:'eth0'}, 
	{name:'mask', type:'text', width: '120px', value:'255.255.255.224'}, 
	{name:'portgroup', type:'text', width: '120px'}]
	);
	
Networks.help = function(){
	return `Network interfaces names and associated masks and resources 
network:
 - MGMT is mandatory: all nodes should be connected to the MGMT interface
 - PUBLIC: optional external IP address of nodes visible through an address translation (mandatory for OpenStack nodes)
interface: 
  name of the network interface on the target
mask: Netmasks should be consistent across networks
  The first netmask in the table sets the network width for all networks.
  This width defines the maximum number of nodes and networks; it should be in the range 0 to 8, ie:
  - from mask 255.255.255.0: width: 8, 1 network, 256 nodes
  - to mask 255.255.255.255: width: 1, 256 networks, 1 node
  - recommended: 255.255.255.224: width: 5, 8 networks, 32 nodes
portgroup: 
  VMware specific; unused on OpenStack
`
}
	
Networks.build = function(target, engine){
	var nameIndexes = Networks.nameIndexes;
	var result = '\n';
	Networks.check = "";
	var table = document.getElementById('Networks');
	var rowCount = table.rows.length;
	Networks.heatNetworks = new Array();
	Networks.names = new Array();
	Networks.devices = new Array();
	Networks.masks = new Array();
	Networks.portgroups = new Array();
	Networks.heatMaxNetwork = 0;
	var networkCount = Number(Networks.count('interface'));
	if(target == 'Heat')networkCount--; // For Heat target, do not count the public interface in the quota, it is a 'pseudo interface', not actually instantiated
	Networks.heatWidth = undefined;
	
	if(Networks.count('network', 'MGMT') != 1)Networks.check += "\nNetworks: one and only one MGMT is required";
	Networks.check += checkDependency(target == 'Heat', [Networks.count('network', 'PUBLIC') > 0 ],  "Networks: missing PUBLIC pseudo interface; ", "required for OpenStack Heat target");
	['APP', 'SIP', 'LBNAT', 'PUBLIC', 'HA', 'DATA', 'M3UA1', 'M3UA2'].forEach(function(name){
		if(Networks.count('network', name) > 1)Networks.check += "\nNetworks: concurrent definitions of "+name+" detected";
	});

	result += '\n# ------------------------------- #';
	result += '\n# Network interfaces definition   #';
	result += '\n# ------------------------------- #';
	for(var i=1; i < rowCount; i++){
		var networkName=Networks.getAndSetSelection(table.rows[i], nameIndexes, 'network');
		var networkDevice=Networks.getAndSetValue(table.rows[i], nameIndexes, 'interface');
		var networkMask=Networks.getAndSetValue(table.rows[i], nameIndexes, 'mask');
		var networkPortgroup=Networks.getAndSetValue(table.rows[i], nameIndexes, 'portgroup', target=='OVFapp' || target=='vmware' ? networkName:'');
		if(networkName == ""){
			Networks.check += "\nNetworks: undefined network name for interface " + networkDevice;
			continue;
		}
		// Check netmask consistency but allow the legacy placeholder
		if(networkMask != "@netmask@")networkMask.split('.').forEach(function(e,i,t){
			var aByte = Number(e);
			if(isNaN(aByte) || aByte < 0 || aByte > 255 )Networks.check += "\nNetworks: invalid netmask " + networkMask + " for interface " + networkDevice + "; expecting positive integer <= 255, found "+e;
		});
		if(networkDevice != ""){
			result += '\n#'+networkName+'_DEVICE='+networkDevice;
			result += '\n#'+networkName+'_NETMASK='+networkMask;
			Networks.names.push(networkName);
			Networks.devices.push(networkDevice);
			Networks.masks.push(networkMask);
			Networks.portgroups.push(networkPortgroup);
			
			if(target == 'azure' && engine == 'ansible' || target == 'Heat' || target == 'kubernetes'){
				// Heat deployments: all networks have the same width: guess it from the first netmask proposed 
				if(Networks.heatWidth ==  undefined){
					// Use the 4th byte of the mask as the source for network width
					var cidr=Number(networkMask.split('.')[3]);
					// Use the closest integer
					Networks.heatWidth = Math.floor(Math.log(256 - cidr)/Math.log(2));
					Networks.heatMaxInterfaces=Math.pow(2, 8-Networks.heatWidth);
					Networks.heatCidrLength=Number(32-Networks.heatWidth).toString();
					Networks.heatMaxNodes=Math.pow(2, Networks.heatWidth);
					Networks.heatMask="255.255.255."+Number(256-Networks.heatMaxNodes).toString();
					if(networkCount > Networks.heatMaxInterfaces)Networks.check += "\nNetworks: network count limited by the netmask "+Networks.heatMask+" for "+target+" target to " + Networks.heatMaxInterfaces + ": found " + networkCount;
				}
				// Heat networks should be named ethN, N integer
				var prefix='eth';
				if(!networkDevice.startsWith(prefix))Networks.check += "\nNetworks: unsupported interface name for "+target+" target " + networkDevice + ": prefix " + prefix +" required";
				var candidate = networkDevice.substr(prefix.length);
				var interfaceNumber = Number(candidate);
				if(isNaN(interfaceNumber)){
					Networks.check += "\nNetworks: illegal value for interface number "+networkName+" : "+candidate+"; expecting integer";
					continue;
				} 
				Networks.heatNetworks[networkName] = interfaceNumber;
				Networks.heatMaxNetwork = Math.max(Networks.heatMaxNetwork,interfaceNumber);
				if(networkMask !== Networks.heatMask)Networks.check += "\nNetworks: netmask for "+target+" target cannot be larger than " + Networks.heatMask + ": found " + networkMask + " on interface " + networkName;
			}
		}
	}
	
	Networks.check += checkDependency(target == 'kubernetes' || target == 'azure' || target == 'aws', [Networks.heatMaxNetwork == 0], "Networks: "+target+" infrastructure is limited to one single network; found ", Networks.heatMaxNetwork + 1); 

	// update visible networks in the nodes table
	Nodes.hideUnused();

	// local check
	if(Networks.check != "")result = Networks.check;
	
	return result;
}

//===========================
//Miscellaneous settings
//===========================
var MiscItems = [
	{name: 'tester_nodejs_version', value: 'v11.10.1', comment: "Nodejs version used to run the CMS5G Core Stack tester tool"},
	{name: 'tester_git_url', value: 'https://github.hpe.com/cms5g/E2E-Testing.git', comment: "Git project URL delivering the CMS5G Core Stack tester tool"},
	{name: 'headless', value: '', comment: "if not empty: do not assume a user for answering prompts and downloading files: use default values without prompting and do not save any file."},
	{name: 'default_project', value: 'hpe5g', comment: "The default OpenShift project/namespace for deploying resources"},
	{name: 'default_action', value: 'deploy', comment: "The default installer action: deploy or undeploy"}
	];

var Misc = new vnfResource("Misc", [
	{name:'Property', width:'200px', type:'choice', choices:MiscItems.map(function(e){return e.name;})},
	{name:'Value', type:'text', width:'400px'}
	]
	);

Misc.help = function(){
	return "Miscellaneous settings:\n\t" + MiscItems.map(function(e){return e.name+": "+e.comment;}).join("\n\t");
}
Misc.getValue = function(name){
	// If a global variable exists, use its value
	if(window[name])return window[name];
	var theDefault=Misc.getDefault(name);
	var theItem;
	if(Misc.output)theItem=Misc.output.find(function(anItem){return anItem.name==name;});
	return theItem ? theItem.value : theDefault.value;
};
Misc.getDefault = function(name){
	var result=MiscItems.find(function(anItem){return anItem.name==name;});
	return result;
};
Misc.build = function(target){
	var nameIndexes = Misc.nameIndexes;
	var result = "\n";
	Misc.check = "";
	Misc.output = new Array();
	var table = document.getElementById("Misc");
	var rowCount = table.rows.length;
	
	result += "\n# ------------------------------- #";
	result += "\n# Miscellaneous properties        #";
	result += "\n# ------------------------------- #";
	
	for(var i=1; i < rowCount; i++){
		var row = table.rows[i];
		var propertyName=Misc.getAndSetSelection(row, nameIndexes, 'Property');
		var theDefault=Misc.getDefault(propertyName);
		var propertyValue=Misc.getAndSetValue(row, nameIndexes, 'Value', theDefault.value, theDefault.comment);
		if(propertyName != ""){
		result += "\n# "+theDefault.comment+": "+propertyValue;
		Misc.output.push({name:propertyName, value:propertyValue});
		}
	}

	if(Misc.check != "")return Misc.check;
	return result;
};


// ===========================
// Nodes resource
// ===========================
var sipGrpPrefix='Grp'
var Nodes= new vnfResource("Nodes", [
	{name:'MGMT fqdn', type:'text', width: '120px'}, 
	{name:'MGMT IP addr', type:'text', width: '120px'},
	{name:'PUBLIC IP addr', type:'text', width: '120px'},  
	{name:'Master', type:'bool'},
	{name:'Etcd', type:'bool'},
	{name:'Worker', type:'bool'},
	{name:'Tester', type:'bool'}
	]
	);
	
Nodes.help = function(){
	return `Nodes and roles definition and assignment
MGMT fqdn: The domain name used in fqdn should be consistent with the infrastructure settings: on OpenStack, the domain is typically: localdomain
MGMT IP addr: use a question mark on OpenStack (dynamic allocation)
PUBLIC IP addr: external IP address for this nodes; use a question mark on OpenStack (dynamic allocation)
Master/Etcd/Worker: the role(s) played by this node in the OpenShift cluster
Tester: node hosting the nodejs application used as HPE network functions tester.
  If no box is checked, the node is instantiated but not part of the OpenShift cluster, available for any specific usage.
`;
}

// Build the Nodes section of the descriptor
// - target is the optional infrastructure: Heat
// - engine is the optional underlying engine: ansible
// If the target is set, the unknown ip addresses defined as question marks are prepared as place holders for replacement at deployment time 
// The place holder format depends on the type of engine:
Nodes.build = function(target, engine){
	var oc_version=document.getElementById("oc_version").value;
	
	// Consistency checks reset
	consistency.initSingle();
	Nodes.check = "";
	
	var nameIndexes = Nodes.nameIndexes;
	var result = "\n";
	var table = document.getElementById("Nodes");
	var rowCount = table.rows.length;
	
	var cloudNodes = new Array();
	var masterNodes = new Array();
	var workerNodes = new Array();
	var etcdNodes = new Array();
	var testerNodes = new Array();
	
	result += "\n# ------------------------------- #";
	result += "\n# Nodes and roles definition      #";
	result += "\n# ------------------------------- #";
	for(var i=1; i < rowCount; i++){
		
		var row = table.rows[i];
		
		// Read the network definitions 'MGMT', 'PUBLIC'
		var nodeName		=	Nodes.getAndSetValue(row, nameIndexes, 'MGMT fqdn');
		var nodeIpAddr		=	Nodes.getAndSetValue(row, nameIndexes, 'MGMT IP addr');
		var nodePubIpAddr	=	Nodes.getAndSetValue(row, nameIndexes, 'PUBLIC IP addr');
		if(nodeName == "" || nodeIpAddr == ""){
			Nodes.check += "\nNodes section: MGMT FQDN and IP address are required";
			break;
		}
		
		// Read the roles definition
		var isMaster	=	Nodes.getAndSetChecked(row, nameIndexes, 'Master');
		var isWorker	=	Nodes.getAndSetChecked(row, nameIndexes, 'Worker');
		var isEtcd		=	Nodes.getAndSetChecked(row, nameIndexes, 'Etcd');
		var isTester	=	Nodes.getAndSetChecked(row, nameIndexes, 'Tester');

		// co-location checks
		Nodes.check += checkDependency(isEtcd, [isWorker && isMaster, !isWorker ],  "Nodes: on node "+nodeName,", etcd and worker roles colocation requires a master role as well.");
		Nodes.check += checkDependency(isMaster, [isWorker && isEtcd, !isWorker ],  "Nodes: on node "+nodeName,", master and worker roles colocation requires an etcd role as well.");
		// Tester requirements checks
		Nodes.check += checkDependency(isTester, [Misc.search('Property','tester_nodejs_version') && Misc.search('Property','tester_git_url')], "Nodes vs Misc: on node "+nodeName,", the tester role requires two entries in Misc: tester_nodejs_version and tester_git_url"); 
		
		// Collect the short name of this node in the short names array for Heat template build
		var shortName = nodeName.substr(0, nodeName.indexOf('.'));
		var theCloudNode = new cloudNode(shortName, nodeName);
		
		switch(target){
		  case 'Heat': case 'vmware':
			// IP addresses will be known at instantiation time: 
			// Replace undefined values with place holders resolved later
			// Push the network interface number in the interfaces list for this node
			if(nodeIpAddr == "?")		{nodeIpAddr="~"+shortName+		"_mgmt~";	theCloudNode.interfaces.push(Networks.heatNetworks['MGMT']);}
			if(nodePubIpAddr == "?")	{nodePubIpAddr="~"+shortName+	"_pub~";	theCloudNode.interfaces.push(heatPublicInterface);}
			break;
		}
		
		var nodeNames		= new Array();
		var nodeIpAddresses	= new Array();
		nodeNames['MGMT'] 		=	nodeName;
		nodeIpAddresses['MGMT']	=	nodeIpAddr;
		
		// Push this node as per the defined roles with the most demanding flavor, using the public IP address if defined, or the fqdn otherwise
		// NOTE: the master is always a worker node but with specific labels
		// Depending on the OpenShift version, the inventory varies
		function oc_node(host, ip, type){
			var result='';
			switch(oc_version){
			case '3.11': result=host+" openshift_ip="+ip+" openshift_node_group_name='"+type+"'"; break;
			case '3.9': 
				result=host+" openshift_hostname="+ip+" openshift_ip="+ip;
				if(type.indexOf('node-config-compute') != 0)result+=" openshift_node_labels=\"{'region': 'infra', 'zone': 'default'}\"";
				if(type.indexOf('node-config-infra') != 0)result+=" openshift_schedulable=true";
			}
			return result;
		}
		var hostEntry=nodePubIpAddr;
		if(hostEntry == undefined || hostEntry=='')hostEntry=nodeName
		if(isEtcd){
			if(!isWorker && !isMaster)workerNodes.push(oc_node(hostEntry, nodeIpAddr, 'node-config-infra'));
			etcdNodes.push(hostEntry); 
			theCloudNode.flavor='flavorSmall';
		}
		if(isWorker && !isMaster){
			workerNodes.push(oc_node(hostEntry, nodeIpAddr, 'node-config-compute')); 
			theCloudNode.flavor='flavorStandard';
		}
		if(isMaster){
			// Take the first master node as the ems
			if(masterNodes.length == 0)theCloudNode.isEms = true;
			masterNodes.push(hostEntry); 
			if(!isEtcd && !isWorker)workerNodes.push(oc_node(hostEntry, nodeIpAddr, 'node-config-master'));
			if(isEtcd && !isWorker)workerNodes.push(oc_node(hostEntry, nodeIpAddr, 'node-config-master-infra')); 
			if(isEtcd && isWorker)workerNodes.push(oc_node(hostEntry, nodeIpAddr, 'node-config-all-in-one'));
			theCloudNode.flavor='flavorPerformance';
		}
		theCloudNode.isTester=isTester;
		
		// For infrastructure where IP addresses are statically allocated (vmware, static)
		theCloudNode.ipAddresses = nodeIpAddresses;
		
		// co-location and dependency checks
			
		cloudNodes.push(theCloudNode); 
	}
	// End of for loop on the list of nodes
	
	if(masterNodes.length < 1)Nodes.check += "\nNodes section: missing at least one master node";
	if(workerNodes.length < 1)Nodes.check += "\nNodes section: missing at least one worker node";
	if(etcdNodes.length < 1)Nodes.check += "\nNodes section: missing at least one etcd node";
	
	// Inventory roles sections
	result += "\n[masters]";
	result += "\n"+masterNodes.join("\n");
	result += "\n[nodes]";
	result +="\n"+workerNodes.join("\n");
	result += "\n[etcd]";
	result +="\n"+etcdNodes.join("\n");

	// Ansible variables
	result += "\n[OSEv3:vars]";
	result += "\nopenshift_deployment_type=origin";
	result += "\nopenshift_disable_check=memory_availability,disk_availability,docker_image_availability";
	result += "\nopenshift_ip="+masterNodes[0];
	result += "\nansible_service_broker_install=false";
	result += "\nopenshift_master_cluster_hostname="+masterNodes[0];
	result += "\nopenshift_master_cluster_public_hostname="+masterNodes[0];
	result += "\nopenshift_public_hostname="+masterNodes[0];
	result += "\nopenshift_metrics_hawkular_hostname="+etcdNodes[0];
	result += "\nopenshift_metrics_install_metrics=true";
	result += "\nopenshift_metrics_image_version=v"+oc_version;
	result += "\ntemplate_service_broker_selector={\"region\":\"infra\"}";
	result += "\n[OSEv3:children]";
	result += "\nmasters";
	result += "\nnodes";
	result += "\netcd";

	// Make the list of nodes for availableHeat template  
	Nodes.cloudNodes = cloudNodes.slice();
	
	// check the network width limitation compared to the number of non VIP heat nodes
	var nonVipHeatNodes = cloudNodes.length;
	if(nonVipHeatNodes > Networks.heatMaxNodes)Nodes.check += "\nNodes vs Networks section: too many nodes for Heat deployments: found: "+nonVipHeatNodes+"; with a netmask "+Networks.heatMask+", the limit is : "+Networks.heatMaxNodes;
	
	// local check
	if(Nodes.check != "")result = Nodes.check;

	return result;
}

// Hides unused networks columns
Nodes.hideUnused = function(){
	['PUBLIC'].forEach(function(interface){
		// Check consistency first: reject hiding Networks interfaces with non empty columns in Nodes
		var fqdnColName=interface+' fqdn'; var ipAddrColName=interface+' IP addr';
		var nUsed=Nodes.count(fqdnColName)+Nodes.count(ipAddrColName) ; 
		var checkInterface = checkDependency(! Networks.search('network', interface), [nUsed== 0], 'Networks vs Nodes: ', 'Missing '+interface+' network interface definition : required '+nUsed+' times in the Nodes table.');
		if(checkInterface == ""){
			Nodes.display(fqdnColName, Networks.search('network', interface));
			Nodes.display(ipAddrColName, Networks.search('network', interface));
		}else Networks.check+=checkInterface;
	});
	
};

// ===========================
// Flavors settings
// ===========================
var Flavors = new vnfResource("Flavors", [
	{name:'Infrastructure', width:'100px', type:'choice', choices:['openstack']},
	{name:'Flavor', width:'120px', type:'choice', choices:['flavorSmall', 'flavorStandard', 'flavorPerformance']},
	{name:'name', type:'text', width:'80px'}
	]
	);
// OpenStack profiles default values
Flavors['openstack'] = new Array();
Flavors['openstack']['flavorStandard'] = {name: 'v2.m8'};
Flavors['openstack']['flavorSmall'] = {name: 'v2.m2'};
Flavors['openstack']['flavorPerformance'] = {name: 'v4.m8'};

Flavors.help = function(){var help="Infrastructure flavors:"+
	"\nFlavor of a node is defined by the roles played on this node:"+
	"\n\t- Small: Etcd"+
	"\n\t- Standard: Worker"+
	"\n\t- Performance: Master"+
	"\n\tFlavors are identified by name, made available by the infrastructure administrator"+
	"\nExamples:\n";
	// Table built with spaces for alignment, thanks to padStart
	var colLength=20;
	['Infrastructure', 'Flavor', 'Name'].forEach(function(column){
		help+=column.padStart(colLength);
	});
	['openstack'].forEach(function(infrastructure){
		['flavorStandard', 'flavorSmall','flavorPerformance'].forEach(function(flavor){
		help+="\n"+infrastructure.padStart(colLength);
		help+=flavor.padStart(colLength);
		help+=Flavors[infrastructure][flavor].name.padStart(colLength);
		});	
	});
	
	return help;
}

Flavors.build = function(target){
	var nameIndexes = Flavors.nameIndexes;
	var result = "";
	Flavors.check="";
	var table = document.getElementById("Flavors");
	var rowCount = table.rows.length;
	
	for(var i=1; i < rowCount; i++){
		if(result==""){
			result += "\n"
			result += "\n# ------------------------------- #";
			result += "\n# Flavors customization           #";
			result += "\n# ------------------------------- #";
			}
		var row = table.rows[i];
		var infra=Flavors.getAndSetSelection(row, nameIndexes, 'Infrastructure');
		var flavor=Flavors.getAndSetSelection(row, nameIndexes, 'Flavor');
		switch(infra){
			case 'openstack': 
				Flavors[infra][flavor].name=Flavors.getAndSetValue(row, nameIndexes, 'name', Flavors[infra][flavor].name, "Flavor name for "+flavor+" on "+infra);
				result+="\n# "+infra+" "+flavor+": name="+Flavors[infra][flavor].name;
				break;
			default:
				Flavors.check += "\nFlavors section: setting flavors is not supported on infrastructure : "+infra;
				break;
		}
	}
	
	if(Flavors.check != "")return Flavors.check;
	return result;
};

// ===========================
// CinderVolumes settings
// ===========================
var CinderVolumes = new vnfResource("CinderVolumes", [
	{name:'Name', type:'text', width:'120px'},
	{name:'Size', type:'text', width:'80px'},
	{name:'Description', type:'text', width:'300px'}
	]
	);

CinderVolumes.help = function(){var help="Persistent storage:"+
	"\nList of CinderVolumes allocated for OpenShift persistent storage:"+
	"\n\t- Name: one word CinderVolume name"+
	"\n\t- Size: CinderVolume size expressed in Gbytes"+
	"\n\t- Description: free text CinderVolume description";
	
	return help;
}

CinderVolumes.build = function(target){
	var nameIndexes = CinderVolumes.nameIndexes;
	var result = "";
	CinderVolumes.check="";
	var table = document.getElementById("CinderVolumes");
	var rowCount = table.rows.length;
	
	var cloudVolumes = new Array();

	
	for(var i=1; i < rowCount; i++){
		if(result==""){
			result += "\n"
			result += "\n# ------------------------------- #";
			result += "\n# CinderVolumes definition    #";
			result += "\n# ------------------------------- #";
			}
		var row = table.rows[i];
		var name=CinderVolumes.getAndSetValue(row, nameIndexes, 'Name', "CinderVolume-"+i);
		var size=CinderVolumes.getAndSetValue(row, nameIndexes, 'Size', "20");
		var description=CinderVolumes.getAndSetValue(row, nameIndexes, 'Description');
		
		var sizeNumber = Number(size);
		if(isNaN(sizeNumber)){
			CinderVolumes.check += "\nCinderVolumes: illegal size value for CinderVolume  "+name+" : "+size+"; expecting integer";
			continue;
		} 
		result+="\n#"+name+" "+size+" Gbytes: "+description;
		cloudVolumes.push(new cloudVolume(name, size, description));
	}
	
	// Make the list of CinderVolumes for availableHeat template  
	CinderVolumes.cloudVolumes = cloudVolumes.slice();
	
	if(CinderVolumes.check != "")return CinderVolumes.check;
	return result;
};


// ===========================
// PersistentVolumes settings
// ===========================
var PersistentVolumes = new vnfResource("PersistentVolumes", [
	{name:'Name', type:'text', width:'120px'},
	{name:'Size', type:'text', width:'80px'},
	{name:'Type', type:'choice', width: '80px', choices:['ext3']}, 
	{name:'Access', type:'choice', width: '120px', choices:['ReadWriteOnce','ReadWriteMany','ReadOnlyMany']}, 
	{name:'Reclaim', type:'choice', width: '120px', choices:['Delete','Retain','Recycle']}, 
	{name:'CinderVolume', type:'text', width:'120px'}
	]
	);

PersistentVolumes.help = function(){var help="OpenShift Persistent Volumes:"+
	"\nList of OpenShift Persistent Volumes allocated in OpenStack Cinder volumes:"+
	"\n\t- Name: one word persistent volume name"+
	"\n\t- Size: persistent volume size expressed in Gbytes"+
	"\n\t- Type: file system type"+
	"\n\t- Access: access mode for this persistent volume"+
	"\n\t- CinderVolume: name of the CinderVolume hosting this persistent volume"
	
	return help;
}

PersistentVolumes.build = function(target){
	var nameIndexes = PersistentVolumes.nameIndexes;
	var result = "";
	PersistentVolumes.check="";
	var table = document.getElementById("PersistentVolumes");
	var rowCount = table.rows.length;
	
	var openshiftVolumes = new Array();

	
	for(var i=1; i < rowCount; i++){
		if(result==""){
			result += "\n"
			result += "\n# --------------------------------";
			result += "\n# PersistentVolumes definition";
			result += "\n# -------------------------------- ";
			}
		var row = table.rows[i];
		var name=PersistentVolumes.getAndSetValue(row, nameIndexes, 'Name', "PersistentVolume-"+i);
		var size=PersistentVolumes.getAndSetValue(row, nameIndexes, 'Size', "5");
		var type=PersistentVolumes.getAndSetSelection(table.rows[i], nameIndexes, 'Type', 0);
		var access=PersistentVolumes.getAndSetSelection(table.rows[i], nameIndexes, 'Access', 0);
		var reclaim=PersistentVolumes.getAndSetSelection(table.rows[i], nameIndexes, 'Reclaim', 0);
		var cinder=PersistentVolumes.getAndSetValue(row, nameIndexes, 'CinderVolume', "CinderVolume-"+i);
		if(cinder == undefined || cinder == ''){
			PersistentVolumes.check += "\nPersistentVolumes "+name+" : CinderVolume is required";
			continue;
		}
		if(!CinderVolumes.search('Name', cinder)){
			PersistentVolumes.check += "\nPersistentVolume "+name+": "+cinder+" is undefined in the CinderVolumes section";
			continue;
		}
		
		var sizeNumber = Number(size);
		if(isNaN(sizeNumber)){
			PersistentVolumes.check += "\nPersistentVolumes: illegal size value for volume  "+name+" : "+size+"; expecting integer";
			continue;
		} 
		result+="\n#"+name+" "+size+" Gbytes type: "+type+" access: "+access+" reclaim policy: "+reclaim+" on CinderVolume: "+cinder;
		openshiftVolumes.push(new openshiftVolume(name, size, type, access, reclaim, "~cinderVolumeIdOf"+cinder+"~"));
	}
	
	// Make the list of volumes for availableHeat template  
	PersistentVolumes.openshiftVolumes = openshiftVolumes.slice();
	
	if(PersistentVolumes.check != "")return PersistentVolumes.check;
	return result;
};


//===========================
// Clusters
//===========================
var Clusters = new vnfResource("Clusters", [
	{name:'Name', type:'text', width:'80px'},
	{name:'Endpoint', type:'text', width:'300px'},
	{name:'Token', type:'text', width:'200px'},
	{name:'Targeted', type:'bool'},
	]
	);

Clusters.help = function(){return `Clusters definition:
OpenShift clusters candidate for deployment:
	Name: nickname of this cluster
	Endpoint: OpenShift API endpoint for this cluster. 
		Typically retrieved from a session with: oc config current-context | cut -d/ -f2 | tr - .
	Token: security token for this cluster identifying an authorized user
		Typically retrieved from a session with: oc whoami -t
	Targeted: check this box to deploy the defined resources to this cluster
`
}

var targetedCluster = function(aName, anEndpoint, aToken){
	this.name=aName;
	this.endpoint=anEndpoint;
	this.token=aToken;
}

Clusters.build = function(target){
	var nameIndexes = Clusters.nameIndexes;
	var result="";
	Clusters.check = "";
	Clusters.targeted = new Array();
	var table = document.getElementById("Clusters");
	var rowCount = table.rows.length;
	
	for(var i=1; i < rowCount; i++){
		if(result==""){
			result += "\n# ------------------------------- #";
			result += "\n# Clusters                        #";
			result += "\n# ------------------------------- #";
			};
		var row = table.rows[i];
		var name=Clusters.getAndSetValue(row, nameIndexes, 'Name', "cluster-"+i);
		var endpoint=Clusters.getAndSetValue(row, nameIndexes, 'Endpoint', '$(oc config current-context | cut -d/ -f2 | tr - .)');
		var token=Clusters.getAndSetValue(row, nameIndexes, 'Token', '$(oc whoami -t)');
		var targeted=Nodes.getAndSetChecked(row, nameIndexes, 'Targeted');
		if(targeted){
			if(endpoint.length == 0 || token.length == 0){Clusters.check+="\nClusters section: targeted cluster "+name+" requires both Endpoint and Token definitions"; continue;}
			Clusters.targeted.push(new targetedCluster(name, endpoint, token));
		}
		result+="\n#- "+name+" cluster at endpoint "+endpoint+" with token "+token+" targeted: "+targeted;
	}

	if(Clusters.check != "")return Clusters.check;
	return result;
};


//===========================
// HPE5G resources
//===========================
//Each resource should provide:
//- a type: to be listed in the nvfResource type member: nudsf-dr, ignite...
//- a set of default values defined in hpe5gResources.defaults[type] for: image, tag, template
//- a list of dependencies on other functions defined as a table in hpe5gResources.depends[type], eg nudsf type depends on ignite type
//- for types requiring admin privileges, a true boolean in hpe5gResources.admin[type] so that the user is aware an prevented from failing deployments
//The provided templates can use placeholders replaced at instantation time for:
//- name: ~NAME~
//- project: ~PROJECT~
//- image: ~IMAGE~
//- replicas: ~REPLICAS~
//- requirement on other function types: ~<type>_NAME~: eg ~ignite_NAME~ will be replaced by the ignite instance name in this project
// Resources are not directly instantiated from hpe5gResource but from a class inherited from hpe5gResource, to allow spliting resources in Network functions and other services
var hpe5gResource = function(title, columns, userFiles){
	vnfResource.call(this, title, columns, userFiles);
};
hpe5gResource.prototype = vnfResource.prototype;
hpe5gResource.prototype.constructor = hpe5gResource;


hpe5gResource.prototype.help = function(){var help=this.title+
`
- Type: the type of the resource to deploy
- Name: one word resource name for this instance
- Project: the OpenShift project hosting this resource instance
- URL, Image and tag: the docker image to use for this resource
  Default valid values are provided when fields are left blank.
- insecure: check this box if this URL points to insecure registries
  images from insecure registries are pulled then pushed to the internal registry using docker, properly configured .
  otherwise, images are directly pulled by the OpenShift image stream from their original URL
- Storage, Volume: the storage size with its unit (like 1Gi) and the OpenShift persistent volume used by this resource
- Replicas: number of replicas deployed for this instance.
- Dependencies: comma separated list of resources names resolving this function dependencies within this project
  If undefined, the first resource in the project providing the required type is used.
- Pipeline: create a Jenkins pipeline for this function based on a github project delivering a Jenkinsfile 
	GIT: github project URL, eg: https://github.hpe.com/CMS-5GCS/automated-deployer
	directory: directory in the github project hosting the pipeline definition as a Jenkinsfile, eg pipelines/get_oc_resources
	  Two examples are provided by https://github.hpe.com/CMS-5GCS/automated-deployer/pipelines : 
	  - get_oc_resources: display the OpenShift current project and existing resources
	  - manual_approval: expect the end  user to explicitly approve the build
	branch: (optional) git branch to use, eg: master
	
`;
	return help;
}

hpe5gResource.prototype.build = function(target){
	var nameIndexes = this.nameIndexes;
	var result = "";
	this.check="";
	var table = document.getElementById(this.title);
	var rowCount = table.rows.length;

	for(var i=1; i < rowCount; i++){
		if(result==""){
			result += "\n"
			result += "\n# --------------------------------";
			result += "\n# "+this.title+" definition";
			result += "\n# -------------------------------- ";
			}
		var row = table.rows[i];
		var type=this.getAndSetSelection(table.rows[i], nameIndexes, 'Type');
		if(hpe5gResources.resources[this.title].indexOf(type) < 0){this.check += "\n"+this.title+": "+type+" is unknown in the catalog"; continue;}
		var name=this.getAndSetValue(row, nameIndexes, 'Name', type+"-"+i);
		var project=this.getAndSetValue(row, nameIndexes, 'Project',Misc.getValue('default_project'));
		var URL=this.getAndSetValue(row, nameIndexes, 'URL',hpe5gResources.defaults[type]['URL']);
		var insecure=Nodes.getAndSetChecked(row, nameIndexes, 'insecure');
		var image=this.getAndSetValue(row, nameIndexes, 'Image',hpe5gResources.defaults[type]['image']);
		var tag=this.getAndSetValue(row, nameIndexes, 'Tag', hpe5gResources.defaults[type]['tag']);
		var storage=this.getAndSetValue(row, nameIndexes, 'Storage', hpe5gResources.defaults[type]['storage']);
		var volume=this.getAndSetValue(row, nameIndexes, 'Volume');
		var displayChart="";
		var chart=this.getAndSetValue(row, nameIndexes, 'Chart', hpe5gResources.defaults[type]['chart']);
		var delButton=row.getElementsByClassName("delButton")[0];
		var values=window[this.title + "_Values_" + delButton.id];
		if(chart.length>0)displayChart=" with chart "+chart;
		this.check += checkDependency(this.title=='HelmCharts', [values!=undefined && values.content!=undefined && chart.length>0], this.title+" "+name,", Helm chart and values are required");
		var displayVolume="";
		var replicas=this.getAndSetValue(row, nameIndexes, 'Replicas', "1");
		var dependenciesList=this.getAndSetValue(row, nameIndexes, 'Dependencies');
		var dependencies=undefined;
		if(dependenciesList)dependencies=dependenciesList.split(',');
		if(name.search(/[A-Z]/g) >= 0){this.check += "\n"+this.title+" "+name+" : upper cases are not supported";}
		if(project == undefined || project == ''){this.check += "\n"+this.title+" "+name+" : project is required";}
		var displayImage="";
		if(image == undefined || image == '' ){
			if(this.title!='Operators' && this.title!='HelmCharts')this.check += "\n"+this.title+" "+name+" : image is required";
		}else{displayImage=" running image: "+image+":"+tag;}
		if(storage)displayVolume+=" with "+storage+" storage";
		if(volume !=''){
			if(!PersistentVolumes.search('Name', volume))this.check += "\n"+this.title+" "+name+": "+volume+" is undefined in the PersistentVolumes section";
			else displayVolume+=" on volume: "+volume;
		}
		// Name must be unique accross all hpe5g resources
		if(NetworkFunctions.count('Name', name) + DirectServices.count('Name', name) + IndirectServices.count('Name', name) + Operators.count('Name', name) > 1)this.check += "\n"+this.title+": resource name "+name+" is duplicated across sections "+hpe5gResources.names.join();
		this.check += checkDependency(hpe5gResources.defaults[type]['storage'] != undefined, [storage.length>0], this.title+" "+name,", Storage is required");
		
		var gitURL=this.getAndSetValue(row, nameIndexes, 'Pipeline GIT');
		var gitDirectory=this.getAndSetValue(row, nameIndexes, 'directory');
		var gitBranch=this.getAndSetValue(row, nameIndexes, 'branch', gitURL.length==0 ? '': 'master');
		this.check += checkGroupConsistency([gitURL.length==0, gitDirectory.length==0, gitBranch.length==0], this.title+" "+name+" pipeline configuration inconsistent: ", "three attributes required or none");
		
		var replicasNumber = Number(replicas);
		if(isNaN(replicasNumber)){
			this.check += "\n"+this.title+": illegal replicas value for "+name+" : "+replicas+"; expecting integer";
			continue;
		} 
		var displayReplicas="";
		if(replicas.length>0)displayReplicas=replicas+ " replica(s) of type: ";
		
		// Record this provider to resolve dependencies later per type and per project
		if(!hpe5gResources.provides[type])hpe5gResources.provides[type] = new Array();
		if(!hpe5gResources.provides[type][project])hpe5gResources.provides[type][project]=new Array();
		hpe5gResources.provides[type][project].push(name);
		
		hpe5gResources.openshiftFunctions.push(new openshiftFunction(type, name, image+":"+tag, project, storage, volume, replicas, dependencies, URL, chart, values, hpe5gResources.pipeline(gitURL, gitDirectory, gitBranch)));
		
		if(insecure && hpe5gResources.insecureRegistries.indexOf(URL) < 0)hpe5gResources.insecureRegistries.push(URL);
		
		if(hpe5gResources.admin[type] != undefined && hpe5gResources.admin[type])hpe5gResources.adminList+="\n- "+name+":\tsection: "+this.title+"\tproject: "+project+"\ttype: "+type;
		
		result+="\n#- "+name+": "+displayReplicas+type+" on project: "+project+displayImage+displayVolume+displayChart;
	}
	
	if(this.check != "")return this.check;
	return result;
};

//Class implementing a network function: name, image (including the tag), URL (hosting the image), pipeline, Helm chart 
var openshiftFunction = function(aType, aName, anImage, aProject, aStorage, aVolume, aReplicas, aDependency, aURL, anHelmChart, anHelmChartValues, aPipeline){
	this.type=aType;
	this.name=aName;
	this.image=anImage;
	this.URL=aURL;
	this.project=aProject;
	this.storage=aStorage;
	this.volume="";
	if(aVolume != undefined && aVolume.length > 0)this.volume="volumeName: "+aVolume;
	this.replicas=aReplicas;
	this.dependency=aDependency;
	this.helmChart=anHelmChart; this.helmChartValues=anHelmChartValues;
	this.pipeline=aPipeline;
	// Insecure registries are managed by docker; secured registries are pulled directly from the URL
	this.insecureURL = function(){return hpe5gResources.insecureRegistries.indexOf(this.URL) >= 0;}
	this.imageStream = function(){
		var _imageStream=this.URL+'/'+this.image;
		if(this.insecureURL())_imageStream='docker-registry.default.svc:5000/'+this.project+'/'+this.image;
		return _imageStream;
	}
}

//Resolve dependency of a given resource on a specific type: accept multiple candidates silentlty, just take the first one
openshiftFunction.prototype.resolve = function(type){
	var candidates, result;
	if(hpe5gResources.provides[type])candidates=hpe5gResources.provides[type][this.project];
	if(candidates)
		if(this.dependency)result=candidates.filter(value => -1 !== this.dependency.indexOf(value))[0];
		else result=candidates[0];
	return result
}

//==========================
// Deployed 5G resources
//==========================
var hpe5gResources=new Object;
hpe5gResources.names=['DirectServices','IndirectServices','Operators','NetworkFunctions','HelmCharts'];
hpe5gResources.admin=new Array();

// Reset the list of resources, to be called before building them
hpe5gResources.init = function(){
	hpe5gResources.openshiftFunctions=new Array();
	hpe5gResources.provides=new Array();
	hpe5gResources.projects=new Array();
	hpe5gResources.adminList="";
	hpe5gResources.insecureRegistries=new Array();
	hpe5gResources.insecureRegistriesList="";
}

// Compile the resources from the various resources sections: build the list of projects, registries, and cross check dependencies 
hpe5gResources.compile = function(){
	hpe5gResources.projects=Array.from(new Set(hpe5gResources.openshiftFunctions.map(function(e){return e.project;})));
	if(hpe5gResources.insecureRegistries.length > 0)hpe5gResources.insecureRegistriesList += '"'+hpe5gResources.insecureRegistries.join('","')+'"';
	
	// Check cross functions dependencies
	var check="";
	hpe5gResources.openshiftFunctions.forEach(function(networkFunction){
		// Check if all dependencies for this network function type are satisfied on this project
		hpe5gResources.depends[networkFunction.type].forEach(function(requirement){
			if(networkFunction.resolve(requirement))return;
			check += "\nNetworkFunctions: "+networkFunction.name+" missing dependency "+requirement+" on project "+networkFunction.project;
			if(networkFunction.dependency)check+=" in the provided list: "+networkFunction.dependency;
		});
    });
	return check;
}

//===========================
//NetworkFunctions
//===========================
var NetworkFunctions = new hpe5gResource("NetworkFunctions", [
	{name:'Type', type:'choice', width: '100px', choices: function(){return hpe5gResources.resources['NetworkFunctions'];}}, 
	{name:'Name', type:'text', width:'80px'},
	{name:'Project', type:'text', width:'60px'},
	{name:'URL', type:'text', width:'200px'},
	{name:'insecure', type:'bool'},
	{name:'Image', type:'text', width:'120px'},
	{name:'Tag', type:'text', width:'120px'},
	{name:'Storage', type:'text', width:'60px'},
	{name:'Volume', type:'text', width:'60px'},
	{name:'Replicas', type:'text', width:'40px'},
	{name:'Dependencies', type:'text', width:'100px'},
	{name:'Pipeline GIT', type:'text', width:'200px'},
	{name:'directory', type:'text', width:'120px'},
	{name:'branch', type:'text', width:'120px'}
	]
	);
//===========================
//DirectServices
//===========================
var DirectServices = new hpe5gResource("DirectServices", [
	{name:'Type', type:'choice', width: '100px', choices: function(){return hpe5gResources.resources['DirectServices']}}, 
	{name:'Name', type:'text', width:'80px'},
	{name:'Project', type:'text', width:'60px'},
	{name:'URL', type:'text', width:'200px'},
	{name:'insecure', type:'bool'},
	{name:'Image', type:'text', width:'120px'},
	{name:'Tag', type:'text', width:'120px'},
	{name:'Storage', type:'text', width:'60px'},
	{name:'Volume', type:'text', width:'60px'},
	{name:'Replicas', type:'text', width:'40px'},
	{name:'Dependencies', type:'text', width:'100px'},
	{name:'Pipeline GIT', type:'text', width:'200px'},
	{name:'directory', type:'text', width:'120px'},
	{name:'branch', type:'text', width:'120px'}
	]
	);
DirectServices.help = function(){return NetworkFunctions.help()+
    `NOTES: 
    - ignite on persistent storage deploys three volumes:
      . <name>-work
      . <name>-wal
      . <name>-walarchive
      As a consequence, the total claimed storage size is 3x the user defined size.
    - ignite recommended values for udsf legacy versions are: 
      . URL: docker.io/apacheignite
      . Image: ignite
      . tag: 2.7.5
`;}
//===========================
//IndirectServices
//===========================
var IndirectServices = new hpe5gResource("IndirectServices", [
	{name:'Type', type:'choice', width: '100px', choices: function(){return hpe5gResources.resources['IndirectServices']}}, 
	{name:'Name', type:'text', width:'80px'},
	{name:'Project', type:'text', width:'60px'},
	{name:'URL', type:'text', width:'200px'},
	{name:'insecure', type:'bool'},
	{name:'Image', type:'text', width:'120px'},
	{name:'Tag', type:'text', width:'120px'},
	{name:'Storage', type:'text', width:'60px'},
	{name:'Volume', type:'text', width:'60px'},
	{name:'Replicas', type:'text', width:'40px'},
	{name:'Dependencies', type:'text', width:'100px'},
	{name:'Pipeline GIT', type:'text', width:'200px'},
	{name:'directory', type:'text', width:'120px'},
	{name:'branch', type:'text', width:'120px'}
	]
	);
IndirectServices.help = function(){return NetworkFunctions.help()+
`NOTES: 
- jenkins recommended values for RedHat OpenShift 3 are : 
  . URL: docker.io/openshift
  . Image: jenkins-2-centos7
  . tag:latest 
- grafana default admin password is the name of the instance.
- redis default admin password is the name of the instance.
 `;}
 
//===========================
//Operators
//===========================
var Operators = new hpe5gResource("Operators", [
	{name:'Type', type:'choice', width: '140px', choices: function(){return hpe5gResources.resources['Operators']}}, 
	{name:'Name', type:'text', width:'100px'},
	{name:'Project', type:'text', width:'60px'},
	{name:'Pipeline GIT', type:'text', width:'200px'},
	{name:'directory', type:'text', width:'120px'},
	{name:'branch', type:'text', width:'120px'}
	]
);
Operators.help = function(){var help=this.title+
`
PREREQUISITE: the operators are installed on the target OpenShift infrastructure.
- Type: the type of the operator to instantiate
- Name: one word resource name for this operator instance
- Project: the OpenShift project hosting this operator instance
- Pipeline: create a Jenkins pipeline for this operator instance based on a github project delivering a Jenkinsfile 
	GIT: github project URL, eg: https://github.hpe.com/CMS-5GCS/automated-deployer
	directory: (optional) directory in the github project hosting the pipeline definition as a Jenkinsfile, eg pipelines/get_oc_resources
	  Two examples are provided by https://github.hpe.com/CMS-5GCS/automated-deployer/pipelines : 
	  - get_oc_resources: display the OpenShift current project and existing resources
	  - manual_approval: expect the end  user to explicitly approve the build
	branch: (optional) git branch to use, eg: master
	
`;
return help;
}

//===========================
//HelmCharts
//===========================
var HelmCharts = new hpe5gResource("HelmCharts", [
	{name:'Type', type:'choice', width: '140px', choices: function(){return hpe5gResources.resources['HelmCharts']}},
	{name:'Name', type:'text', width:'100px'},
	{name:'Project', type:'text', width:'60px'},
	{name:'Chart', type:'text', width:'200px'},
	{name:'Values', type:'file', width:'200px'},
	{name:'Pipeline GIT', type:'text', width:'200px'},
	{name:'directory', type:'text', width:'120px'},
	{name:'branch', type:'text', width:'120px'}
	]
);
HelmCharts.help = function(){var help=this.title+
`
PREREQUISITE: Helm is installed on the target OpenShift infrastructure and configured to provide the deployed charts.
- Type: the type of the Helm chart to instantiate: used for default values and dependency check against backing services. Use 'generic' to disable checks.
- Name: one word resource name for this chart instance
- Project: the OpenShift project hosting this chart instance
- Chart: name of the chart to deploy; Helm must be configured on the infrastructure to provide this chart
- Values: local file injected in this chart as deployment values
- Pipeline: create a Jenkins pipeline for this chart instance based on a github project delivering a Jenkinsfile 
	GIT: github project URL, eg: https://github.hpe.com/CMS-5GCS/automated-deployer
	directory: (optional) directory in the github project hosting the pipeline definition as a Jenkinsfile, eg pipelines/get_oc_resources
	  Two examples are provided by https://github.hpe.com/CMS-5GCS/automated-deployer/pipelines : 
	  - get_oc_resources: display the OpenShift current project and existing resources
	  - manual_approval: expect the end  user to explicitly approve the build
	branch: (optional) git branch to use, eg: master
	
`;
return help;
}

//================================================================
// Template fragment defining a build config as a Jenkins pipeline
//================================================================
hpe5gResources.pipeline = function(uri, dir, branch){
if(uri.length == 0)return;
var result=`
- kind: "BuildConfig"
  apiVersion: "build.openshift.io/v1"
  metadata:
    name: "~NAME~"
  spec:
    source:`;
if(dir.length > 0)result+=`
      contextDir: `+dir;
result+=`
      git:
        uri: `+uri;
if(branch.length > 0)result+=`
        ref: `+branch;
result+=`
    strategy:
      jenkinsPipelineStrategy:
        type: JenkinsPipeline
`;
return result;
};

function deploymentHelp(){userOutput(welcomeMsg+
`
Quick user guide for deploying an OpenShift 3.x cluster in an OpenStack infrastructure using ansible: 

0. OpenStack tenant
- Get a tenant on RHOS13 from infra team at https://cmsgvm42.gre.hpecorp.net/hos
 Typical quota: 25 vCPUs, 50Gb RAM, 100Gb disk
- Install and configure the infrastructure VPN as per https://github.hpe.com/OTC-Foundation/sandboxes_user_doc/blob/master/docs/vpn.md
- Connect to your tenant at https://30.118.132.11/dashboard/auth/login
- in the default security group, allow all ports for TCP and UDP ingress: Networks/Security Groups/default/Manage Rules/Add Rule
- create an ssh key pair: Compute/Key Pairs/Create Key Pair, eg mykey
- save the private key, eg mykey.pem
- retrieve the infrastructure certificate: 
 From https://cmsgvm42.gre.hpecorp.net/hos/ click the info button on your request and download the certificate grenoble-infra-root-ca_gs118.crt
(this might fail for RHOS13, please contact the infra team to get a copy of this certificate)

1. Ansible controller
- create a network and a router connected to the external network
- create an instance connected to this network: Compute/Instances/Launch Instance
 from image CentOS 8.x, 
  with 20 Gb disk, 
   4 vCPUs, 
   8Gb RAM 
   embedding this ssh key, 
   and associated with a floating (public) IP, eg 30.118.0.26
- connect to this VM as user centos with the saved ssh key eg: ssh -i mykey.pem centos@30.118.0.26
- install ansible, git httpd-tools java-1.8.0-openjdk-headless and pip from epel repository: 
 sudo  http_proxy=http://16.46.16.11:8080 https_proxy=http://16.46.16.11:8080 yum install -y epel-release 
 sudo  http_proxy=http://16.46.16.11:8080 https_proxy=http://16.46.16.11:8080 yum install -y ansible git httpd-tools java-1.8.0-openjdk-headless python3 python3-pip --enablerepo='epel'
- install shade, passlib, fix decorator and ansible versions: 
 sudo  http_proxy=http://16.46.16.11:8080 https_proxy=http://16.46.16.11:8080 pip3 install python-openstackclient shade passlib decorator===4.4.0 ansible===2.7.4
- clone the CMS5G Core Stack automated deployer from git: 
 http_proxy=http://16.46.16.11:8080 https_proxy=http://16.46.16.11:8080 git clone https://github.hpe.com/CMS-5GCS/automated-deployer.git
- move to this directory 
 cd automated-deployer
- retrieve in this directory from step 0 the infrastructure certificate and the private ssh key file and set ssh compliant access rights eg :
 chmod 0600 *.pem 
- update the environment definition file: OKDRHOS13.env with your credentials according to your tenant as per the OpenStack information: project/API access/view credentials
export OS_IDENTITY_API_VERSION=3
export OS_AUTH_URL="https://30.118.132.11:13000/v3"
export OS_PASSWORD="HP1nvent"
export OS_PROJECT_ID="b5f5a70ae58d4405a780aac02094a264"
export OS_PROJECT_NAME="d3mRHOS13"
export OS_USERNAME="d3m"
export OS_CACERT="grenoble-infra-root-ca_gs118.crt"
- set the ssh key to use:
export CLOUD_SSH_KEY_PAIR="mykey"
export CLOUD_SSH_KEY="/home/centos/openshift-ansible/mykey.pem"
- update the image name as needed:
export CLOUD_IMAGE="Cent OS 7"
- retrieve the infrastructure certificate: grenoble-infra-root-ca_gs118.crt 

2. Define the OpenShift cluster topology including storage and network functions
- retrieve and open in a browser the topology assistant hpe5g.html or start from the example file: five.html
- define the nodes and roles, 
EITHER
- click the Full Stack button, 
- retrieve the Heat template and name it: five.yaml
OR
- click the Resources button, 
- retrieve the shell script deploying the network functions 
- run this script on the first master node 

3. Deploy OpenShift on OpenStack
- set the target environment and credentials, then check ssh key and infrastructure certificate
  source OKDRHOS13.env && ls -l $OS_CACERT $CLOUD_SSH_KEY
- choose a cluster name and the private network root in the OpenStack infra: 3 unique digits like 192.168.55 and launch the script invoking ansible
  ./hpe5g.sh --deploy five --network 192.168.55

4. Enjoy OpenShift 
The first master public IP address is available as $openshift_ip
 30.118.0.24
- Connect to OpenShift GUI on this master node port 8443, eg:
 Browse https://$openshift_ip:8443
- accept the security warning and log on with any name and password
- approve the self signed certificate for the metrics display engine Hawkular by clicking the warning link in another tab
- connect to the master, connect with the user name used in the GUI
 ssh -i $CLOUD_SSH_KEY centos@$openshift_ip	
 oc login -u <user>
- invoke the deployment script
 ./hpe5g.sh

5. Delete the cluster
 - define the target environment and credentials
  source OKDRHOS13.env
- undeploy :
	./hpe5g.sh --remove five
 `
);}

// Shell script dropped on the ems node ready to deploy the volumes, projects, and hpe5g network functions 
// Prerequisites depend on the target: oc/curl
function shellHeader(target){  
var result=`#! /bin/bash

# HPE 5G resources automated deployer: `+document.getElementById("vnfDescriptorWizardVersion").innerHTML+`
# Prerequisites:`;
switch(target){
case 'oc': result+=`
# - OpenShift command line interface installed (oc)
# - current user logged in the target OpenShift cluster: oc login -u <user> -p <password>`; break;
case 'curl': result+=`
# - curl utility installed 
# - network configured to reach all the targeted OpenShift clusters`; break;
default: result+= 'unsupported'; break;
}
result+=`
# Usage: 
# - make this file executable: chmod a+x hpe5g.sh 
# - ./hpe5g.sh --deploy --log hpe5g.log
# Outcome:
# - stdout
# - logs in log_file (default hpe5g.log)

_usage() {
	echo "This client helps you deploy and undeploy HPE 5g resources on OpenShift clusters" 
	echo "Usage: $0 [-d|--deploy|-c|--create | -u|--undeploy|-r|--remove] [-l|--log logfile]"
	echo "Default options: --`+Misc.getValue('default_action')+` --log hpe5g.log"
}

# Cosmetic: ellipsize too long strings to keep cute logs: keep _max characters
_cutTooLong() {
	local _cut="$*"
	local _max=150
	if (( $\{#_cut} > $_max )) ; then
		_cut=$(echo $* | cut -c1-$_max)
		_cut+="..."
	fi
	echo $_cut
}

_log_() {
    echo -e $(date) $(_cutTooLong $*)
    echo -e $(date) $* &>> $hpe5g_log_file
    return 0
}

_warn_() {
	local RED='\\033[0;31m'
	local NC='\\033[0m' # No Color
	_log_ "$\{RED}WARNING$\{NC}: $*"
}

_fail_() {
    _log_ "FATAL ERROR: $*.  Now exiting... Check $hpe5g_log_file"
    exit 1
}

# Default parameters values
hpe5g_log_file="hpe5g.log"
_deploy=$([[ "`+Misc.getValue('default_action')+`" != "undeploy" ]] && echo true || echo false);
_displayedAction=$($_deploy && echo Deploying || echo Undeploying)

while [[ "$#" -gt 0 ]]; do case $1 in
  -d|--deploy|-c|--create) _deploy=true ; _displayedAction="Deploying";;
  -u|--undeploy|-r|--remove) _deploy=false ; _displayedAction="Undeploying";;
  -l|--log) hpe5g_log_file="$2"; shift;;
  -h|--help) _usage ; exit 0;;
  *) echo "Unsupported parameter: $1 ; try $0 --help"; exit 1;;
esac; shift; done
`;
return result;};

function hpe5gDeploymentScript(warningMessage){
var _shellTemplate=`
if $_deploy ; then 
	_ocAction="apply"
	_helmAction="'{print \\"helm upgrade --install \\" \\$2,\\$3 \\" --values \\" \\$N}'"
else
	_helmAction="'{print \\"helm delete \\" \\$2}'"
	_ocAction="delete"
fi

# checking user logged in
oc_user=$(oc whoami)
test -n "$oc_user" && [ "$oc_user" != "system:admin" ] || _fail_ "Current user is $\{oc_user:-unknown}: please log as user: oc login -u user"
_log_ "$_displayedAction CMS5G Core Stack as user $oc_user"
_log_ "Checking projects"
oc_projects="~PROJECTS~"
for _project in $oc_projects ; do oc project $_project &>> $hpe5g_log_file || oc new-project $_project --display-name="Project $_project" --description='~PROJECT_DESCRIPTION~' &>> $hpe5g_log_file || _fail_ "Cannot find or create project $_project missing" ; done
if echo guess | oc login -u system:admin &>> $hpe5g_log_file ; then
_log_ "Listing nodes as system:admin"
oc get nodes -o wide &>> $hpe5g_log_file
oc login -u $oc_user &>> $hpe5g_log_file
`;
if(warningMessage){
	_shellTemplate+="else";
	warningMessage.split("\n").forEach(function(line){_shellTemplate+='\n _warn_ "'+line+'"';});
}
_shellTemplate+=
`
fi
_log_ "Listing pods as $oc_user"
oc get pods -o wide  -n default  &>> $hpe5g_log_file
oc_image_projects=(~IMAGES_INSECURE_PROJECTS~)
oc_image_urls=(~IMAGES_INSECURE_URLS~)
oc_images=(~IMAGES_INSECURE~)
[[ $\{#oc_images[@]} != 0 ]] && _log_ "Populating the docker registry with services images: pull, tag and push"
  for _iImage in $\{!oc_images[@]} ; do
    sudo docker login -u $(oc whoami) -p $(oc whoami -t) docker-registry.default.svc:5000 &>> $hpe5g_log_file || _fail_ "Cannot connect to the internal docker registry as user $oc_user"
    sudo docker pull $\{oc_image_urls[$_iImage]}/$\{oc_images[$_iImage]} || _fail_ "Cannot pull $\{oc_image_urls[$_iImage]}/$\{oc_images[$_iImage]}"
    sudo docker tag $\{oc_image_urls[$_iImage]}/$\{oc_images[$_iImage]} docker-registry.default.svc:5000/$\{oc_image_projects[$_iImage]}/$\{oc_images[$_iImage]} || _fail_ "Cannot tag $\{oc_image_urls[$_iImage]}/$\{oc_images[$_iImage]}"
	sudo docker push docker-registry.default.svc:5000/$\{oc_image_projects[$_iImage]}/$\{oc_images[$_iImage]} || _fail_ "Cannot push docker-registry.default.svc:5000/$\{oc_image_projects[$_iImage]}/$\{oc_images[$_iImage]}"
  done
if echo guess | oc login -u system:admin &>> $hpe5g_log_file ; then
_log_ "Relaxing security policy to match network functions requirements, approving pending certificates"
oc adm policy add-scc-to-user anyuid system:serviceaccount  &>> $hpe5g_log_file &&
oc adm policy add-scc-to-user privileged system:serviceaccount  &>> $hpe5g_log_file &&
oc adm policy add-scc-to-group anyuid system:authenticated  &>> $hpe5g_log_file &&
oc adm policy add-role-to-group view system:serviceaccounts &>> $hpe5g_log_file &&
oc policy add-role-to-user view system:serviceaccount &>> $hpe5g_log_file || _fail_ "Cannot relax security settings"
if test -n "$(oc get csr -o name)" ; then oc get csr -o name | xargs oc adm certificate approve &>> $hpe5g_log_file || _fail_ "Cannot approve pending certificates" ; fi
if test -f openshift_volumes.yaml ; then _log_ "$_displayedAction the persistent volumes with idempotence" && oc process -f openshift_volumes.yaml | oc $_ocAction -f - &>> $hpe5g_log_file && oc get persistentvolumes -o wide || _fail_ "Cannot create persistent volumes" ; fi
fi
_log_ "$_displayedAction the network functions and Helm instances"
for _project in $oc_projects; do 
	oc project $_project &>> $hpe5g_log_file || _fail_ "Cannot switch to project $_project"
	# File naming convention for Network functions: openshift_project_<project>.yaml
	# File naming convention for Helm instances: openshift_helm_<project>~<name>~<template>~.yaml
	if test -f openshift_project_$_project.yaml ; then _log_ "$_displayedAction openshift_project_$_project.yaml on project $_project" && oc process -f openshift_project_$_project.yaml | oc $_ocAction -f - &>> $hpe5g_log_file && rm -f openshift_project_$_project.yaml &>> $hpe5g_log_file || _fail_ "$_displayedAction openshift_project_$_project.yaml "; fi
	for _helmValues in $(ls openshift_helm_$\{_project}*.yaml 2> /dev/null) ; do _log_ "$_displayedAction $_helmValues on project $_project" && $(ls $_helmValues | eval awk -F'~' $_helmAction) &>> $hpe5g_log_file && rm -f $_helmValues &>> $hpe5g_log_file || _fail_ "$_displayedAction Helm instance on project $_project" ; done
	# Undeployment: wait for pods termination  
	while [[ "$_ocAction" == "delete" ]] && _log_ "Waiting 30s for terminating pods on project $_project" && sleep 30 && oc get pods 2> /dev/null | grep -e Terminating &>> $hpe5g_log_file ; do : ; done
	# Indulge 5 seconds to stabilize, then delete the project if no pods, otherwise log a status
	sleep 5s && test -n "$(oc get pods --namespace $_project 2>&1 >/dev/null)" && _log_ "No remaining pods in project $_project: deleting" && oc delete project $_project &>> $hpe5g_log_file || oc get all --namespace $_project &>> $hpe5g_log_file 
done
oc login -u $oc_user &>> $hpe5g_log_file || _fail_ "Cannot log as $oc_user"
_log_ "$_displayedAction completed: check $hpe5g_log_file"
`;
return _shellTemplate
	.replace(/~PROJECT_DESCRIPTION~/g,document.getElementById("quickDescription").value+". Built from HPE5g assistant on: "+Date())
	.replace(/~PROJECTS~/g,hpe5gResources.projects.join(' '))	// Resolve the list of projects
	.replace(/~IMAGES_INSECURE_PROJECTS~/g,hpe5gResources.openshiftFunctions.map(function(e){if(e.insecureURL())return e.project;}).join(' '))	// Resolve the list of projects per image
	.replace(/~IMAGES_INSECURE_URLS~/g,hpe5gResources.openshiftFunctions.map(function(e){if(e.insecureURL())return e.URL;}).join(' '))	// Resolve the list of URLs per image
	.replace(/~IMAGES_INSECURE~/g,hpe5gResources.openshiftFunctions.map(function(e){if(e.insecureURL())return e.image;}).join(' '))	// Resolve the list of insecure images
;}

// Return the Helm values files, one per helm instance 
function hpe5gHelmValues(header, footer, tab){
	var result="";
	hpe5gResources.openshiftFunctions.forEach(function(networkFunction){
		if(networkFunction.helmChartValues == undefined)return;
		var helmValues="\n"+networkFunction.helmChartValues.content;
		if(header != undefined)result+=header(networkFunction.project, networkFunction.name, networkFunction.helmChart);
		if(tab != undefined)helmValues=helmValues.replace(/\n/g, "\n"+tab);	// indentation of objects compared to the project header
		result+=helmValues;
		if(footer != undefined)result+=footer(networkFunction.project, networkFunction.name);
	});
	return result;
}
// Return the OpenShift network functions templates, one per project
function hpe5gNetworkFunctions(header, footer, tab, singleProject){
	var templateHeader=
`
apiVersion: v1
kind: Template
metadata:
  name: ~PROJECT~
  annotations:
    description: network functions and backing services for project ~PROJECT~
objects:
`;
	var result="";
	hpe5gResources.projects.forEach(function(project){
		if(singleProject != undefined && project != singleProject)return;
		// List of NetworkFunctions deployed on openshift 
		// Replace in the provided template:
		// - name, image, project, volume and replicas with the actual values for this function
		// - dependencies names with the actual name, defined in the template as ~<requirement>_NAME~
		var _header=templateHeader;
		hpe5gResources.openshiftFunctions.forEach(function(networkFunction){
		var deployment=hpe5gResources.defaults[networkFunction.type]['template'];
		if(networkFunction.project != project || deployment == undefined)return;
		if(networkFunction.pipeline != undefined)deployment+=networkFunction.pipeline;
		if(header != undefined && _header.length>0)result+=header(project);
		deployment=_header+deployment.replace(/\n/g, "\n  ");	// indentation of objects compared to the header
		if(tab != undefined)deployment=deployment.replace(/\n/g, "\n"+tab);	// indentation of objects compared to the project header
		_header=''; // only one header per project
		deployment=deployment
		.replace(/~NAME~/g,networkFunction.name)
		.replace(/~PROJECT~/g,networkFunction.project)
		.replace(/~IMAGE~/g,networkFunction.image)
		.replace(/~IMAGE_STREAM~/g,networkFunction.imageStream())
		.replace(/~REPLICAS~/g,networkFunction.replicas);
		if(networkFunction.storage.length>0){
			deployment=deployment
			.replace(/~STORAGE~/g,networkFunction.storage)
			.replace(/~VOLUME~/g,networkFunction.volume)
			.replace(/~PERSISTENCE_START~|~PERSISTENCE_END~/mg,'');
		}else{
			deployment=deployment.replace(/~PERSISTENCE_START~[\s\S]*?~PERSISTENCE_END~/mg,'');
		}
		
		hpe5gResources.depends[networkFunction.type].forEach(function(requirement){
			var ereg=new RegExp("~"+requirement+"_NAME~","g");
			deployment=deployment.replace(ereg, networkFunction.resolve(requirement));
			});
		result+=deployment;
		});
		if(footer != undefined && _header.length==0)result+=footer(project);
	});
	return result;
}

// ===========================
// OpenShift ansible inventory build
// ===========================
// If no target is specified, publish the inventory in the user output area (or errors)
// Otherwise, just return the same to the caller
function buildInventory(target, engine){
	var quickDescription = document.getElementById("quickDescription");
	quickDescription.setAttribute("value", quickDescription.value);
	document.title = "CMS5G Core Stack "+ quickDescription.value;
	
	consistency.init();
	var warnings = "";
	vnfPorts = new Array();
	
	var openshift = "# -------------------------------------------------------------";
	openshift += "\n# "+quickDescription.value;
	openshift += "\n# CMS HPE 5g openshift inventory generated by the builder "+document.getElementById("vnfDescriptorWizardVersion").innerHTML;
	openshift += "\n# Build date: "+Date();
	openshift += "\n# -------------------------------------------------------------";
	openshift += "\n";
	openshift += "\nansible_become=yes";
	// Immutable part from the environment
	if(target == 'Heat'){
	openshift += "\n# Openstack";
	openshift += "\nopenshift_cloudprovider_kind=openstack";
	openshift += "\nopenshift_cloudprovider_openstack_auth_url=\"{{ lookup('env','OS_AUTH_URL') }}\"";
	openshift += "\nopenshift_cloudprovider_openstack_username=\"{{ lookup('env','OS_USERNAME') }}\"";
	openshift += "\nopenshift_cloudprovider_openstack_password=\"{{ lookup('env','OS_PASSWORD') }}\"";
	openshift += "\nopenshift_cloudprovider_openstack_tenant_id=\"{{ lookup('env','OS_PROJECT_ID') }}\"";
	openshift += "\nopenshift_cloudprovider_openstack_tenant_name=\"{{ lookup('env','OS_PROJECT_NAME') }}\"";
	openshift += "\n# Global Proxy Configuration";
	openshift += "\n# These options configure HTTP_PROXY, HTTPS_PROXY, and NOPROXY environment";
	openshift += "\n# variables for docker and master services.";
	openshift += "\nopenshift_http_proxy=\"{{ lookup('env','OPENSHIFT_HTTP_PROXY') }}\"";
	openshift += "\nopenshift_https_proxy=\"{{ lookup('env','OPENSHIFT_HTTPS_PROXY') }}\"";
	openshift += "\nopenshift_no_proxy='.localdomain'";
	openshift += "\n# Most environments do not require a proxy between OpenShift masters, nodes, and";
	openshift += "\n# etcd hosts. So automatically add those host names to the openshift_no_proxy list.";
	openshift += "\n# If all of your hosts share a common domain you may wish to disable this and";
	openshift += "\n# specify that domain above.";
	openshift += "\nopenshift_generate_no_proxy_hosts=True";
	openshift += "\nansible_ssh_user=\"{{ lookup('env','CLOUD_DEFAULT_USER') }}\"";
	}

	hpe5gResources.init();
	vnfResources.forEach(function(e,i,t){
		openshift += e.build(target, engine);
		warnings += e.check;
	});
	warnings += hpe5gResources.compile();
	warnings += consistency.check();
	openshift += "\n"
	if(warnings != ""){
		userOutput(warnings);
		return "";
	}

	if(target == undefined){
		userOutput(openshift);	
		
		var blobDesc = new Blob([openshift], {type: "text/plain;charset=utf-8"});
		var a = document.createElement('a');
		a.href = window.URL.createObjectURL(blobDesc);
	    a.download = "hpe5g.properties";
	    document.body.appendChild(a);
		a.click();
		document.body.removeChild(a);
	}
	return openshift;
}

//=================================
// Session management
//=================================
function sessionHelp(){userOutput(
`Save:
	Saved sessions are self-contained entities, and can be edited at will to reflect topology or feature changes, then saved again as new or modified sessions.
	By clicking the Save button, the whole HTML document is saved in the Download folder managed by the browser as a file named hpe5g.saved.html.
	This saved session gathers all HTML resources defined by the user in a single standalone file.
	NOTE: user loaded files are not part of the HTML document and must be reloaded from the saved session (catalog, Helm values, ...)

Dump:
	Produces a Json image of the current session, as a file named hpe5g.json in the Download folder of the browser.
	This light image does not contain the HTML document; it can be injected by the PUT verb of the Restful interface in headless mode,
	or imported to another session using the Import button.
	
Import:
	Besides, it may be useful to import an existing session in the current one, typically to merge sections from several sessions, 
	or to upgrade an existing session to a new version of the CMS5G Core Stack Assistant, thus benefiting from new features.
	To that aim, from the importing session, click the session file chooser button, and select the imported session file, either
	as a Json or Html file.
	A summary of imported sections is displayed in the text area; it is the user's responsibility to check the merged result 
	and remove or fix inconsistencies before building.

`)};
function saveSession(){
	var quickDescription = document.getElementById("quickDescription");
	quickDescription.setAttribute("value", quickDescription.value);
	
	var blobPage = new Blob([document.documentElement.innerHTML], {type: "text/plain;charset=utf-8"});
	var a = document.createElement('a');
	a.href = window.URL.createObjectURL(blobPage);
    a.download = "hpe5g.saved.html";
    document.body.appendChild(a);
	a.click();
	document.body.removeChild(a);
}

function importSession(){
	switch(importedSession.contentType){
	case 'html':
		var importedWindow = window.open('', "importedDocument");
		try{
		importedWindow.document.write(importedSession.content);
		var summary = "Import summary";
		var importedQuickDescription = importedWindow.document.getElementById("quickDescription").value;
		if(importedQuickDescription != ""){
			summary += "\nVNF description: " + importedQuickDescription;
			var quickDescription = document.getElementById("quickDescription");
			quickDescription.value += importedQuickDescription;
			quickDescription.setAttribute("value", quickDescription);
		}
		vnfResources.forEach(function(e,i,t){summary += e.import(importedWindow.document);});
		userOutput(summary);
		} catch(e){
			alert("Write to document failed, please try another browser\n" + e.message);
		}
		break;
	case 'json':
		if(jsonSession(importedSession.content))userOutput(importedSession.content);
		break;
	default:
		userOutput("Unsupported content type: "+importedSession.contentType+" ; expected html or json");
		break;
	}
	// Display populated sections
	vnfResources.forEach(function(e,i,t){e.display(!e.isEmpty())});
}

// Import/export the current session as Json payload or import as a JS object
function jsonSession(payload){
	if(payload){
		// Populate the session with provided payload
		var error="";
		// if the payload type is not an object, assume a json string and parse
		try {
			var sections = payload;
			if(typeof(payload) != 'object')sections=JSON.parse(payload); 
			if(!sections || !sections.length){return true;}	
			Object.keys(sections).forEach(function(s) {
				var section=Object.keys(sections[s])[0];
				if(!window[section]){
					error+="Unexpected section: "+section+"\n\tExpecting one of "+vnfResources.map(function(e){return e.title;}).join()+"\n";
					return;
				}
				Object.values(sections[s])[0].forEach(function(row){
					var line = new Array();
					Object.keys(row).forEach(function(attribute) {
						var x=Object.keys(row[attribute]);
						var y=Object.values(row[attribute]);
						line.push({column:x[0], value:y[0]});
						});
					var check=window[section].add(line);
					if(check)error+=check;
				});
			});
			if(error)throw error;
		  } catch (ex) {
			userOutput("JSON parser exception received:\n"+ex);
			return false;
		  }
		return true;
	}
	var result = new Array;
	vnfResources.forEach(function(e){var v=e.dump(); if(v.length)result.push({[e.title]:v});});
	var jsonPayload=JSON.stringify(result);
	userOutput(jsonPayload);
	// Stop there if headless, ie no user interface
	if(Misc.getValue('headless'))return true;
	
	var blobJson = new Blob([jsonPayload], {type: "text/plain;charset=utf-8"});
	var a = document.createElement('a');
	a.href = window.URL.createObjectURL(blobJson);
    a.download = "hpe5g.json";
    document.body.appendChild(a);
	a.click();
	document.body.removeChild(a);
	
	return true;
}

// =============================
// OpenShift Heat template build
// =============================
function buildHeatTemplate(){
	var useHeatVolumes = 'none';
	var oc_version=document.getElementById("oc_version").value;
	
	// Build the inventory for Heat (or get the errors) and do not publish
	// Required soon enough to get Heat specific variables properly setup
    var openshift = buildInventory('Heat');
	if(openshift.length == 0)return false;
    
	var n0="\n";
	var quickDescription = document.getElementById("quickDescription");
	var heat="heat_template_version: 2013-05-23"
	heat+=n0+"description: '"+quickDescription.value+"'";
	heat+=n0+"parameters:";
	heat+=n0+"  NetworkRoot:";
    heat+=n0+"    type: string";
    heat+=n0+"    label: Private network";
    heat+=n0+"    description: 3 dot separated bytes defining the 24 first bits of the internal networks, e.g. 192.168.100";
    heat+=n0+"    default: 192.168.100";
	heat+=n0+"  Image:";
    heat+=n0+"    type: string";
    switch(useHeatVolumes){
    	case 'none':    	heat+=n0+"    description: The name of the image used to instantiate storage on MSE nodes"; break;
    	case 'from image':	heat+=n0+"    description: The name of the image used to instantiate MSE volumes"; break;
    	case 'from master':	heat+=n0+"    description: The id of the master volume used to instantiate MSE volumes"; break;
    }
    heat+=n0+"    default: 'Centos 7.6'";
	heat+=n0+"  ExternalNetwork:";
    heat+=n0+"    type: string";
    heat+=n0+"    description: The name of the external public network used to connect floating IPs";
    heat+=n0+"    default: ext-net";
    heat+=n0+"  AvailabilityZone:";
    heat+=n0+"    type: string";
    heat+=n0+"    label: Availability zone";
    heat+=n0+"    description: The name of the zone hosting the MSE nodes";
    heat+=n0+"    default: nova";
	heat+=n0+"  flavorStandard:";
    heat+=n0+"    type: string";
    heat+=n0+"    description: The name of the openstack flavor used to build the worker nodes";
    heat+=n0+"    default: "+Flavors['openstack']['flavorStandard'].name;
	heat+=n0+"  flavorPerformance:";
    heat+=n0+"    type: string";
    heat+=n0+"    description: The name of the openstack flavor used to build the master nodes";
    heat+=n0+"    default: "+Flavors['openstack']['flavorPerformance'].name;
	heat+=n0+"  flavorSmall:";
    heat+=n0+"    type: string";
    heat+=n0+"    description: The name of the openstack flavor used to build the etcd nodes";
    heat+=n0+"    default: "+Flavors['openstack']['flavorSmall'].name;
	heat+=n0+"  key_name:";
    heat+=n0+"    type: string";
    heat+=n0+"    description: the ssh key injected in the instances for remote access";
    heat+=n0+"    default: ''";
    if(useHeatVolumes != 'none'){
	heat+=n0+"  VolumeSize:";
    heat+=n0+"    type: number";
    heat+=n0+"    description: The size in Gb of the volumes attached to the nodes.";
    heat+=n0+"    default: 20";
	}
	heat+=n0;
	heat+=n0+"resources:";
	
	// Create networks from Networks.heatNetworks array: 
	// The networks are to be created in the interface number order to ensure that ethX is actually connected to interface X
	// One common router
	heat+=n0+"  Router:";
    heat+=n0+"    type: OS::Neutron::Router";
    heat+=n0+"    properties:";
    heat+=n0+"      admin_state_up: True";
    heat+=n0+"      name: { get_param : 'OS::stack_name' }";
	heat+=n0+"  Gateway:";
    heat+=n0+"    type: OS::Neutron::RouterGateway";
    heat+=n0+"    properties:";
    heat+=n0+"      network: { get_param: ExternalNetwork }";
    heat+=n0+"      router_id: { get_resource: Router }";

	var networkPrefix = 'Eth';
	var mgmtName = networkPrefix + Networks.heatNetworks['MGMT']; 
    
    for(var i = 0; i <= Networks.heatMaxNetwork; i++){
	var interfaceName = networkPrefix+i;	// network name, Networks.heatMaxNodes addresses large
	var cidr = Networks.heatMaxNodes*i;		// first address in this network
	var gateway = cidr + 1;	// gateway IP for this network
	heat+=n0+"  "+interfaceName+":";
    heat+=n0+"    type: OS::Neutron::Net";
    heat+=n0+"    properties:";
	heat+=n0+"      name: {list_join: [ '-', ['"+interfaceName+"', { get_param : 'OS::stack_name' }]]}";
	heat+=n0+"  "+interfaceName+"-subnet:";
    heat+=n0+"    type: OS::Neutron::Subnet";
    heat+=n0+"    properties:";
    heat+=n0+"      name: {list_join: [ '-', ['"+interfaceName+"', { get_param : 'OS::stack_name' }]]}";
    heat+=n0+"      enable_dhcp: True";
    heat+=n0+"      network: { get_resource: "+interfaceName+" }";
    heat+=n0+"      cidr: { list_join: [ '.', [{ get_param : NetworkRoot}, '"+cidr+"/"+Networks.heatCidrLength+"']]}";
    heat+=n0+"      gateway_ip: { list_join: [ '.', [{ get_param : NetworkRoot}, '"+gateway+"']]}";
    }

	// Connect the management network to the router for floating IPs  
	heat+=n0+"  Router-gw-int:";
    heat+=n0+"    type: OS::Neutron::RouterInterface";
    heat+=n0+"    properties:";
    heat+=n0+"      router_id: { get_resource: Router }";
    heat+=n0+"      subnet_id: { get_resource: "+mgmtName+"-subnet }";
    
    // addr will resolve all ip addresses parameters as a reference to their relative port
    var addr=""; 
    
    var nodesNames = Nodes.cloudNodes.map(function(e){return e.name;});
    
    // For each node: create the ports and optional associated floating IP on all networks, the volume and the instance
    nodesNames.forEach(function(name, indexNode){
    	// Create one port on every network to ensure proper interface numbering, but connect only used interfaces
    	// Prepare the ports declared in the instance as yaml instructions in this variable: port
    	var port=""
    	for(var iNetwork = 0; iNetwork <= Networks.heatMaxNetwork; iNetwork++){
			// VIP processing in Heat/OpenStack: 
			// - a VIP is instantiated as a port
			// - a VIP is declared as allowed_address_pairs on the load balancer nodes
	    	
	    	var interfaceName = networkPrefix+iNetwork;	// network name, Networks.heatMaxNodes addresses large
	    	var interfaceUp = "True";
	    	if(Nodes.cloudNodes[indexNode].interfaces.indexOf(iNetwork) == -1)interfaceUp = "False";
	    	heat+=n0+"  "+name+"-"+interfaceName+"-port:";
	    	heat+=n0+"    type: OS::Neutron::Port";
	    	heat+=n0+"    properties:";
	      	heat+=n0+"      admin_state_up : "+ interfaceUp;
	      	heat+=n0+"      network: { get_resource: "+interfaceName+" }";
	      	
	      	// if this node has VIPs, add allowed_address_pairs accordingly
	      	if(Nodes.cloudNodes[indexNode].hasVIP){
	      		var allowed_address_pairs_header=n0+"      allowed_address_pairs:";
	      		// Search for VIPs on this interface on all nodes
	      		nodesNames.forEach(function(nameVIP, indexVIP){
	      			// if this node is a VIP
	      			if(Nodes.cloudNodes[indexVIP].isVIP){
	      				// This node is a VIP: add an allowed address for all concerned interfaces
	      				for(var iVIP = 0; iVIP <= Networks.heatMaxNetwork; iVIP++){
	      					// if this VIP is not defined on this interface or disconnected, continue
	      					if(iNetwork != iVIP || interfaceUp != "True")continue;
	      					// Enable this address in the firewall
	      					heat+=allowed_address_pairs_header;
	      					allowed_address_pairs_header=""; 
	      					heat+=n0+"        - ip_address: {get_attr: ["+nameVIP+"-"+networkPrefix+iVIP+"-port, fixed_ips, 0, ip_address]}";
	      				} // add an allowed address for all concerned interfaces
	      			} // if this node is a VIP
	      		}); // Search for VIPs on this interface
	      	}// if this node has VIPs
	      	
	      	port+=n0+"        -";
	      	port+=n0+"          port: { get_resource: "+name+"-"+interfaceName+"-port}";
	      	
	      	// Resolve ip address for this port on this node
	      	if(Networks.heatNetworks['MGMT'] == iNetwork)	addr+=n0+"~"+name+"_mgmt~: {get_attr: ["+name+"-"+interfaceName+"-port, fixed_ips, 0, ip_address]}";
      	}
      	if(Nodes.cloudNodes[indexNode].interfaces.indexOf(heatPublicInterface) != -1){
	   		heat+=n0+"  "+name+"-"+mgmtName+"-floatingIP:";
	    	heat+=n0+"    type: OS::Neutron::FloatingIP";
	    	heat+=n0+"    properties:";
	      	heat+=n0+"      floating_network: { get_param: ExternalNetwork }";
	      	heat+=n0+"  "+name+"-"+mgmtName+"-floatingIPassociation:";
	    	heat+=n0+"    type: OS::Neutron::FloatingIPAssociation";
	    	heat+=n0+"    properties:";
	      	heat+=n0+"      port_id: { get_resource: "+name+"-"+mgmtName+"-port }";
	      	heat+=n0+"      floatingip_id: { get_resource: "+name+"-"+mgmtName+"-floatingIP }";
	      	// Resolve public ip addresses for this node
	      	addr+=n0+"~"+name+"_pub~: {get_attr: ["+name+"-"+mgmtName+"-floatingIP, floating_ip_address]}";
      	}
      	
      	// if this node is a VIP, neither volume nor instance are needed
      	if(!Nodes.cloudNodes[indexNode].isVIP){
      	heat+=n0+"  "+name+":";
    	heat+=n0+"    type: OS::Nova::Server";
    	heat+=n0+"    properties:";
      	heat+=n0+"      name: "+name;
      	if(useHeatVolumes != 'none'){
      	heat+=n0+"      block_device_mapping: [{ device_name: 'vda', volume_id : { get_resource: "+name+"-Volume } }]";
      	}else{
      	heat+=n0+"      image: { get_param: Image }"; 
      	}
      	heat+=n0+"      flavor: { get_param: "+Nodes.cloudNodes[indexNode].flavor+" }";
      	heat+=n0+"      availability_zone: { get_param: AvailabilityZone }";
      	heat+=n0+"      key_name: { get_param: key_name }";
      	heat+=n0+"      networks:";
      	heat+=port;
    	}  	// if this node is a VIP, neither volume nor instance are needed
    	
     	// On the ems (first master), push the openshift templates as yaml files
     	if(Nodes.cloudNodes[indexNode].isEms){
      	heat+=n0+"      config_drive: True";
      	heat+=n0+"      user_data_format: 'RAW'";
		heat+=n0+"      user_data:";
		heat+=n0+"        str_replace:";
	  	heat+=n0+"          template: |";
	  	heat+=n0+"            #!/bin/bash";	  	
		
	    // File dropped on the ems ready for deployment
	    heat+=n0+"            cat > /home/centos/openshift_volumes.yaml << 'EOFILE'";
	    // OpenShift system level functions: volumes
	    heat+=n0+'            kind: Template';
	    heat+=n0+'            apiVersion: v1';
	    heat+=n0+'            metadata:';
	    heat+=n0+'              name: system';
	    heat+=n0+'              annotations:';
	    heat+=n0+'                description: persistent volumes for '+document.getElementById("quickDescription").value;
	    heat+=n0+'            objects:';

		//  list of PersistentVolumes for openshift persistent storage as an OpenShift template ready to create
	    PersistentVolumes.openshiftVolumes.forEach(function(volume, i){
	    heat+=n0+'              - kind: "PersistentVolume"';
	    heat+=n0+'                apiVersion: "v1"';
	    heat+=n0+'                metadata:';
	    heat+=n0+'                  name: "'+volume.name+'"';
	    heat+=n0+'                spec:';
	    heat+=n0+'                  capacity:';
	    heat+=n0+'                    storage: "'+volume.size+'Gi"';
	    heat+=n0+'                  accessModes:';
	    heat+=n0+'                    - "'+volume.access+'"';
		heat+=n0+'                  persistentVolumeReclaimPolicy: '+volume.reclaim;
	    heat+=n0+'                  cinder:';
	    heat+=n0+'                    fsType: "'+volume.type+'"';
	    heat+=n0+'                    volumeID: "'+volume.cinder+'"';
	    });
	    heat+=n0+"            EOFILE";
	    heat+=n0+"            chown centos:centos /home/centos/openshift_volumes.yaml && chmod a+r /home/centos/openshift_volumes.yaml";

		// Shell script dropped on the ems node ready to deploy the volumes, projects, and hpe5g network functions 
		heat+=n0+"            cat > /home/centos/hpe5g.sh << 'EOFILE'";
		heat+=n0.concat(shellHeader('oc'),hpe5gDeploymentScript())
		.replace(/\n/g, "\n"+  
	             '            ');	// fix the descriptor indentation as expected by Heat
		heat+=n0+"            EOFILE";
		heat+=n0+"            chown centos:centos /home/centos/hpe5g.sh && chmod a+rx /home/centos/hpe5g.sh";
	 	// Resolve cinder volumes Ids
	 	heat+=n0+"          params:";
	 	CinderVolumes.cloudVolumes.forEach(function(volume, i){
	    heat+=n0+"            ~cinderVolumeIdOf"+volume.name+"~: {get_resource: "+volume.name+"}";
	 	});
		// Resolve ip addresses parameters 
	    heat+=addr.replace(/\n/g, "\n"+  
			     "            ");	// fix the descriptor indentation as expected by Heat;		
	  } // if this node is the ems
    }); // For each node: create the resources
	
	// For each CinderVolume
	CinderVolumes.cloudVolumes.forEach(function(volume){
	heat+=n0+"  "+volume.name+":";
    heat+=n0+"    type: OS::Cinder::Volume";
    heat+=n0+"    properties: ";
    heat+=n0+"      name: "+volume.name;
    heat+=n0+"      size: "+volume.size;
    heat+=n0+"      description: "+volume.description;
	}); 
	
    // Add outputs:
    heat+=n0+"outputs:";
	
    heat+=n0+"  openshift_inventory:";
    heat+=n0+"    description: the ansible inventory deploying the openshift cluster";
    heat+=n0+"    value:";
    heat+=n0+"      str_replace:";
    heat+=n0+"        template: |";
	heat+=n0+"            "+openshift.replace(/\n/g, "\n"+  
		            "            ");	// fix the descriptor indentation as expected by tosca
	// Resolve ip addresses parameters 
    heat+=n0+"        params:"+addr.replace(/\n/g, "\n"+  
		     "          ");	// fix the descriptor indentation as expected by Heat;;
    //  list of public nodes
    heat+=n0+"  public_nodes:";
    heat+=n0+"    description: List of hosts as a name, fqdn, public ip address and groups membership";
    heat+=n0+"    value:";
    // For each non VIP node having a public IP address, required for Ansible client access: publish the name, fqdn, public IP address and group 'base' plus 'ems' for the last node
    nodesNames.forEach(function(name, indexNode){ if(Nodes.cloudNodes[indexNode].isVIP || Nodes.cloudNodes[indexNode].interfaces.indexOf(heatPublicInterface) == -1)return;
    heat+=n0+"      -";
    heat+=n0+"        name: "+name;
    heat+=n0+"        fqdn: "+Nodes.cloudNodes[indexNode].fqdn;
    heat+=n0+"        ipaddress: {get_attr: ["+name+"-"+mgmtName+"-floatingIP, floating_ip_address]}";
    heat+=n0+"        groups: base";
    if(Nodes.cloudNodes[indexNode].isEms){heat+=",ems";}
    if(Nodes.cloudNodes[indexNode].isTester){heat+=",tester";}
    });
    // Misc section values
    heat+=n0+"  misc:";
    heat+=n0+"    description: set of miscellaneous properties used by the ansible deployment";
    heat+=n0+"    value:";
    heat+=n0+"      insecure_registries: '"+hpe5gResources.insecureRegistriesList+"'";
    heat+=n0+"      oc_version: "+oc_version;
    Misc.output.forEach(function(item, index){
    heat+=n0+"      "+item.name+": "+item.value;   	
    });
    
    heat+=n0+"  openshift_templates:";
    heat+=n0+"    description: set of OpenShift templates ready for deployment";
    heat+=n0+"    value:";
    // OpenShift network functions and Helm instances, per project
	// File naming convention for Network functions: openshift_project_<project>.yaml
	// File naming convention for Helm instances: openshift_helm_<project>~<name>~<template>~.yaml
	function heatHeader(project){return "\nopenshift_project_"+project+":";}
	function heatHelmValuesHeader(project, name, template){return "\nopenshift_helm_"+project+"~"+name+"~"+template+"~:";}
	
	// List of NetworkFunctions deployed on openshift
	heat+=hpe5gNetworkFunctions(heatHeader,undefined,'  ').replace(/\n/g, "\n"+  
		     '      ');	// fix the descriptor indentation as expected by Heat
    // List of HelmCharts deployed on openshift
    heat+=hpe5gHelmValues(heatHelmValuesHeader,undefined,'  ').replace(/\n/g, "\n"+  
    	     '      ');	// fix the descriptor indentation as expected by Heat
       
 	// Show to the user and save to hpe5g.yaml
    userOutput(heat);
	
	// Stop there if headless, ie no user interface
	if(Misc.getValue('headless'))return true;
	
	var blobHeat = new Blob([heat], {type: "text/plain;charset=utf-8"});
	var a = document.createElement('a');
	a.href = window.URL.createObjectURL(blobHeat);
    a.download = "hpe5g.yaml";
    document.body.appendChild(a);
	a.click();
	document.body.removeChild(a);
	return true;
}

//=================================
//Catalog of resources
//=================================
function catalogHelp(){userOutput(
`The catalog is an internal object defining the types and attributes of the CMS5G Core Stack resources deployable from the assistant on an OpenShift cluster.
It consists in four sections:
  - types
  - dependencies
  - values
  - admin

1.types:
  Define the name of each type of resource managed by the assistant.
  Each name must fall in one of those categories: `+hpe5gResources.names.join()+`
2. dependencies:
  Define for each type the list of required resources by their type names.
3. values:
  Define for each type the values used as default for the resources attributes. The list of attributes offering default values depends on the resource category:
    - IndirectServices,NetworkFunctions,DirectServices: URL, image, tag, template
    - Operators: template
    - HelmCharts: chart
  The template attribute is a YAML description of the OpenShift template used for deploying the resource. It must/may include those placeholders:
    - must: 
    	~NAME~ is the name of the resource
    	~PROJECT~ is the name of the OpenShift project (namespace)
    - may:
    	~IMAGE~ is the name of the docker image
    	~REPLICAS~ is the number of replicas
    	~<dependency>_NAME~ is a reference to the actual name of a dependency for this resource.
    	~VOLUME~ if the persistent storage can be hosted on a specific volume; this placeholder is replaced with "volumeName: <the volume name>" at build time
    	~PERSISTENCE_START~<conditional sequence>~PERSISTENCE_END~ useful to manage resources with optional persistent storage like ignite: 
    		the conditional sequence is removed when no persistent storage is defined by the user for this resource
  Those placeholders are processed at build time with the actual values defined by the user in the assistant.
4. admin:
  Define for each type if it requires special privileges for deployment (optional, default to false)
  If true, a warning is emitted to inform the user that the deployment may fail if run without admin privileges.
  
Display:
  Output a human readable view of the current catalog. The depth and length of the view can be tuned with the 'depth' and 'ellipsis' drop down boxes.
Export:
  Output the current catalog in JSON format and save the same as a file in the download folder of the browser named: hpe5g.catalog.json
Import: 
  Loads a custom catalog from a user provided JSON file; the current catalog is overridden by the new one.
`)}
var catalogImport = new userLoadedFile("catalogImport", "Import Json...", importCatalog);
if(!catalogImport.isDefined())document.getElementById("catalogArea").appendChild(catalogImport.getDomElement());
function exportCatalog(){
	var catalog=JSON.stringify({types: hpe5gResources.resources, dependencies: hpe5gResources.depends, values: hpe5gResources.defaults, admin: hpe5gResources.admin});
	userOutput(catalog);
	// Stop there if headless, ie no user interface
	if(Misc.getValue('headless'))return true;
	
	var blobCatalog = new Blob([catalog], {type: "text/plain;charset=utf-8"});
	var a = document.createElement('a');
	a.href = window.URL.createObjectURL(blobCatalog);
    a.download = "hpe5g.catalog.json";
    document.body.appendChild(a);
	a.click();
	document.body.removeChild(a);
	return true;
}
function importCatalog(jsonCatalog = catalogImport.content, silent = false){
  var result=false;
  try {
    var catalog = JSON.parse(jsonCatalog); 
    // Catalog sanity check
    var check="";
    var importedTypes = new Array();
    Object.keys(catalog).forEach(function(key) {
    	switch(key){
    	case 'types': 
    		Object.keys(catalog[key]).forEach(function(type) {
        		if(hpe5gResources.names.indexOf(type)<0){check+="\nLevel 2: "+key+":invalid type "+type+"; expected: "+hpe5gResources.names.join(); return;}
        		importedTypes = importedTypes.concat(catalog[key][type]);
    		});
    		break;
    	case 'dependencies': case 'values': case 'admin':
    		if(importedTypes.length==0){check+="\nLevel 1: missing types section in first position"; break;}
    		Object.keys(catalog[key]).forEach(function(type) {
    			if(importedTypes.indexOf(type)<0){check+="\nLevel 2: "+key+": unknown type "+type+"; expected: "+importedTypes.join(); return;}
    			// JSON.parse may render emtpy tables as {} with no length defined: force an array in dependencies sections
    			if(key=='dependencies' && catalog[key][type].length == undefined)catalog[key][type]=new Array();
    		});
    		break;
    	default: 
    		check+="\nLevel 1: invalid key "+key+"; expected: types,dependencies,values,admin";
    		break;
    	}
	});
    if(check.length>0)userOutput("Inconsistent imported catalog:"+check);
    else if (silent || confirm("You are about to override the current catalog")) {
  	  hpe5gResources.resources=catalog.types; hpe5gResources.depends=catalog.dependencies; hpe5gResources.defaults=catalog.values; hpe5gResources.admin=catalog.admin;
  	  if(!silent)userOutput(objToString(catalog));
	  result=true;
  	} else {
  	  userOutput("Catalog import cancelled");
  	}
  } catch (ex) {
  	userOutput("JSON parser exception received:\n"+ex);
  }
  return result;
}

// Gratitude to https://stackoverflow.com/questions/1199352/smart-way-to-truncate-long-strings
String.prototype.trunc = String.prototype.trunc ||
function(n){
    return (n != 0 && this.length > n) ? this.substr(0, n-1) + '&hellip;' : this;
};
// Gratitude to https://stackoverflow.com/questions/5612787/converting-an-object-to-a-string
var catalog_display_depth=0;
var catalog_display_ellipse=0;
function objToString(obj, ndeep) {
	if(catalog_display_depth != 0 && ndeep > catalog_display_depth){ return '&hellip;'; }
    if(obj == null){ return String(obj); }
    switch(typeof obj){
      case "string": return String('"'+obj+'"').trunc(catalog_display_ellipse);
      case "function": return obj.name || obj.toString();
      case "object":
        var indent = Array(ndeep||1).join('\t'), isArray = Array.isArray(obj);
        return '{['[+isArray] + Object.keys(obj).map(function(key){
             return '\n\t' + indent + key + ': ' + objToString(obj[key], (ndeep||1)+1);
           }).join(',') + '\n' + indent + '}]'[+isArray];
      default: return obj.toString();
    }
  }
function displayCatalog(){
	catalog_display_depth=0;
	var _catalog_display_depthDOM=document.getElementById("catalog_display_depth");
	if(_catalog_display_depthDOM != undefined){
		var candidate = Number(_catalog_display_depthDOM.value);
		if(!isNaN(candidate))catalog_display_depth=candidate;
	}
	catalog_display_ellipse=0;
	var _catalog_display_ellipseDOM=document.getElementById("catalog_display_ellipse");
	if(_catalog_display_ellipseDOM != undefined){
		var candidate = Number(_catalog_display_ellipseDOM.value);
		if(!isNaN(candidate))catalog_display_ellipse=candidate;
	}

	var catalog={types: hpe5gResources.resources, dependencies: hpe5gResources.depends, values: hpe5gResources.defaults, admin: hpe5gResources.admin};
	userOutput("Catalog:\n"+objToString(catalog));
}
//=================================
//OpenShift network functions build
//=================================
// Build a shell script named hpe5g.sh and drop it in the Download directory
// Two options: oc (openshift cli) or curl (openshift rest api) based
// The curl options support multiple targeted clusters, defined in Clusters.targeted array
// The oc options is used if Clusters.targeted is empty and relies on oc invocations on the single target cluster
function buildNetworkFunctions(){
	hpe5gResources.init();

	// Check the NetworkFunctions section (or get the errors)
	var openshift = NetworkFunctions.build()+DirectServices.build()+IndirectServices.build()+Operators.build()+HelmCharts.build()+Clusters.build();
	var check = NetworkFunctions.check+DirectServices.check+IndirectServices.check+Operators.check+HelmCharts.check+hpe5gResources.compile();
	if(check.length != 0){userOutput(check); return false;}
	if(openshift.length == 0){userOutput('Nothing to do'); return false;}
	
	var shell='';
	var warningMessage='';
	
	if(hpe5gResources.adminList.length > 0){
		warningMessage='Resource(s) requiring special privileges might jeopardize the deployment:'+hpe5gResources.adminList;
		if(!Misc.getValue('headless') && !confirm(warningMessage)){userOutput(warningMessage); return false;}
	}

	if(Clusters.targeted == undefined || Clusters.targeted.length == 0){
    	// File naming convention for Network functions: openshift_project_<project>.yaml
    	// File naming convention for Helm instances: openshift_helm_<project>~<name>~<template>~.yaml
    	function catHeader(project){return "\ncat > openshift_project_"+project+".yaml << 'EOFILE'"};
    	function catHelmValuesHeader(project, name, template){return "\ncat > openshift_helm_"+project+"~"+name+"~"+template+"~"+".yaml << 'EOFILE'"};
    	function catFooter(project){return "\nEOFILE"};
    	
    	shell=shellHeader('oc');
    	shell+=hpe5gNetworkFunctions(catHeader, catFooter);
    	shell+=hpe5gHelmValues(catHelmValuesHeader, catFooter);
    	shell+=hpe5gDeploymentScript(warningMessage);
	}else{
		var quickDescription=document.getElementById("quickDescription").value+". Built from HPE5g assistant on: "+Date();
		shell=shellHeader('curl');
		
		if(hpe5gHelmValues().length > 0){userOutput('Helm based deployments not supported on REST API'); return false;}

		Clusters.targeted.forEach(function(cluster){
			hpe5gResources.projects.forEach(function(project){
				// Create the project if it does not exist or fail in case of deletion
				shell+='\n_log_ "Checking project '+project+' on cluster '+cluster.name+'"';
				shell+='\nuntil curl -f -k -X GET -H "Authorization: Bearer '+cluster.token+'" -H "Accept: application/json" -H "Content-Type: application/json" https://'+cluster.endpoint+'/apis/project.openshift.io/v1/projects/'+project+'  &>> $hpe5g_log_file ; do ';
				shell+='\n$_deploy || _fail_ "Missing project '+project+' on cluster '+cluster.name+'"';
				shell+='\n_log_ "Creating project '+project+' on cluster '+cluster.name+'" && curl -f -k -X POST -d @- -H "Authorization: Bearer '+cluster.token+'" -H "Accept: application/json" -H "Content-Type: application/json" https://'+cluster.endpoint+'/apis/project.openshift.io/v1/projectrequests  &>> $hpe5g_log_file <<HPE_EOF';
				shell+=`
{
  "apiVersion": "project.openshift.io/v1",
  "kind": "ProjectRequest",
  "metadata": {
    "name": "`+project+`"
  },
  "description": "`+quickDescription+`",
  "displayName": "Project `+project+` created from REST API"
}
HPE_EOF`;
				shell+='\nif [ $? != 0 ] ; then _fail_ "Cannot create project '+project+' on cluster '+cluster.name+'" ; fi';
				shell+='\nsleep 2 ; done';

                // Create the REST API secret for this project if it does not exist
                var secretName=project+'-restapi';
                shell+='\n_log_ "Checking secret '+secretName+' for project '+project+' on cluster '+cluster.name+'"';
                shell+='\nuntil curl -f -k -X GET -H "Authorization: Bearer '+cluster.token+'" -H "Accept: application/json" -H "Content-Type: application/json" https://'+cluster.endpoint+'/api/v1/namespaces/'+project+'/secrets/'+secretName+' &>> $hpe5g_log_file ; do ';
                shell+='\n_log_ "Creating secret '+secretName+' for project '+project+' on cluster '+cluster.name+'" && curl -f -k -X POST -d @- -H "Authorization: Bearer '+cluster.token+'" -H "Accept: application/json" -H "Content-Type: application/json" https://'+cluster.endpoint+'/api/v1/namespaces/'+project+'/secrets &>> $hpe5g_log_file <<HPE_EOF';
                shell+=`
{
  "kind": "Secret",
  "apiVersion": "v1",
  "metadata": {
    "name": "`+secretName+`"
  },
  "stringData": {
    "NAME": "`+secretName+`"
  }
}
HPE_EOF`;
                shell+='\nif [ $? != 0 ] ; then _fail_ "Cannot create secret '+secretName+' for project '+project+' on cluster '+cluster.name+'" ; fi';
                shell+='\nsleep 2 ; done';
                
                // Deploy/undeploy the template instance
                shell+='\n_log_ "$_displayedAction resources for project '+project+' on cluster '+cluster.name+'"';
                shell+='\nif $_deploy ; then curl -f -k -X POST -d @- -H "Authorization: Bearer '+cluster.token+'" -H "Accept: application/json" -H "Content-Type: application/json" https://'+cluster.endpoint+'/apis/template.openshift.io/v1/namespaces/'+project+"/templateinstances &>> $hpe5g_log_file <<'HPE_EOF'";
                shell+=`
{
  "kind": "TemplateInstance",
  "apiVersion": "template.openshift.io/v1",
  "metadata": {
    "name": "`+project+`"
  },
  "spec": {
    "secret": {
      "name": "`+secretName+`"
    },
    "template":`+JSON.stringify(YAML.parse(hpe5gNetworkFunctions(undefined,undefined,undefined,project)))+`
  }
}
HPE_EOF`;
				shell+='\nelse curl -f -k -X DELETE -H "Authorization: Bearer '+cluster.token+'" -H "Accept: application/json" -H "Content-Type: application/json" https://'+cluster.endpoint+'/apis/template.openshift.io/v1/namespaces/'+project+'/templateinstances/'+project+' &>> $hpe5g_log_file';
				shell+='\nfi';
				shell+='\nif [ $? != 0 ] ; then _fail_ "$_displayedAction resources for project '+project+' on cluster '+cluster.name+'" ; fi';
				shell+='\n_log_ "$_displayedAction resources for project '+project+' successfully completed on cluster '+cluster.name+'"';

			});
		});
	}
	// Show to the user and save to hpe5g.sh
    userOutput(shell);
	// Stop there if headless, ie no user interface
	if(Misc.getValue('headless'))return true;
	
	var blobShell = new Blob([shell], {type: "text/plain;charset=utf-8"});
	var a = document.createElement('a');
	a.href = window.URL.createObjectURL(blobShell);
    a.download = "hpe5g.sh";
    document.body.appendChild(a);
	a.click();
	document.body.removeChild(a);
	
	return true;
}

//=================================
//Utilities
//=================================
// Warning on page reload
window.onbeforeunload = function() {
  return "Unsaved session data will be lost if you leave the page, are you sure?";
};

// if a is true, check that at least one element of x is true
// Otherwise, return a dependency message for roles
function checkDependency(a, x, roles, message){
	if(message == undefined)message = " are required on the same node";
	if( a && ! x.some(function(e, i, t){return e;} ))
		return "\n" + roles + message;
	return "";
}

// Check if only one element of x is true
// Otherwise, return a mutual exclusive message for roles
function checkUnicity(x, roles, message){
	var xTrue = x.filter(
		function(e, i, t){return e;}
	);
	if(message == undefined)message = " are mutually exclusive";
	if(xTrue.length > 1)return "\n" + roles + message;
	return "";
}

// Check if all or none element(s) of x is true
// Otherwise, return a group inconsistency message for roles
function checkGroupConsistency(x, roles, message){
	var xConsistent = ! x.some(
		function(e, i, t){return e;}
	) || x.every(
		function(e, i, t){return e;}
	);
	if(xConsistent)	return "";
	if(message == undefined)message = " group is not consistent (none or all should be true)";
	return "\n" + roles + message;
}

// Build a triple NAME/IP_ADDR/IP_NAT_ADDR of definitions for the role and device, using name and ip addr
// if name or ip addr are undefined, return an empty string
// if they are arrays with non empty elements, output a bash vector, ie space separated list enclosed in parenthesis
function getNameIpAddr(role, device, name, ipAddr, ipNatAddr){
	var result = "";
	var prefix = "";
	var suffix = "";
	var theName = name;
	if(name instanceof Array){
		if(name.join("").trim() != ""){
			theName = name.join(" ");
			prefix = "( ";
			suffix = " )";
		}else{
			theName = "";
		}
	}
	if(theName != undefined && theName != "")result += "\n" + role + "_NAME" + device + "=" + prefix+theName+suffix;
	prefix = suffix = "";
	var theIpAddr = ipAddr;
	if(ipAddr instanceof Array){
		if(ipAddr.join("").trim() != ""){
			theIpAddr = ipAddr.join(" ");
			prefix = "( ";
			suffix = " )";
		}else{
			theIpAddr = "";
		}
	}
	if(theIpAddr != undefined && theIpAddr != "")result += "\n" + role + "_IP_ADDR" + device + "=" + prefix+theIpAddr+suffix;
	prefix = suffix = "";
	var theIpNatAddr = ipNatAddr;
	if(ipNatAddr instanceof Array){
		if(ipNatAddr.join("").trim() != ""){
			theIpNatAddr = ipNatAddr.join(" ");
			prefix = "( ";
			suffix = " )";
		}else{
			theIpNatAddr = "";
		}
	}
	if(theIpNatAddr != undefined && theIpNatAddr != "")result += "\n" + role + "_IP_NAT_ADDR" + device + "=" + prefix+theIpNatAddr+suffix;
	return result;
}

// Useful 'contains' method for String is not available everywhere
if(!('contains' in String.prototype)){
	String.prototype.contains = function(str, startIndex){
		return -1 !== this.indexOf(str, startIndex);
	}
}

// Useful 'startsWith' method for String is not available everywhere
if (!String.prototype.startsWith) {
  String.prototype.startsWith = function(searchString, position) {
    position = position || 0;
    return this.indexOf(searchString, position) === position;
  };
}
if (!String.prototype.endsWith) {
	String.prototype.endsWith = function(pattern) {
	  var d = this.length - pattern.length;
	  return d >= 0 && this.lastIndexOf(pattern) === d;
	};
}
// In a list of arrays 'a', for all empty elements from index 0 to the last existing array, create an array and insert a 'defaultString'
function fillArrays(a, defaultString){
	if(a == undefined)return;
	if(defaultString == undefined)defaultString=new String('""');
	var fillArray = false;
	for(var i = a.length - 1; i>=0; i--){
		if(a[i] == undefined){
			if(fillArray){
				a[i] = new Array();
				a[i].push(defaultString);
			}
			else {
				a.pop();	// remove the useless undefined last element
			}
		}
		else{
			fillArray = true;
		}
	}
}

//======================================
// 5G resources default catalog as JSON
// See catalogHelp() for the semantic
// For legibility, the default templates 
// are set next as yaml values 
//======================================
var defaultCatalog=`
{
  "types": {
    "NetworkFunctions": [
      "nudsf-dr",
      "nudr-dr",
      "nudr-prov",
      "nudr-reg-agent",
      "nudm-ee",
      "nudm-li-poi",
      "nudm-li-tf",
      "nudm-ueau",
      "nudm-uecm",
      "nudm-sdm",
      "nudm-notify",
      "sf-cmod",
      "nrf-reg-agent"
    ],
    "IndirectServices": [
      "jenkins",
      "elasticsearch",
      "prometheus-alertmanager",
      "prometheus",
      "kube-state-metrics",
      "pushgateway",
      "grafana"
    ],
    "DirectServices": [
      "ignite",
      "redis",
      "influxdb",
      "fluentd"
    ],
    "Operators": [
      "jaeger",
      "kiali",
      "svc-mesh-ctlplane",
      "kafka",
      "elasticSearchOperator"
    ],
    "HelmCharts": [
      "nudm",
      "nudr",
      "generic"
    ]
  },
  "dependencies": {
    "jenkins": [],
    "elasticsearch": [],
    "prometheus-alertmanager": [],
    "prometheus": [],
    "kube-state-metrics": [],
    "pushgateway": [],
    "grafana": [],
    "nudsf-dr": [
      "ignite",
      "influxdb"
    ],
    "nudr-dr": [
      "ignite",
      "nudr-prov",
      "influxdb"
    ],
    "nudr-prov": [
      "ignite",
      "influxdb"
    ],
    "nudr-reg-agent": [
    	"redis","influxdb"
    ],
    "nudm-ee": [
      "influxdb", "nudr-dr"
    ],
    "nudm-li-poi": [
      "redis","kafka","influxdb"
    ],
    "nudm-li-tf": [
        "redis","influxdb"
    ],
    "nudm-ueau": [
        "influxdb", "nudr-dr"
    ],
    "nudm-uecm": [
        "influxdb", "nudr-dr"
    ],
    "nudm-sdm": [
      "influxdb", "nudr-dr"
    ],
    "nudm-notify": [
      "influxdb", "nudr-dr"
    ],
    "sf-cmod": [],
    "nrf-reg-agent": [
      "influxdb",
      "fluentd"
    ],
    "ignite": [],
    "redis": [],
    "influxdb": [],
    "fluentd": [],
    "jaeger": [],
    "kiali": [],
    "svc-mesh-ctlplane": [],
    "kafka": [],
    "elasticSearchOperator": [],
    "nudm": [],
    "nudr": [],
    "generic": []
  },
  "admin": {
	    "fluentd": true,
	    "grafana": true,
	    "kube-state-metrics": true
  },
  "values": {
    "jenkins": {
      "URL": "quay.io/openshift",
      "image": "origin-jenkins",
      "tag": "latest"
    },
    "elasticsearch": {
      "URL": "docker.elastic.co/elasticsearch",
      "image": "elasticsearch-oss",
      "tag": "6.7.0",
      "storage": "4Gi"
    },
    "prometheus-alertmanager": {
      "URL": "docker.io/prom",
      "image": "alertmanager",
      "tag": "v0.20.0",
      "storage": "8Gi"
    },
    "prometheus": {
      "URL": "docker.io/prom",
      "image": "prometheus",
      "tag": "v2.16.0",
      "storage": "200Mi"
    },
    "kube-state-metrics": {
      "URL": "quay.io/coreos",
      "image": "kube-state-metrics",
      "tag": "v1.9.5"
    },
    "pushgateway": {
      "URL": "docker.io/prom",
      "image": "pushgateway",
      "tag": "v1.0.1"
    },
    "grafana": {
      "URL": "grafana",
      "image": "grafana",
      "tag": "6.6.2"
    },
    "nudsf-dr": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-sde-nudsf-dr",
      "tag": "1.5.0"
    },
    "nudr-dr": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-sde-udr-nudr-dr",
      "tag": "1.1.0"
    },
    "nudr-prov": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-sde-udr-nudr-prov",
      "tag": "1.1.0"
    },
    "nudr-reg-agent": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-nnrf-reg-agent",
      "tag": "0.9.0"
    },
    "nudm-ee": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-nf-udm-ee",
      "tag": "0.9.0"
    },
    "nudm-li-poi": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-nf-udm-li-poi",
      "tag": "0.9.0"
    },
    "nudm-li-tf": {
        "URL": "cmsgvm38.gre.hpecorp.net:18444",
        "image": "hpe-nf-udm-li-tf",
        "tag": "0.9.0"
    },
    "nudm-ueau": {
        "URL": "cmsgvm38.gre.hpecorp.net:18444",
        "image": "hpe-nf-udm-ueau",
        "tag": "0.9.0"
    },
    "nudm-uecm": {
        "URL": "cmsgvm38.gre.hpecorp.net:18444",
        "image": "hpe-nf-udm-uecm",
        "tag": "0.9.0"
    },
    "nudm-sdm": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-nf-udm-sdm",
      "tag": "0.9.0"
    },
    "nudm-notify": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-nf-udm-notify",
      "tag": "0.9.0"
    },
    "sf-cmod": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-sf-cmod",
      "tag": "0.8.0"
    },
    "nrf-reg-agent": {
      "URL": "cmsgvm38.gre.hpecorp.net:18444",
      "image": "hpe-nf-nrf-reg-agent",
      "tag": "0.12.0"
    },
    "ignite": {
      "URL": "docker.io/gridgain",
      "image": "community",
      "tag": "8.7.14"
    },
    "redis": {
      "URL": "docker.io/bitnami",
      "image": "redis",
      "tag": "latest",
      "storage": "100Mi"
    },
    "influxdb": {
      "URL": "docker.io/bitnami",
      "image": "influxdb",
      "tag": "1.7.10",
      "storage": "1Gi"
    },
    "fluentd": {
      "URL": "gcr.io/google-containers",
      "image": "fluentd-elasticsearch",
      "tag": "v2.4.0"
    },
    "jaeger": {},
    "kiali": {},
    "svc-mesh-ctlplane": {},
    "kafka": {},
    "elasticSearchOperator": {},
    "nudm": {
      "chart": "hpe-nf-udm-0.9.0-005194.c3fa0f7.tgz"
    },
    "nudr": {
      "chart": "hpe-sde-udr-1.1.0-004136.0166df3.tgz"
    },
    "generic": {
    }
  }
}
`;


//====================================
// Main javascript entry point
//====================================
// Import silently the default catalog 
importCatalog(defaultCatalog, true);

//Add the 'import session' control if missing
var importedSession = new userLoadedFile("importedSession", "Import...", importSession);
if(!importedSession.isDefined())document.getElementById("controlArea").appendChild(importedSession.getDomElement());

// Display only used sections
vnfResources.forEach(function(e,i,t){e.display(!e.isEmpty())});

// Restore dynamic javascript variables based on the ID of variables of class userLoadedFile
var userLoadedFiles = Array.prototype.slice.call( document.getElementsByClassName("userLoadedFile") );
userLoadedFiles.forEach(function(e, i){window[e.id] = new userLoadedFile(e.id);});

hpe5gResources.init();

//Welcome message when starting with an empty session
if(Nodes.isEmpty() && NetworkFunctions.isEmpty() && IndirectServices.isEmpty() && DirectServices.isEmpty() && Operators.isEmpty() && HelmCharts.isEmpty()){
var welcomeMsg=`Welcome to the CMS5G Core stack automated deployer assistant.

To deploy resources, click on the section names in the Summary line or import an existing session using the file chooser button.

Resources deployment on top of OpenShift:`;
hpe5gResources.names.forEach(function(section){
	welcomeMsg+="\n- "+section+": ";
	welcomeMsg+=hpe5gResources.resources[section].join();
});
welcomeMsg+=`
Then click on 'Resources': the installer is downloaded by the browser in the 'download' folder.
Drop this installer on the console connected to the OpenShift cluster, and run it as an OpenShift user to deploy the resources.

For more help, click the section specific or general Help button.
`;  

userOutput(welcomeMsg);
}

// Update the catalog with the default yaml templates 
var log4j2xml=`
      <?xml version="1.0" encoding="UTF-8"?>
      <!-- ===================================================================== -->
      <!-- -->
      <!-- Log4j Configuration -->
      <!-- -->
      <!-- ===================================================================== -->
      <!-- | For more configuration information and examples see the Jakarta Log4j 
           | website: http://jakarta.apache.org/log4j -->
      <Configuration status="WARN">
          <!-- ============================== -->
          <!-- Append messages to the console -->
          <!-- ============================== -->
          <Appenders>
              <Console name="Console" target="SYSTEM_OUT">
                  <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %msg%n"/>
                  <Filters>
                      <ThresholdFilter level="TRACE" onMatch="ACCEPT" />
                  </Filters>
              </Console>
          </Appenders>
          <!-- ================ -->
          <!-- Limit categories -->
          <!-- ================ -->
          <Loggers>
              <Logger name="com.hpe" level="DEBUG"/>
              <Logger name="org.apache" level="WARN"/>
              <Logger name="kafka" level="WARN"/>
          
          <!-- ======================= -->
          <!-- Setup the Root category -->
          <!-- ======================= -->
              <Root level="INFO">
                  <AppenderRef ref="Console"/>
              </Root>
          </Loggers>
      </Configuration>
`;

//================================================
hpe5gResources.defaults['nudsf-dr']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        containers:
        - name: ~NAME~
          env:
            - name: ROUTER_ENABLE_HTTP2
              value: 'true'
          image: ~IMAGE_STREAM~
          imagePullPolicy: IfNotPresent
          Requests:
            cpu:    1000m
            memory:   2000Mi
          Limits:
            cpu:  8000m
            memory: 4000Mi
          ports:
          - containerPort: 8443
            protocol: TCP
          volumeMounts:
            - name: ~NAME~
              mountPath: /etc/opt/hpe-5g/nudsf-dr/
            - name: ~NAME~-secrets
              mountPath: /etc/opt/hpe-5g/nudsf-dr/security
          livenessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudsf-dr/v2/probes/healthy
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 5
            timeoutSeconds: 15
          readinessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudsf-dr/v2/probes/healthz
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 60
            timeoutSeconds: 15
        volumes:
          - name: ~NAME~
            configMap:
              name: ~NAME~
          - name: ~NAME~-secrets
            secret:
              secretName: ~NAME~
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    labels:
      name: ~NAME~
      deploymentconfig: ~NAME~
  spec:
    type: LoadBalancer
    ports:
    - port: 8443
      protocol: TCP
      targetPort: 30043
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tls:
      termination: passthrough
    to:
      kind: Service
      name: ~NAME~
      namespace: ~PROJECT~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    nudsf-dr-config.yaml: |
      #
      # Sample Network function configuration.
      #
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
      statistics-configuration:
        id: nudsf-dr-statistics
        jvm-metrics: false
        jmx:
          domain: nudsf-dr
          enabled: false
          properties:
            com.hpe.imsc.statistics.jmx.descriptors: "false"
            com.hpe.imsc.statistics.jmx.notifications: "false"
        properties:
          com.hpe.imsc.statistics.influxdb.notifications: "false"
          com.hpe.imsc.statistics.influxdb.server.database: nudsf-dr
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: "8086"
          com.hpe.imsc.statistics.influxdb.server.protocol: http
      call-tracing:
        enabled: false
        properties:
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 6831
          JAEGER_ENDPOINT: http://jaeger-collector:14268/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: true
          JAEGER_SAMPLER_PARAM: 1
          JAEGER_SAMPLER_TYPE: probabilistic
          JAEGER_SERVICE_NAME: ~NAME~
      datasources:
        - id: ignite
          profile:
            name: kubernetes
            properties:
              masterUrl: https://openshift.default.svc.cluster.local:443
              namespace: ~PROJECT~
              serviceName: ~ignite_NAME~
          properties:
            enableGridCompute: false
      model:
        realms:
        - id: realm0
          properties:
            replicas: 1
          storages:
          - id: space0
            properties:
              replicas: 1
    project-nudsf-dr.yml: |+
      #
      # Sample Thorntail global configuration.
      #
      thorntail:
        https:
          only: true
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  http2-initial-window-size: 32000000
                  no-request-timeout: 600000            
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: hwroot
          key-stores:
            ks:
              path: /etc/opt/hpe-5g/nudsf-dr/security/keystore.jks
              credential-reference:
                clear-text: hwroot
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            "stdout":
               level: INFO
               handlers:
               - STDOUT
            "com.hpe.cms5g.nudsf":
               level: INFO
            "com.hpe.cms.sde.udsf":
               level: INFO
            "com.hpe.cms.sde.dao":
               level: INFO
            "com.hpe":
               level: INFO
            "io.jaegertracing":
              level: WARN
            "io.undertow":
               level: INFO
            "io.netty":
               level: INFO
            "org.jboss.as":
              level: INFO
            "org.glassfish.jersey":
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  type: Opaque
  data:
    keystore.jks: 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
`;
//================================================
hpe5gResources.defaults['nudr-dr']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        containers:
        - name: ~NAME~
          env:
          - name: JAVA_OPTS
            value: -Xms512m -Xmx1024m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe-5g/sde-udr-nudr-dr/nudr-nf-config.yaml
          - name: SPRING_PROFILES_ACTIVE
            value: ignite
          image: ~IMAGE_STREAM~
          imagePullPolicy: IfNotPresent
          Requests:
            cpu:    2000m
            memory:   2000Mi
          Limits:
            cpu:  8000m
            memory: 4000Mi
          ports:
          - containerPort: 8443
            protocol: TCP
          volumeMounts:
            - name: ~NAME~
              mountPath: /etc/opt/hpe-5g/sde-udr-nudr-dr/
            - name: ~NAME~-secrets
              mountPath: /etc/opt/hpe-5g/sde-udr-nudr-dr/security
          livenessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudr-dr/v2/probes/healthy
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 5
            timeoutSeconds: 15
          readinessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudr-dr/v2/probes/healthz
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 60
            timeoutSeconds: 15
        volumes:
          - name: ~NAME~
            configMap:
              name: ~NAME~
          - name: ~NAME~-secrets
            secret:
              secretName: ~NAME~
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    labels:
      name: ~NAME~
      deploymentconfig: ~NAME~
  spec:
    type: LoadBalancer
    ports:
    - port: 8443
      protocol: TCP
      targetPort: 30043
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tls:
      termination: passthrough
    to:
      kind: Service
      name: ~NAME~
      namespace: ~PROJECT~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    nudr-nf-config.yaml: |
      #
      # Sample Network function configuration.
      #
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
      statistics-configuration:
        id: nudr-prov-statistics
        jvm-metrics: false
        jmx:
          domain: nudr-prov
          enabled: false
          properties:
            com.hpe.imsc.statistics.jmx.descriptors: "false"
            com.hpe.imsc.statistics.jmx.notifications: "false"
        properties:
          com.hpe.imsc.statistics.influxdb.notifications: "false"
          com.hpe.imsc.statistics.influxdb.server.database: nudr-prov
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: "8086"
          com.hpe.imsc.statistics.influxdb.server.protocol: http
      call-tracing:
        enabled: false
        properties:
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 6831
          JAEGER_ENDPOINT: http://jaeger-collector:14268/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: true
          JAEGER_SAMPLER_PARAM: 1
          JAEGER_SAMPLER_TYPE: probabilistic
          JAEGER_SERVICE_NAME: ~NAME~
      datasources:
        - id: ignite
          profile:
            name: kubernetes
            properties:
              masterUrl: https://openshift.default.svc.cluster.local:443
              namespace: ~PROJECT~
              serviceName: ~ignite_NAME~
          properties:
            enableGridCompute: false
      model:
        realms:
        - id: realm0
          properties:
            replicas: 1
      publisher-subscriber:
          enable: false
          parameters:
            topic: UDRNotifier
            application-kind: UDR
          pubsub:
            brokers:
             - localhost:9092
            properties:
              group.id: group1
              reconnect.backoff.ms: 7200000
              reconnect.backoff.max.ms: 14400000 
    project-nudr-dr.yml: |+
      #
      # Sample Thorntail global configuration.
      #
      thorntail:
        https:
          only: true
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  http2-initial-window-size: 32000000
                  no-request-timeout: 600000            
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: hwroot
          key-stores:
            ks:
              path: /etc/opt/hpe-5g/sde-udr-nudr-dr/security/keystore.jks
              credential-reference:
                clear-text: hwroot
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            "stdout":
               level: INFO
               handlers:
               - STDOUT
            "com.hpe.cms.sde.udr":
               level: INFO
            "com.hpe.cms.sde.apis":
               level: INFO
            "com.hpe.cms.sde.dao":
               level: INFO
            "com.hpe.paas.middleware.sdk.impl.rest.providers":
               level: INFO
            "com.hpe":
               level: INFO
            "org.apache.ignite":
              level: WARN
            "org.apache.kafka":
               level: INFO
            "org.glassfish.jersey":
               level: INFO
            "io.jaegertracing":
              level: INFO
            "io.undertow":
              level: INFO
            "io.netty":
              level: INFO
            "org.jboss.as":
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  type: Opaque
  data:
    keystore.jks: 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
`;

//================================================
hpe5gResources.defaults['nudr-prov']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        containers:
        - name: ~NAME~
          env:
          - name: JAVA_OPTS
            value: -Xms512m -Xmx1024m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe-5g/sde-udr-nudr-prov/nudr-nf-config.yaml
          - name: SPRING_PROFILES_ACTIVE
            value: ignite
          image: ~IMAGE_STREAM~
          imagePullPolicy: IfNotPresent
          Requests:
            cpu:    2000m
            memory:   2000Mi
          Limits:
            cpu:  8000m
            memory: 4000Mi
          ports:
          - containerPort: 8443
            protocol: TCP
          volumeMounts:
            - name: ~NAME~
              mountPath: /etc/opt/hpe-5g/sde-udr-nudr-prov/
            - name: ~NAME~-secrets
              mountPath: /etc/opt/hpe-5g/sde-udr-nudr-prov/security
          livenessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudr-prov/v1/probes/healthy
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 5
            timeoutSeconds: 15
          readinessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudr-prov/v1/probes/healthz
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 60
            timeoutSeconds: 15
        volumes:
          - name: ~NAME~
            configMap:
              name: ~NAME~
          - name: ~NAME~-secrets
            secret:
              secretName: ~NAME~
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    labels:
      name: ~NAME~
      deploymentconfig: ~NAME~
  spec:
    type: LoadBalancer
    ports:
    - port: 8443
      protocol: TCP
      targetPort: 30043
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tls:
      termination: passthrough
    to:
      kind: Service
      name: ~NAME~
      namespace: ~PROJECT~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    nudr-nf-config.yaml: |
      #
      # Sample Network function configuration.
      #
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
      statistics-configuration:
        id: nudr-prov-statistics
        jvm-metrics: false
        jmx:
          domain: nudr-prov
          enabled: false
          properties:
            com.hpe.imsc.statistics.jmx.descriptors: "false"
            com.hpe.imsc.statistics.jmx.notifications: "false"
        properties:
          com.hpe.imsc.statistics.influxdb.notifications: "false"
          com.hpe.imsc.statistics.influxdb.server.database: nudr-prov
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: "8086"
          com.hpe.imsc.statistics.influxdb.server.protocol: http
      call-tracing:
        enabled: false
        properties:
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 6831
          JAEGER_ENDPOINT: http://jaeger-collector:14268/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: true
          JAEGER_SAMPLER_PARAM: 1
          JAEGER_SAMPLER_TYPE: probabilistic
          JAEGER_SERVICE_NAME: ~NAME~
      datasources:
        - id: ignite
          profile:
            name: kubernetes
            properties:
              masterUrl: https://openshift.default.svc.cluster.local:443
              namespace: ~PROJECT~
              serviceName: ~ignite_NAME~
          properties:
            enableGridCompute: false
      model:
        realms:
        - id: realm0
          properties:
            replicas: 1
    project-nudr-prov.yml: |+
      #
      # Sample Thorntail global configuration.
      #
      thorntail:
        https:
          only: true
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  http2-initial-window-size: 32000000
                  no-request-timeout: 600000            
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: hwroot
          key-stores:
            ks:
              path: /etc/opt/hpe-5g/sde-udr-nudr-prov/security/keystore.jks
              credential-reference:
                clear-text: hwroot
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            "stdout":
               level: INFO
               handlers:
               - STDOUT
            "com.hpe.cms.sde.udr":
               level: INFO
            "com.hpe.cms.sde.apis":
               level: INFO
            "com.hpe.cms.sde.dao":
               level: INFO
            "com.hpe.paas.middleware.sdk.impl.rest.providers":
               level: INFO
            "com.hpe":
               level: INFO
            "org.apache.ignite":
              level: WARN
            "org.apache.kafka":
               level: INFO
            "org.glassfish.jersey":
               level: INFO
            "io.jaegertracing":
              level: INFO
            "io.undertow":
              level: INFO
            "io.netty":
              level: INFO
            "org.jboss.as":
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  type: Opaque
  data:
    keystore.jks: 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
`;

//================================================
hpe5gResources.defaults['nudr-reg-agent']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        containers:
        - name: ~NAME~
          env:
          - name: JAVA_OPTS
            value: -Xms512m -Xmx1024m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe-5g/hpe-nnrf-reg-agent/nnrf-reg-agent-config.yaml
          image: ~IMAGE_STREAM~
          Requests:
            cpu:    1000m
            memory:   2000Mi
          Limits:
            cpu:  8000m
            memory: 4000Mi
          ports:
          - containerPort: 8443
            protocol: TCP
          volumeMounts:
            - name: ~NAME~
              mountPath: /etc/opt/hpe-5g/hpe-nnrf-reg-agent/
            - name: ~NAME~-secrets
              mountPath: /etc/opt/hpe-5g/hpe-nnrf-reg-agent/security
          livenessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudr-reg-agent/v2/probes/healthy
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 5
            timeoutSeconds: 15
          readinessProbe:
            failureThreshold: 3000
            httpGet:
              path: /nudr-reg-agent/v2/probes/healthz
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 60
            timeoutSeconds: 15
        volumes:
          - name: ~NAME~
            configMap:
              name: ~NAME~
          - name: ~NAME~-secrets
            secret:
              secretName: ~NAME~
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    labels:
      name: ~NAME~
      deploymentconfig: ~NAME~
  spec:
    type: LoadBalancer
    ports:
    - port: 8443
      protocol: TCP
      targetPort: 30043
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tls:
      termination: passthrough
    to:
      kind: Service
      name: ~NAME~
      namespace: ~PROJECT~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    nnrf-reg-agent-config.yaml: |
      # Network function NNRF Client MicroService configuration.
      #
      # The parameters below can be overridden by an external configuration.
      #
      # HTTP/2 REST client subsystem
      ---
      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.okhttp.connector.OkhttpConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 50
          jersey.config.client.followRedirects: false
          jersey.config.client.connectTimeout: 100
          jersey.config.client.readTimeout: 1000
        security:
          keyCertificateLocation:
          keystoreLocation:
          keystorePassword: password
          keyCertificatePKLocation:
          keyCertificateKeyPairPassword:
          keyManagerFactoryAlgorithm:
          truststoreLocation:
          trustCertificateLocation:
          truststorePassword:
          trustCertificatePKLocation:
          trustCertificateKeyPairPassword:
          trustManagerFactoryAlgorithm:
          cryptoProtocol: TLSv1.2
          passwordEncoded: false
          
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
      statistics-configuration:
        id: nudr-reg-agent-statistics
        default-group: nnrf
        jmx:
          domain: nnrf-reg-agent
          enabled: false
          properties:
            com.hpe.imsc.statistics.jmx.descriptors: "false"
            com.hpe.imsc.statistics.jmx.notifications: "false"
        jvm-metrics: true
        period: 5
        properties:
          com.hpe.imsc.statistics.influxdb.server.database: nnrf-reg-agent
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
          com.hpe.imsc.statistics.influxdb.server.port: "8086"
          com.hpe.imsc.statistics.influxdb.server.protocol: http
      
      caching-providers:
        - uri: "paas://redis-caching-manager"
          classloader: "#notused"
          properties:
            caching.provider.class.name: "com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider"
          cache-managers:
            - uri: "paas://redis-cache-manager" 
              classloader: "#notused"
              properties:
              caches:
                - name: "nnrf-client-cache"
                  keyType: "java.lang.String"
                  valueType: "java.lang.String"
                  eternal: "true"
                  writeThrough: "false"
                  readThrough: "false"
                  timeToLiveSeconds: "3600"
                  properties:
                    cache.uri: redis://~redis_NAME~.~PROJECT~.svc.cluster.local:6379?database=0
                    cache.codec: "io.lettuce.core.codec.StringCodec"
      call-tracing:
        properties:
          JAEGER_SERVICE_NAME: ~NAME~
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 6831
          JAEGER_ENDPOINT: http://localhost:14268/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: true
          JAEGER_SAMPLER_TYPE: probabilistic
          JAEGER_SAMPLER_PARAM: 1
        enabled: true
        trace-all-operations: true
        trace-all-ues: true
        provisioning-uri: file:/etc/opt/hpe-5g/hpe-nnrf-reg-agent/call-tracing-provisioning.yaml
      nnrf-client:
        discover-stub-mode: false
        # json file containing remote NF profile to be discovered in stub-mode
        stub-remote-nf-profile: 
        server-scheme: https
        server-fqdn: ghost41.gre.hpecorp.net
        server-port: 8443
        server-version: v1
        retry-limit: -1
        nfprofile-uri: file:/etc/opt/hpe-5g/hpe-nnrf-reg-agent/nnrf-register.config
        disable-register: false 
        disable-deregister: false
        opentracing-enabled: false
        enable-cache: false
        default-cache-validity-period-secs: 
        self-service-name: nudr-reg-agent
        monitor-service-name: nudr-dr
        monitor-interval: 15000
        kubernetes-namespace: 3gpp-nf-all
    project-nnrf-reg-agent.yml: |+
      #
      # Sample Thorntail global configuration.
      #
      thorntail:
        https:
          only: true
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  http2-initial-window-size: 32000000
                  no-request-timeout: 600000            
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: hwroot
          key-stores:
            ks:
              path: /etc/opt/hpe-5g/hpe-nnrf-reg-agent/security/keystore.jks
              credential-reference:
                clear-text: hwroot
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            "stdout":
               level: INFO
               handlers:
               - STDOUT
            "com.hpe.cms.sde.udr":
               level: INFO
            "com.hpe.cms.sde.apis":
               level: INFO
            "com.hpe.cms.sde.dao":
               level: INFO
            "com.hpe.paas.middleware.sdk.impl.rest.providers":
               level: INFO
            "com.hpe":
               level: INFO
            "org.apache.ignite":
              level: WARN
            "org.apache.kafka":
               level: INFO
            "org.glassfish.jersey":
               level: INFO
            "io.jaegertracing":
              level: INFO
            "io.undertow":
              level: INFO
            "io.netty":
              level: INFO
            "org.jboss.as":
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"
    nnrf-register.config: |
      {
        "nfInstanceId": "0777E150-4D00-4d86-A49C-8BADF00D0000",
        "nfType":"UDR",
        "nfStatus":"REGISTERED",
        "heartBeatTimer": "45",
        "fqdn": "localhost",
        "ipv4Addresses":["localhost"],
        "udrInfo":{
          "groupId":"udrgroup01",
          "supiRanges":[{"start":"200000000000000","end":"399999999999999"}],
          "supportedDataSets":["SUBSCRIPTION","POLICY","EXPOSURE","APPLICATION"]  },
          "nfServices" : [ {
            "serviceInstanceId" : "0777E150-4D00-4d86-A49C-8BADF00D0000",
            "serviceName" : "~NAME~",
            "versions" : [ {"apiVersionInUri":"v2","apiFullVersion":"2.1.0"} ],
            "scheme" : "https",
            "nfServiceStatus" : "REGISTERED",
            "fqdn": "localhost",
            "ipEndPoints" : [ {"ipv4Address":"localhost","transport":"TCP","port":"30001"} ]
            } ]
      }
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  type: Opaque
  data:
    keystore.jks: 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
`;
//================================================
hpe5gResources.defaults['sf-cmod']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret-config
    namespace: ~PROJECT~
  data:
    "DefaultConfig": |- 
          IyBUaGlzIGlzIGEgc2FtcGxlIEFsZ29yaXRobSBJRCBGaWxlLgojIFRoaXMgZGVmaW5lcyB0aGUgc3VwcG9ydGVkIHZhcmlhYmxlcyBhbmQgcHJvdmlkZXMgYSBzYW1wbGUgdmFsdWUgZm9yIHRoZW0uCgojIHZlY3Rvcl9hbGdvcml0aG0KIyBUaGlzIGlzIGEgbWFuZGF0b3J5IGZpZWxkIGZvciB0aGlzIGtpbmQgb2YgZmlsZS4KIyBWYWxpZCBWYWx1ZXMgOiAKIyAgICAwICAgLSBNaWxlbmFnZQojICAgIDI1MCAtIFR1YWsKdmVjdG9yX2FsZ29yaXRobSA6IDAKCiMgb3AKIyBWYWxpZCBmb3IgTWlsZW5hZ2UgYWxnb3JpdGhtLCAKIyBvcHRpb25hbCBmaWVsZCwgbmVlZG4ndCBiZSBwcm92aXNpb25lZCB3aGVuIG9wYyBpcyBwcmVzZW50CiMgUmVnZXggUGF0dGVybiA6ICJeW0EtRmEtZjAtOV17MzJ9JCIKb3AgOiBBMTIzNDU2Nzg5QTEyMzQ1Njc4OUExMjM0NTY3ODlCQwoKIyBjCiMgVmFsaWQgZm9yIE1pbGVuYWdlIGFsZ29yaXRobSBhbmQgZGVmYXVsdCB2YWx1ZXMgZm9yIE1pbGVuYWdlCiMgb3B0aW9uYWwgZmllbGQKIyBSZWdleCBQYXR0ZXJuIDogIl5bQS1GYS1mMC05XXsxNjB9JCIKYyA6IDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA0MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDgKCiMgcgojIFZhbGlkIGZvciBNaWxlbmFnZSBhbGdvcml0aG0gYW5kIGRlZmF1bHQgdmFsdWVzIGZvciBNaWxlbmFnZQojIG9wdGlvbmFsIGZpZWxkCiMgUmVnZXggUGF0dGVybiA6ICJeW0EtRmEtZjAtOV17MTB9JCIKciA6IDQwMDAwMDIwNjAKCiMga2VjX2Nha19pdGVyCiMgVmFsaWQgZm9yIFR1YWsgYWxnb3JpdGhtCiMgVmFsaWQgdmFsdWVzIDogMCAtIDcKa2VjX2Nha19pdGVyIDogMQoKIyB0b3AKIyBWYWxpZCBmb3IgVHVhayBhbGdvcml0aG0KIyBSZWdleCBQYXR0ZXJuIDogIl5bQS1GYS1mMC05XXs2NH0kIgp0b3AgOiBBMTIzNDU2Nzg5QTEyMzQ1Njc4OUExMjM0NTY3ODlCQ0ExMjM0NTY3ODlBMTIzNDU2Nzg5QTEyMzQ1Njc4OUJDCg==
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret-cert
    namespace: ~PROJECT~
  data:
    "cert.pem": |- 
          LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZKVENDQXcyZ0F3SUJBZ0lKQVBhTExmcTZWVXQvTUEwR0NTcUdTSWIzRFFFQkN3VUFNQ2t4SnpBbEJnTlYKQkFNTUhuWmhZV0YyYlRFekxtbHVMbkprYkdGaWN5NW9jR1ZqYjNKd0xtNWxkREFlRncweE9EQTVNVEV4TlRNdwpNREJhRncweE9UQTVNVEV4TlRNd01EQmFNQ2t4SnpBbEJnTlZCQU1NSG5aaFlXRjJiVEV6TG1sdUxuSmtiR0ZpCmN5NW9jR1ZqYjNKd0xtNWxkRENDQWlJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dJUEFEQ0NBZ29DZ2dJQkFMaW8KUng1NDJDYnNocmpBVHNweW9OSW05V2sxWmlwYU9iWGJHS1lLVW94WFFvRTlINnhiNU8zK2ozUjc4TnVNYmkrZAo0RGJZUXplQWJ1eFM1aW9uUEM1ZUlZazlMSnZOKzgrQU1Wbzd4cVNUaUFrTndia2JWcnd0RmU3dnhwdFhxcGQrCmRscVplVDJXNmxlU0ZLd1FnSGZscjlNd2FlYlFibnNjTjd0SnFwQWdSQW5zekRUOTFZM0I2cExzbmE5QVJnQXAKeHViak55OUd5aHhJSlZnSGhYRi94Z1p3cFkwSVZkVXBRbVRJU3hDK0lxc01GWWFOaGMwOTdXdXpmU0tJZHp1egptUUx1RkRTN2xaeWUvaThTd1kreVNsdTRUM2JudjRXYmhTSGo5RzM5Z1lkSmFISDlGL1hoMDJSTkl5aHYyQmZWCjgrTXMvd0hFZ0pxdzFRUTI5bU1BM0FxMW9yK281a3lyVkdwdWRMTHN2SW9ieS9YVzVJaUdPS2F6bnNBdThDZzIKc2U5eWdBOVovNFEyaW4va3gzS0taVHR5eG9MZThuZWh1Uno1aWxtT3JSU0plZU5DenNYOVdwS1BFU09raExLSwpsR1ZhVG1LRjUzbXZYTDFzbTlPNXQzL3FJKzd4NUhxUmhpMSszZm1Kb1E4eThxdWVxL20ySTBkZDZjRjRhT2FSCjRWd0ZMajRENDhQNi9YbDdEcVVaVzEvRGJiZ3pmNU1wWnUvdWF1YWoycnBaMlpycnJFYVByYUxzWEtGa2w5U00KdWg2QThOWVl6ejJOV1E4K042VHpPVlRBckJTdmRCSHhWNzY1N2VTOFo1M3h1MGRYZHRFQ08rWndsRkdlR0lwZApBYzNBY29rc2FqbUp3R0RjTU1udC9UbkRKZ2RtaUxERjN2QkFMODV0QWdNQkFBR2pVREJPTUIwR0ExVWREZ1FXCkJCUzRHelpPWXA4QWZFUFhKNGNWR1daSkJJanhlVEFmQmdOVkhTTUVHREFXZ0JTNEd6Wk9ZcDhBZkVQWEo0Y1YKR1daSkJJanhlVEFNQmdOVkhSTUVCVEFEQVFIL01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQ3llQmR6THY0TAoybFNhM3ZiRlYwM3JBTjRyTW9BVGRBeEtRUDdwRVA2OFBQM3lpakhRUzNnTk04bFFsSkNvV0ZWa21jc1djQ01rClRqUjVMN3VIRkZFbm9reFJkOW15Y0I2UmVpdE8xYldWV0RmWmdvc09JVGNCbUFzQlNJNXd0TEJ3dEhBNU5HMXAKOFJ6djBXZnFrbWNTRTVIaDh1U2tEUXVLL2hUdjBqTGNrVHl0YXRIUGo0a2VLeEloK1ByZFZEcmE2dU44REY5eApMVzhpMEk0bGpCS3dTSjhXeUhGeG85b2JVMyt0Z294QVJ2SUZKU1ZMM1lBMFNiQXpZNVdOelN2NklBZkxiOVIvCmwvTXRYcDBCd0VuWng1dWtieGh2UzdxMTJaRFVWVTFBdDhIblFKaHY3ZEhYNU9tL0xnZUZHdWtydEVRUnFLcE4KbXZyQmJnQXpEOGJpZk5ON0c2a2kveUNwbDhnbTFzRWdxc3JKODJvL0V5YjV2VWY0Ry84UzBaOStxeXM4U05BeQoxVGtGSU53MVYycDlYWGg1VUNOKytjSWlkTDdPcXhsRXV4R1U5Um9RaG5Ka0lqeG5xaXVyT1ZPWHg0NzhtaFZICkNGSENlcC9pVDlhc1dtVjdjbEptQXpuaGhvM2NIVUZpYVVoalFpeEZXRHZEV3ZFbFNDRVpOdWhSNFNPeCtrYloKLzFxNThaOHdtM2dUcmMwUFVuMjE5WlZLdmJsQVNWbURnYmxWdTBpWnNJVUE2WTRVSlpTdFFuVTFGTnBYYk44QgpFdC95MGo4TW1SUTljT1ZScFRVaFlSMUxrSUFDTXJSNUZoUjMyZjFSVk5yYzhoZ0NSYjkzTDY2WE9JNVpMeFdLCnV2WHltcUNkOVVEUGZWVGRsbzZJN1pQckVHM1RqTUd3UXc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    "key.pem": |- 
          LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRZ0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1N3d2dna29BZ0VBQW9JQ0FRQzRxRWNlZU5nbTdJYTQKd0U3S2NxRFNKdlZwTldZcVdqbTEyeGltQ2xLTVYwS0JQUitzVytUdC9vOTBlL0Riakc0dm5lQTIyRU0zZ0c3cwpVdVlxSnp3dVhpR0pQU3liemZ2UGdERmFPOGFrazRnSkRjRzVHMWE4TFJYdTc4YWJWNnFYZm5aYW1YazlsdXBYCmtoU3NFSUIzNWEvVE1Hbm0wRzU3SERlN1NhcVFJRVFKN013MC9kV053ZXFTN0oydlFFWUFLY2JtNHpjdlJzb2MKU0NWWUI0VnhmOFlHY0tXTkNGWFZLVUpreUVzUXZpS3JEQldHallYTlBlMXJzMzBpaUhjN3M1a0M3aFEwdTVXYwpudjR2RXNHUHNrcGJ1RTkyNTcrRm00VWg0L1J0L1lHSFNXaHgvUmYxNGROa1RTTW9iOWdYMWZQakxQOEJ4SUNhCnNOVUVOdlpqQU53S3RhSy9xT1pNcTFScWJuU3k3THlLRzh2MTF1U0loamltczU3QUx2QW9Ockh2Y29BUFdmK0UKTm9wLzVNZHlpbVU3Y3NhQzN2SjNvYmtjK1lwWmpxMFVpWG5qUXM3Ri9WcVNqeEVqcElTeWlwUmxXazVpaGVkNQpyMXk5Ykp2VHViZC82aVB1OGVSNmtZWXRmdDM1aWFFUE12S3JucXY1dGlOSFhlbkJlR2pta2VGY0JTNCtBK1BECit2MTVldzZsR1Z0ZncyMjRNMytUS1didjdtcm1vOXE2V2RtYTY2eEdqNjJpN0Z5aFpKZlVqTG9lZ1BEV0dNODkKalZrUFBqZWs4emxVd0t3VXIzUVI4VmUrdWUza3ZHZWQ4YnRIVjNiUkFqdm1jSlJSbmhpS1hRSE53SEtKTEdvNQppY0JnM0RESjdmMDV3eVlIWm9pd3hkN3dRQy9PYlFJREFRQUJBb0lDQUhGOHlxakpzRjdMdzBqTXVCL29MenE1ClF0NjBPT1FTcTZFKzFIbEhvdEFwMk8vQTl6UmhEZVBQTGE5emRPWVorcVk5SzAzSndCWGVVMDNlN1NJL0Z0ZVEKZHAvMy92Q0t1aFlmUFRXdHd6bm1paGEyWTdjMlBDcE9zMG8wQnlYMXpSeHFWcWI3NSsyWVVOSWRMNk5JU1F4bgpGNVorRExnVXBiSDM5N0NkWjd4SWVFaDVSay9US1dxRUlYekcrMnAzNEEyOW4wYkxvbURsNnRWUzZkQ2VYcjhRCnZrMjY4YVFwMlVhMm90MTUwOWlvWW5vcFpSbGE1VDdzcm53Z3hlbHhZWVpKck9LR0c5a0U2TUJuWHVUamJCNjYKZnNTOEUrcUtKOFVmZmNVRWFuY205SEtIQlMvNVVyNkZXZnd0QkV5WDRJRlZ0eHlKelBmekl1N3ZleHVxQStacgo2TlZXZjllMy9kRGtrdUpNRWJxZjNBYlY5cWVLcjgwMjRjVk5sbkhoekxLRzRyVEZJYU9RdEpKS3RLWDUyZGRHCnEyckFyYnR0a1JSQUsvdFdRZFE5ZXhjY1RxZVBEY0s4cituV2FRcENSL2xRT2FFSldXc2g0UGRhbWNaeWJvYTUKelYrQXE0eGtXUGFSdmhZeExiWERxSk9YQVpjOCsvRzFTbkowUkJtSUdpU3NYQjVCeDRYSFRuRWhmdUdrWnYyZgp0VzJMeGRWK3pieWt2aTRibXp2ZlYyVHUyVWZHU0EzQkdWN0FrZlZJck9iQTZid1NKZCsxSHVsNW95eGh4SHNOClRsUWlOR2xUSHdLOW93SCs2eTkyQ2lDQUhEV0NocGdEenlsWGExalVQUTlrMk1ieEp4WVNwNnJ0QmhHLzZkL28KNEhuVk0zWHU3SlBsQ3FBZmZnREJBb0lCQVFEemtCYVdPUUgvSDJEZnhMbVVYVDUxLzRRR0xyeFJkZDJJQkZvNwpuUWhNV20xVlRzVWg0OTdiOUozVVJlR2t1V1NPMll4UWlxcFAxOWdvQ2FmVEYwdm51ZVlRMDAzbUIyZE1FMG1jCmNUWDk2T1JKcGRyRUxSZWkxZmdtWHhPTnRiMGFNWFNwQzBFS2kySlF2SzI2cm5Cb2dXZlZRTWVydXI4NldiSDgKOFBUTjUzWkhtazV5NHVKY0ZjMjg4T2E3U1lkL0VVbXdHRlNZMll3SHB4Z2grZGRzNFhYUDVXRTFRWnAxazhFVwppRlN1cll4dElXZm14emM2WExzL01zcDlWTmRVOHlqWjQ1cmExcC9sL2ZzazN6M2xwSndLNW0za0ZNRmk2b0hFCitadUJFZGJFNzRtNmhDWS93Qm5rdFd2WnBKVnVzMXIrZkJKeURaOHNlb25ITkFwSkFvSUJBUURDRmlta25HaDcKdzRpK1ZITHdxdGVYaDhIc3N0WndKUHFuRDBTN1FNSStXTHpHOEhVZnZuRmlGcnBuK0RkL3JZcGphSDA5YUlCVQo5U214by82dEVqWjVRWHRIYUVKUnJGSWhhcUg2WmcrRTI1SGx2c0FPNDB0elpWZ2ZrT0llVXVGTHNJc2UyM1FICk9HRy9VOVBsa1M0N2ZFYVJ4RnZoT2pvaDZrRUxqd293Yk1vOEQ1YVF5N2tlZDJmTHhYRzkwaklkWjBia3NzeUkKNVM3UWg0Wmh2b1BOYUhld1pJZG9zdC9PUGxjVFFwekFlalRxMDgyek5IT3JIUnU3UDk2bHdQam5IYVo2QVlxZwpKdUtBRHRURTFUU1E2ZkNXUDIwa2kzSmRLTFZwTzMvZ0daU25pbFFoR0lmTmVNZVdNSE9YdSttOE5vdEJORmRuCmdWZlZZQXVscHNNRkFvSUJBUURRb09iSUROTHAvcTNUWDBaN2tKZDFLY2FrS1JwRVNNcld2S3V5RHFQU0MwOUYKMkhCQnhGZmNYeDltZWVsN1dSYUt5a3hIblUrZmpzcm9HTVU1cXVYbyt6TFh6TGdZUnRVenMvM0UxTENqNnY3SgpHeGxXR3kzNDNJRndGTmJCOXgraE5TV3h1eU1lYmlCcitnSnlPd09zY05SSk5mRVM1NmJ2eTI4THREWnR2VXR5CnIvbHNyVzJwNVQ5VERhTUdZRWlCRG9UcEl4NHJ3NFVQOVJCVjRoV21mVVdXSyt4bFd1bDh0M0NZNVhSc0g5cCsKakRQYzJWNDBUc1JSc1NjRHprMll4YVNEWjFQNUNnanpUK2YxUUloYmtmSGI0Ri9YRS9SR3o0c1M5NkE5SWRPdQo0MlE5Y1A3MmNvMTdlKytEQVZqQzl6MEZhYSsvSkczcEFwbk1HWWFKQW9JQkFGQ3BiMU1uWWRFVithM0lZU0NlCmtBMDg4WjZTME1ZNHlDZElGRE9TZldmMTd6YnExbktEN3BGcWlyd05EOXV6WHhGamFyRnJ6ZklCRmZ2ckFUd2kKbHBzY1dNVGJrcnhvMXBWbXdMelZUOXZTZVRjM2FKQ0hiR01nR2xpOEdRMnJPbEQvcFVJRXlKcjdscnd5ZFoweQpFam5NczNOL1hRUWs4K1lHZWxQNGRhNmNlQXd3R2s1QkxNVjVzSnlpaVZ2dmtMNWhucmdMaXkvVnQvZ1lhd1FTCmJxcWVvU2VoRUJtMlJZZHNwem1zOUlLV0I0b1V6cWVNeEFtNGhqN3pFM0JsMjh3SnFaZUpMbmpTMEUyU1hHRVYKanN3dlBicmp6MU5oMVB6Y24xQ0YxdVpuR3ozcUluN0N1Q1h2N1ZzQTlmbDRzbkp6WkxxTHEwdXNHTG5vT2M3MQptSlVDZ2dFQVFMSGpDaU1ZWGRxSTMwRm5JeEpJZDFDNmdSci9aN3BLK3NGdWE2Rm1ZMEZFeFlWNis4cWR3SHU1CjNWMEh6NTVmUGJoa1dQKzN5VWxzejlOenhEOTMyOTdWQ3N0ZFRpK29QcWpHbG9mRzVYcEgraGF2emt6RUFLc0cKelZDY1RZNXdSMHVBMll5YzJ6ZGlaM0tWOHJuMkZ1cXV3WENSMHFySUJWR0FFNzgyTTVOcDh4cEErRm9CSHl1ZQpoWnEvdGF1ZnZJR3B5cEFGejdsOHdQTTM4SjdzMEEwYlVQRjlQMDdLbitEcGJyd1BIcFMrZU9RZGVFVjdtSTRMCnZqV1kwVVFZV3k5QUxGMG1oQUJrM2ttKzlzYXQ1YjJXcDR6eFFZaDREWW1rL09qWWJ2bS9VV0cySEdXbjl4ZUsKeGJndkVJQlNRczZHdmVqY0xWTWJJTWlwTmxDWUVRPT0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=
    "password": |- 
          cGFzc3dvcmQK
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data:
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
          labels: 
            name: ~NAME~
          name: ~NAME~
      spec:
        volumes:
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret
              - secret:
                  name: ~NAME~-secret-config
              - secret:
                  name: ~NAME~-secret-cert
        containers:
          - name: ~NAME~
            image: ~IMAGE_STREAM~
            volumeMounts:
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/sf/cmod/secrets
            env:
              - name: MY_POD_NAME
                valueFrom:
                  fieldRef:
                    fieldPath: metadata.name
              - name: MY_POD_IP
                valueFrom:
                  fieldRef:
                    fieldPath: status.podIP
            ports:
              - name: https
                containerPort: 8060
                protocol: TCP
            resources:
              {}
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: ClusterIP
    ports:
      - port: 8060
        protocol: TCP
        name: https-cmod
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;

//================================================
hpe5gResources.defaults['nrf-reg-agent']['template']=
//================================================
`
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-nnrf-reg-agent.yml: |
      # Sample Thorntail global configuration.
      #
      swarm:
        https:
          only: false
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        io:
          workers:
            default:
              io-threads: 4
              task-max-threads: 32
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  buffer-pool: null
                  http2-header-table-size: null
                  http2-initial-window-size: null
                  http2-max-concurrent-streams: null
                  http2-max-frame-size: null
                  http2-max-header-list-size: null
                  max-buffered-request-size: null
                  max-connections: 2000
                  max-header-size: null
                  max-headers: null
                  max-processing-time: null
                  no-request-timeout: null
                  read-timeout: null
                  receive-buffer: null
                  send-buffer: null
                  ssl-session-cache-size: null
                  ssl-session-timeout: null
                  url-charset: null
                  verify-client: null
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
              cipher-suite-filter: DEFAULT
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: password
          key-stores:
            ks:
              path: /etc/opt/hpe-5g/hpe-nnrf-reg-agent/security/keystore.p12
              credential-reference:
                clear-text: password
              type: PKCS12
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            com.hpe:
              level: INFO
            com.hpe.imsc:
              level: ERROR
            io.jaegertracing.internal.reporters.LoggingReporter:
              level: ERROR
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            metrics_influxdb.measurements:
              level: ERROR
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
              use-parent-handlers: false
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{1.1.1.20.}] (%t) %s%e%n"
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nnrf-reg-agent-config.yaml: |
      # Network function NNRF Client MicroService configuration.
      # The parameters below can be overridden by an external configuration.
      # HTTP/2 REST client subsystem
      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.okhttp.connector.OkhttpConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 50
          jersey.config.client.followRedirects: false
          jersey.config.client.connectTimeout: 100
          jersey.config.client.readTimeout: 1000
        security:
          keyCertificateLocation:
          keystoreLocation:
          keystorePassword: password
          keyCertificatePKLocation:
          keyCertificateKeyPairPassword:
          keyManagerFactoryAlgorithm:
          truststoreLocation:
          trustCertificateLocation:
          truststorePassword:
          trustCertificatePKLocation:
          trustCertificateKeyPairPassword:
          trustManagerFactoryAlgorithm:
          cryptoProtocol: TLSv1.2
          passwordEncoded: false
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
          - name: fluentd
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.fluent.FluentI18nLoggerFactoryImpl
            properties:
              host: ~fluentd_NAME~.~PROJECT~.svc.cluster.local
              port: 24224
      statistics-configuration:
        id: hpe-nf-nrf-reg-agent-statistics
        jmx:
          domain: nnrf-reg-agent
          enabled: false
          properties:
            com.hpe.imsc.statistics.jmx.descriptors: false
            com.hpe.imsc.statistics.jmx.notifications: false
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.database: nnrf-reg-agent
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
          com.hpe.imsc.statistics.influxdb.server.port: 8086
          com.hpe.imsc.statistics.influxdb.server.protocol: http
      nnrf-client:
        discover-stub-mode: false
        # json file containing remote NF profile to be discovered in stub-mode
        stub-remote-nf-profile: 
        server-scheme: https
        server-fqdn: nrf.server.hpecorp.net
        server-port: 8443
        server-version: v1
        retry-limit: -1
        nfprofile-uri: file:/etc/opt/hpe-5g/hpe-nnrf-reg-agent/nnrf-register.config
        disable-register: false 
        disable-deregister: false
        opentracing-enabled: false
        enable-cache: false
        default-cache-validity-period-secs: 3600
        self-service-name: hpe-nf-nrf-reg-agent
        monitor-service-name: 
        monitor-interval: 15000
        kubernetes-namespace: default
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-register-configmap
    namespace: ~PROJECT~
  data:
    nnrf-register.config: |
      {
        "nfInstanceId": "0590E150-4C69-4d86-A49C-990BF056F994",
        "nfType":"UDM",
        "nfStatus":"REGISTERED",
        "heartBeatTimer": "45", 
        "ipv4Addresses":["127.0.0.1"],
        "plmnList":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],
        "fqdn":"localhost",
        "allowedNfTypes": ["NEF"],
        "nfServices" : [ {
            "serviceInstanceId" : "UDM-EE-HPE",
            "serviceName" : "nudm-ee",
            "versions" : [ {
              "apiVersionInUri" : "v1",
              "apiFullVersion" : "1.0.2"
            } ],
            "scheme" : "https",
            "nfServiceStatus" : "REGISTERED",
            "fqdn":"localhost",
            "ipEndPoints" : [ {
              "ipv4Address" : "127.0.0.1",
              "transport" : "TCP",
              "port" : "30045"
            } ],
            "allowedNfTypes": ["NEF"]
          } ]
      }
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data: 
    "keystore.p12": |- 
      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
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:  
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-register-configmap
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret
        containers:
          - name: ~NAME~ 
            image: ~IMAGE_STREAM~  
            volumeMounts:
            - name:  ~NAME~-config-volume
              mountPath: /etc/opt/hpe-5g/hpe-nnrf-reg-agent
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe-5g/hpe-nnrf-reg-agent/security
            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
              - name: health
                containerPort: 8080
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe-5g/hpe-nnrf-reg-agent/nnrf-reg-agent-config.yaml
            livenessProbe:
              httpGet:
                path: /probes/healthy
                port: health
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 10
            readinessProbe:
              httpGet:
                path: /probes/healthz
                port: health
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 10
            resources:
              {}
        serviceAccountName: ~NAME~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: 
    ports:
      - port: 8443
        protocol: TCP
        name: nnrf-reg-agent-https
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['nudm-ee']['template']=
//================================================
`
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-5g-nudm-ee.yml: |
      #
      # Sample Thorntail global configuration.
      #
      swarm:
        https:
          only: false
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        io:
          workers:
            default:
              io-threads: 4
              task-max-threads: 32
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  buffer-pool:
                  http2-header-table-size: 
                  http2-initial-window-size: 
                  http2-max-concurrent-streams: 
                  http2-max-frame-size: 
                  http2-max-header-list-size:
                  max-buffered-request-size:
                  max-connections: 2000
                  max-header-size:
                  max-headers:
                  max-processing-time:
                  no-request-timeout: 
                  read-timeout:
                  receive-buffer:
                  send-buffer: 
                  ssl-session-cache-size:
                  ssl-session-timeout:
                  url-charset:
                  verify-client:
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: password
          key-stores:
            ks:
              path: /etc/opt/hpe/nf/udm/ee/security/keystore.jks
              credential-reference:
                clear-text: password
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            com.hpe:
              level: INFO
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{1.1.1.20.}] (%t) %s%e%n"
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nudm-ee-nf-config.yaml: |
      #
      # Sample Network function configuration.
      #
      # HTTP/2 REST client subsystem
      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.okhttp.connector.OkhttpConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 50
          jersey.config.client.followRedirects: false
          jersey.config.client.connectTimeout: 1000
          jersey.config.client.readTimeout: 10000
        security:
          keyCertificateLocation:
          keystoreLocation:
          keystorePassword: password
          keyCertificatePKLocation:
          keyCertificateKeyPairPassword:
          keyManagerFactoryAlgorithm:
          truststoreLocation:
          trustCertificateLocation:
          truststorePassword:
          trustCertificatePKLocation:
          trustCertificateKeyPairPassword:
          trustManagerFactoryAlgorithm:
          cryptoProtocol: TLSv1.2
          passwordEncoded: false
      nudm-ee:
        hplmn.mcc: 909
        hplmn.mnc: 88
        eeSubscirpionExpiryDuration: 172800
        udr:
          hostname: localhost
          port: 5090
          scheme: http
          version: v1
          basepath: http://15.213.52.238:5090
          eeExprityMaxDays: 2
      nnrf-client:
        server-scheme: https
        server-fqdn: nrf.server.hpecorp.net
        server-port: 8443
        server-version: v1
        nfprofile-uri: /etc/opt/hpe/nf/udm/ee/nnrf-register.config
        enable-cache: false
        default-cache-validity-period-secs: 3600
        discover-stub-mode: false
        # json file containing remote NF profile to be discovered in stub-mode
        stub-remote-nf-profile: /etc/opt/hpe/nf/udm/ee/udr-disc.json
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
          - name: fluentd
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.fluent.FluentI18nLoggerFactoryImpl
            properties:
              host: fluentd.logging
              port: 24224
      statistics-configuration:
        id: nudm-ee-statistics
        enabled: true
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: 8086
          com.hpe.imsc.statistics.influxdb.server.protocol: http
          com.hpe.imsc.statistics.influxdb.server.database: nudm-nf
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
        jmx:
          enabled: false
      call-tracing:
        properties:
          JAEGER_SERVICE_NAME: ~NAME~
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 8090
          JAEGER_ENDPOINT: http://localhost:6831/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: false
          JAEGER_SAMPLER_TYPE: "probabilistic"
          JAEGER_SAMPLER_PARAM: 1.0
        enabled: true
        trace-all-operations: true
        trace-all-ues: false
        provisioning-uri: "file:/etc/opt/hpe/nf/udm/ee/call-tracing-provisioning.yaml"
        max-trace-depth: MINIMUM
        max-body-length: 1200
        autorefresh-provisioning-period: 30
      caching-providers:
        - cache-managers:
          - caches: null
            classloader: '#notused'
            properties: null
            uri: paas://redis-cache-manager
          classloader: '#notused'
          properties:
            caching.provider.class.name: com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider
          uri: paas://redis-caching-provider
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-nnrf-registration
    namespace: ~PROJECT~
  data:
    nnrf-register.config: |
      {
        "nfInstanceId": "0590E150-4C69-4d86-A49C-990BF056F994",
        "nfType":"UDM",
        "nfStatus":"REGISTERED",
        "heartBeatTimer": "45", 
        "ipv4Addresses":["127.0.0.1"],
        "plmnList":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],
      
        "fqdn":"localhost",
        "allowedNfTypes": ["NEF"],
        "nfServices" : [ {
            "serviceInstanceId" : "UDM-EE-HPE",
            "serviceName" : "nudm-ee",
            "versions" : [ {
              "apiVersionInUri" : "v1",
              "apiFullVersion" : "1.0.2"
            } ],
      
            "scheme" : "https",
      
            "nfServiceStatus" : "REGISTERED",
            "fqdn":"localhost",
            "ipEndPoints" : [ {
              "ipv4Address" : "127.0.0.1",
              "transport" : "TCP",
              "port" : "30045"
            } ],
            "allowedNfTypes": ["NEF"]
          } ]
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-log4j
    namespace: ~PROJECT~
  data:
    log4j2.xml: |
`
+log4j2xml+
`
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-udr-discovery
    namespace: ~PROJECT~
  data:
    udr-disc.json: |
      [ {
      "nfInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
      "nfType" : "UDR",
      "nfStatus" : "REGISTERED",
      "plmnList" : [ {
        "mcc" : "111",
        "mnc" : "222"
      } ],
      "ipv4Addresses":["127.0.0.1"],
      "nfServicePersistence" : false,
      "nfServices" : [ {
          "serviceInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
          "serviceName" : "~nudr-dr_NAME~",
          "versions" : [ {
            "apiVersionInUri" : "v1",
            "apiFullVersion" : "1.0.0"
          } ],
          "scheme" : "https",
          "nfServiceStatus" : "REGISTERED",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",
            "port" : "5090"
          } ],
        "allowedPlmns" : [ {
          "mcc" : "208",
          "mnc" : "01"
        } ],
        "allowedNfTypes" : [ "NEF", "UDM", "PCF", "BSF" ],
        "allowedNfDomains" : [ "pfdmanagement.nnef.cms5g.hpe.com" ]
      } ]
      } ]
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data:
    keystore.jks: |- 
      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
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:  
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-application-configmap-nnrf-registration
              - configMap:
                  name: ~NAME~-application-configmap-log4j
              - configMap:
                  name: ~NAME~-application-configmap-udr-discovery
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret
        containers:
          - name: ~NAME~
            image: ~IMAGE_STREAM~
            imagePullPolicy: IfNotPresent
            volumeMounts:
            - name: ~NAME~-config-volume
              mountPath: /etc/opt/hpe/nf/udm/ee
            - name: ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/nf/udm/ee/security
            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
            ports:
              - name: health
                containerPort: 8080
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe/nf/udm/ee/nudm-ee-nf-config.yaml
            livenessProbe:
              httpGet:
                path: /rest/probes/healthy
                port: health
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            readinessProbe:
              httpGet:
                path: /rest/probes/healthz
                port: health
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            resources:
              limits:
                cpu: 1000m
                memory: 2048Mi
              requests:
                cpu: 500m
                memory: 1024Mi
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    ports:
      - port: 8443
        protocol: TCP
        name:  https-nudm-nf
        targetPort: 30045
    selector:
      name: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['nudm-li-poi']['template']=
//================================================
`
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-5g-nudm-li-poi.yml: |
      # Sample Thorntail global configuration.
      #
      swarm:
        https:
          only: true
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        http:
          port: 8080
        undertow:
          alias: localhost
          servers:
            default-server:
              http-listeners:
                default:
                  enabled: true
                  socket-binding: http
                  enable-http2: true
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: password
          key-stores:
            ks:
              path: "/etc/opt/hpe/nf/udm/li-poi/security/keystore.jks"
              credential-reference:
                clear-text: password
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            com.hpe:
              level: INFO
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-log4j
    namespace: ~PROJECT~
  data:
    log4j2.xml: |
`
+log4j2xml+
`
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nudm-li-poi-nf-config.yaml: |
      # Sample Network function DEFAULT configuration.
      #
      # The parameters below can be overridden by an external configuration.
      #
      # HTTP/2 REST client subsystem
      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.netty.connector.Http2NettyConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 10
          jersey.config.client.connectTimeout: 100
          jersey.config.client.readTimeout: 100
      poi:
        oid: "0.4.0.2.2.4.19.15.1.4.19.15.1.1" 
      # Kafka configuration 
      pubsub:
        brokers:
         - ~kafka_NAME~-kafka-brokers.~PROJECT~.svc.cluster.local:9092
        properties:
          group.id:  UDMMsgConsumerGroup
        udmEventReportQueue: UDMServingSystem
      # X2 Packet configuration
      x2pdu:
        version: 1
        pduType:
           x2: 1
           KeepAlive: 3
           KeepAliveAck: 3
        payloadFormat: 2   
        payloadDirection: 5
        attributes:
           timestamp: 9
           matchedTargetIdentifier: 17
      logging:
        locale: en-US
        loggers:
        - factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
          name: log4j2
      statistics-configuration:
        id: nudm-li-poi-statistics
        enabled: true
        jmx:
          domain: Nnef_UDM_LiPoi
          enabled: true
          properties:
            com.hpe.imsc.statistics.jmx.descriptors: "true"
            com.hpe.imsc.statistics.jmx.notifications: "true"
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.database: nflipoi
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
          com.hpe.imsc.statistics.influxdb.server.port: "8086"
          com.hpe.imsc.statistics.influxdb.server.protocol: http
          com.hpe.imsc.statistics.publish.jsonDescriptors: true
        pubsub-publisher-enabled: false
        pubsub-subscriber-enabled: true
      caching-providers:
        - cache-managers:
          - caches:
            - eternal: "true"
              keyType: java.lang.String
              name: simple-redis-cache
              properties:
                cache.codec: com.hpe.cms5g.udm.li.common.utils.TFEncryptionCodec
                cache.connect: false
                cache.uri: redis://~redis_NAME~.~PROJECT~.svc.cluster.local:6379?database=0
              readThrough: "false"
              valueType: java.lang.String
              writeThrough: "false"
            classloader: '#notused'
            properties: null
            uri: paas://redis-caching-manager
          classloader: '#notused'
          properties:
            caching.provider.class.name: com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider
          uri: paas://redis-caching-manager      
      # Security
      tls:
        protocols: TLSv1.2
        connection.timeout: 3000
        keystore: "/etc/opt/hpe/nf/udm/li-poi/security/keystore.jks"
        keystorePassword : password
        truststore: "/etc/opt/hpe/nf/udm/li-poi/security/keystore.jks"
        truststorePassword : password
      
      dataEncryption:
        dataSecret: "VU5JWjVBQkNENjc4OTBFRg==" 
        keySecret: "secureMe"
      #UECM data validation
      validation:
        peiImeipattern: "((imei-)([0-9]{14}))"
        peiImeicdpattern: "((imeicd-)([0-9]{15}))"
        peiImeisvpattern: "((imeisv-)([0-9]{16}))"
        guamiPlmnIdpattern: "([0-9]*+[\\\\s])([0-9]*)"
        guamiAmfIdpattern: "([0-9]*+[\\\\s]){2}([0-9]*)"
        supiImsi: "imsi-[0-9]{6,15}"
        supiNai: "nai-(.+)@(.+)"
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:  
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-application-configmap-log4j
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret
        containers:
          - name: ~NAME~
            image: ~IMAGE_STREAM~
            imagePullPolicy: IfNotPresent
            volumeMounts:
            - name:  ~NAME~-config-volume
              mountPath: /etc/opt/hpe/nf/udm/li-poi
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/nf/udm/li-poi/security
            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
            ports:
              - name: health
                containerPort: 8080
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe/nf/udm/li-poi/nudm-li-poi-nf-config.yaml -Dpaas.service.name=nudm-li-poi
            livenessProbe:
              httpGet:
                path: /rest/probes/healthy
                port: health
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 10
            readinessProbe:
              httpGet:
                path: /rest/probes/healthz
                port: health
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 10
            resources:
              {}
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data:
    keystore.jks: |- 
      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
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    ports:
      - port: 8443
        protocol: TCP
        name:  https-nudm-nf
        targetPort: 30045
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['nudm-li-tf']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data: 
    "keystore.jks": |- 
      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
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-log4j
    namespace: ~PROJECT~
  data:
    log4j2.xml: |
  `
  +log4j2xml+
  `
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nudm-li-tf-nf-config.yaml: |
      # Sample Network function DEFAULT configuration.
      #
      # The parameters below can be overridden by an external configuration.
      #
      # HTTP/2 REST client subsystem
      caching-providers:
        - cache-managers:
          - caches:
            - eternal: "true"
              keyType: java.lang.String
              name: simple-redis-cache
              properties:
                cache.codec: com.hpe.cms5g.udm.li.common.utils.TFEncryptionCodec
                cache.connect: false
                cache.uri: redis://~redis_NAME~.~PROJECT~.svc.cluster.local:6379?database=0
              readThrough: "false"
              valueType: java.lang.String
              writeThrough: "false"
            classloader: '#notused'
            properties: null
            uri: paas://redis-caching-manager
          classloader: '#notused'
          properties:
            caching.provider.class.name: com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider
          uri: paas://redis-caching-manager  
      
      logging:
      
        locale: en-US
        loggers:
        - factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
          name: log4j2
      
      statistics-configuration:
        id: nudm-li-tf-statistics
      
        enabled: true
        http-client-enabled: true
        http-server-enabled: true
        jmx:
          domain: Nnef_UDM_LiTf
          enabled: true
          properties:
            com.hpe.imsc.statistics.jmx.descriptors: "true"
            com.hpe.imsc.statistics.jmx.notifications: "true"
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.database: nflitf
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
          com.hpe.imsc.statistics.influxdb.server.port: "8086"
          com.hpe.imsc.statistics.influxdb.server.protocol: http
          com.hpe.imsc.statistics.publish.jsonDescriptors: true
      
      # Schema Validation
      validation:
        internationalE164: "[0-9]{1,15}"
        imsi: "[0-9]{6,15}"
        imei: "[0-9]{14}"
        imeiCheckDigit: "[0-9]{15}"
        imeisv: "[0-9]{16}"
        ipv4Address: "((25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\\\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])"
        ipv6Address: "([0-9a-f]{4}:){7}([0-9a-f]{4})"
        tcpport: "^([1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$"
        udpport: "^([0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$"
        emailAddress: "[a-zA-Z0-9\\\\.!#$%&amp;'\\\\*\\\\+\\\\\\\\/=\\\\?\\\\^_\`\\\\{\\\\|\\\\}~\\\\-]+@[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*"
        uuid: "[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}"
        token: "^(\\\\S+)"
        qualifiedMicrosecondDateTime: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\\\.[0-9]{6}(Z|[+-][0-9]{2}:[0-9]{2})$"
        version: "v1.6.1"
        deliveryType: "X2Only"
        enableKeepAlive: true
      
      keepAlive:
        TIME_P2: 60
        
      dataEncryption:
        dataSecret: "VU5JWjVBQkNENjc4OTBFRg=="
        keySecret: "secureMe"
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-5g-nudm-li-tf.yml: |
      # Sample Thorntail global configuration.
      #
      
      swarm:
        https:
          only: true
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
        http:
          port: 8080
        undertow:
          alias: localhost
          servers:
            default-server:
              http-listeners:
                default:
                  enabled: true
                  socket-binding: http
                  enable-http2: true
                  always-set-keep-alive: true
              https-listeners:
                default-https:
                  enabled: true
                  socket-binding: https
                  enable-http2: true
                  ssl-context: twoWaySSC
                  always-set-keep-alive: true
          application-security-domains:
            applicationDomain:
              security-domain: myDomain 
        elytron:
          key-store-realms:
            ksRealm:
              key-store: twoWayTS
          x500-attribute-principal-decoders:
            CNDecoder:
              oid: 2.5.4.3
              maximum-segments: 1
          security-domains:
            myDomain:
              realms:
                - realm: ksRealm
              default-realm: ksRealm
              principal-decoder: CNDecoder
              permission-mapper: default-permission-mapper
             
          server-ssl-contexts:
            twoWaySSC:
              protocols: TLSv1.2
              key-manager: twoWayKM
              trust-manager: twoWayTM
              need-client-auth: true
              security-domain: myDomain
          key-managers:
            twoWayKM:
              key-store: twoWayKS
              credential-reference:
                clear-text: password
          trust-managers:
            twoWayTM:
              key-store: twoWayTS
              credential-reference:
                clear-text: password
          key-stores:
            twoWayKS:
              path: "/etc/opt/hpe/nf/udm/li-tf/security/keystore.jks"
              credential-reference:
                clear-text: password
              type: JKS
            twoWayTS:
              path: "/etc/opt/hpe/nf/udm/li-tf/security/keystore.jks"
              credential-reference:
                clear-text: password
              type: JKS
          file-audit-logs:
            local-audit:
              path: /var/opt/hpe/nf/udm/li-tf/logs/audit.log
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
      
            com.hpe:
              level: INFO
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{1.1.1.20.}] (%t) %s%e%n"
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: NodePort
    ports:
      - port: 8443
        nodePort: 30673
        protocol: TCP
        name: https-nudm-nf
  selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-application-configmap-log4j   
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret
        containers:
          - name: ~NAME~
            image: ~IMAGE_STREAM~
            imagePullPolicy: IfNotPresent
            volumeMounts:
            - name:  ~NAME~-config-volume
              mountPath: /etc/opt/hpe/nf/udm/li-tf
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/nf/udm/li-tf/security
            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
            ports:
              - name: health
                containerPort: 8080
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe/nf/udm/li-tf/nudm-li-tf-nf-config.yaml -Dpaas.service.name=nudm-li-tf
            livenessProbe:
              httpGet:
                path: /rest/probes/healthy
                port: health             
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 10
            readinessProbe:
              httpGet:
                path: /rest/probes/healthz
                port: health              
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 10
            resources:
              limits:
                cpu: 1000m
                memory: 2048Mi
              requests:
                cpu: 500m
                memory: 1024Mi
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['nudm-ueau']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data: 
    "keystore.jks": |- 
      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
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-call-tracing
    namespace: ~PROJECT~
  data:
    call-tracing-provisioning.yaml: |
      ue-provisioning:
        - ue-id:
            - "imsi-0555555555"
            - "msisdn-6666666666"
          traced-service:
            - ~NAME~
          propagate-trace: true
          trace-depth: "MEDIUM"
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-log4j
    namespace: ~PROJECT~
  data:
    log4j2.xml: |
  `
  +log4j2xml+
  `
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-nnrf-registration
    namespace: ~PROJECT~
  data:
    nnrf-register.config: |
      {
      "nfInstanceId": "0590E150-4C69-4d86-A49C-990BF056F993",
      "nfType":"UDM",
      "nfStatus":"REGISTERED",
      "heartBeatTimer": "45",
      "ipv4Addresses":["127.0.0.1"],
      "plmnList":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],
  
      "fqdn":"localhost",
      "allowedNfTypes": ["AUSF"],
      "nfServices" : [ {
          "serviceInstanceId" : "UDM-UEAU-HPE",
          "serviceName" : "~NAME~",
          "versions" : [ {
            "apiVersionInUri" : "v1",
            "apiFullVersion" : "1.0.1"
          } ],
  
          "scheme" : "https",
  
          "nfServiceStatus" : "REGISTERED",
          "fqdn":"localhost",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",
            "port" : "30046"
          } ],
          "allowedNfTypes": ["AUSF"]
        } ]
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-udr-discovery
    namespace: ~PROJECT~
  data:
    udr-disc.json: |
      [ {
      "nfInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
      "nfType" : "UDR",
      "nfStatus" : "REGISTERED",
      "plmnList" : [ {
        "mcc" : "111",
        "mnc" : "222"
      } ],
      "ipv4Addresses":["127.0.0.1"],
      "nfServicePersistence" : false,
      "nfServices" : [ {
          "serviceInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
          "serviceName" : "~nudr-dr_NAME~",
          "versions" : [ {
            "apiVersionInUri" : "v1",
            "apiFullVersion" : "1.0.0"
          } ],
          "scheme" : "https",
          "nfServiceStatus" : "REGISTERED",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",
            "port" : "5090"
          } ],
        "allowedPlmns" : [ {
          "mcc" : "208",
          "mnc" : "01"
        } ],
        "allowedNfTypes" : [ "NEF", "UDM", "PCF", "BSF" ],
        "allowedNfDomains" : [ "pfdmanagement.nnef.cms5g.hpe.com" ]
      } ]
      } ]
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nudm-ueau-nf-config.yaml: |
      #
      # Sample Network function configuration.
      #
      # HTTP/2 REST client subsystem
      ---
      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.okhttp.connector.OkhttpConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 50
          jersey.config.client.followRedirects: false
          jersey.config.client.connectTimeout: 1000
          jersey.config.client.readTimeout: 10000
      
        security:
          keyCertificateLocation:
          keystoreLocation:
          keystorePassword: password
          keyCertificatePKLocation:
          keyCertificateKeyPairPassword:
          keyManagerFactoryAlgorithm:
          truststoreLocation:
          trustCertificateLocation:
          truststorePassword:
          trustCertificatePKLocation:
          trustCertificateKeyPairPassword:
          trustManagerFactoryAlgorithm:
          cryptoProtocol: TLSv1.2
          passwordEncoded: false
      
      udm-ueau:
        hplmn.mcc: 909
        hplmn.mnc: 88
      
        cmod:
          hostname: cmod
          port: 8060
          scheme: https
        threadpool:
          size: 30  
      
      nnrf-client:
        server-scheme: https
        server-fqdn: nrf.server.hpecorp.net
        server-port: 8443
        server-version: v1
        nfprofile-uri: /etc/opt/hpe/nf/udm/ueau/nnrf-register.config
        enable-cache: false
        default-cache-validity-period-secs: 3600
        discover-stub-mode: false
        # json file containing remote NF profile to be discovered in stub-mode
        stub-remote-nf-profile: /etc/opt/hpe/nf/udm/ueau/udr-disc.json
      
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
          - name: fluentd
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.fluent.FluentI18nLoggerFactoryImpl
            properties:
              host: fluentd.logging
              port: 24224
      
      statistics-configuration:
        id: nudm-ueau-statistics
        enabled: true
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: 8086
          com.hpe.imsc.statistics.influxdb.server.protocol: http
          com.hpe.imsc.statistics.influxdb.server.database: nudm-nf
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
        jmx:
          enabled: false
      call-tracing:
        properties:
          JAEGER_SERVICE_NAME: ~NAME~
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 8090
          JAEGER_ENDPOINT: http://localhost:6831/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: false
          JAEGER_SAMPLER_TYPE: "probabilistic"
          JAEGER_SAMPLER_PARAM: 1.0
        enabled: true
        trace-all-operations: true
        trace-all-ues: false
        provisioning-uri: "file:///etc/opt/hpe/nf/udm/ueau/call-tracing-provisioning.yaml"
        max-trace-depth: MINIMUM
        max-body-length: 1200
        autorefresh-provisioning-period: 30
      
      caching-providers:
        - cache-managers:
          - caches: null
            classloader: '#notused'
            properties: null
            uri: paas://redis-cache-manager
          classloader: '#notused'
          properties:
            caching.provider.class.name: com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider
          uri: paas://redis-caching-provider

- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-5g-nudm-ueau.yml: |
      #
      # Sample Thorntail global configuration.
      #
      swarm:
        
        https:
          only: false
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
  
        io:
          workers:
            default:
              io-threads: 4
              task-max-threads: 32
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  buffer-pool: 
                  http2-header-table-size: 
                  http2-initial-window-size: 
                  http2-max-concurrent-streams: 
                  http2-max-frame-size: 
                  http2-max-header-list-size:
                  max-buffered-request-size:
                  max-connections: 2000
                  max-header-size:
                  max-headers:
                  max-processing-time:
                  no-request-timeout: 
                  read-timeout:
                  receive-buffer:
                  send-buffer: 
                  ssl-session-cache-size:
                  ssl-session-timeout:
                  url-charset:
                  verify-client:
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: password
          key-stores:
            ks:
              path: /etc/opt/hpe/nf/udm/ueau/security/keystore.jks
              credential-reference:
                clear-text: password
              type: JKS
          file-audit-logs:
            local-audit:
              path: /var/opt/hpe/nf/udm/ueau/logs/audit.log
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            com.hpe:
              level: INFO
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{1.1.1.20.}] (%t) %s%e%n"
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: NodePort
    ports:
      - port: 8443
        protocol: TCP
        name:  https-nudm-nf
        targetPort: 30046
  selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-application-configmap-nnrf-registration
              - configMap:
                  name: ~NAME~-application-configmap-log4j
              - configMap:
                  name: ~NAME~-application-configmap-udr-discovery
              - configMap:
                  name: ~NAME~-application-configmap-call-tracing    
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret
        containers:
          - name: ~NAME~
            image: ~IMAGE_STREAM~
            imagePullPolicy: IfNotPresent
            volumeMounts:
            - name:  ~NAME~-config-volume
              mountPath: /etc/opt/hpe/nf/udm/ueau
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/nf/udm/ueau/security
            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
            ports:
              - name: health
                containerPort: 8080
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe/nf/udm/ueau/nudm-ueau-nf-config.yaml
            livenessProbe:
              httpGet:
                path: /rest/probes/healthy
                port: health             
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 40
            readinessProbe:
              httpGet:
                path: /rest/probes/healthz
                port: health              
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 40
            resources:
              limits:
                cpu: 1000m
                memory: 2048Mi
              requests:
                cpu: 500m
                memory: 1024Mi
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['nudm-uecm']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data: 
    "keystore.jks": |- 
      /u3+7QAAAAIAAAABAAAAAQAFYWxpYXMAAAFwKUVx5gAABQIwggT+MA4GCisGAQQBKgIRAQEFAASCBOqaZb+B8sohwziKl6IiRwrLTfMMtd/LqX/eSpFJtDIkYxVlSR9j5OTone60qs0Sn7mWqf2R9uDXLC7cujb6YXcqvXTO7SpozW+rBZz9XjyCSDNlxSrK962GJuSBCFLEnKOsSFxspNUJLYI827ZKVdJ9OQ2Rb50oO3Ruzy6CA9O4K/lXjDtZOJ0SEi9EY4BjlASb3jtSnnZ/IYxnxIztEgwub/4+V2UTPAUiSs4dx3U54s8+nTKczhVN+rL6z/EqirZ3ukNIg3Uu73c4r6iDMqMfxD3DhvVcbY+k/sQs+FFL/fhYdU5Y/X2ILgLz+AqgdEZZ8tW9XhkkDdmncPx5YgWGyys7KWNuReFIuWXbfCC4bIjTHgVzjci4R2JdrfiEjJ8vA295Xijo0ZJK62PemayiFr5xoY4D770+L5I17l79q4iYQylqgCTduEaHv+jOehrGZuyz32YPZYmZpgR8fITKGhxCUEErfQ8CHjFfuCwGTEzrQnedN5YbR3/j4ZshP6JhIaOTEgOsWcb8b6w7OARMzTjAFfo+9xqcSTO+39PElsF+4tYkqaSamGa/6E4gE4yNKU51EXXhbnKJ3IrgVnOZlRkIGaL4FMInWwe0zmQcqk5f39bfriPKh8BtlaxZCC4B3w0UpYStcvpHEYu+xO8aUb6BVzckm/vW69PXjvrWKTD/OhmVCJl6fX5W0eha5FeF7Wul/srpTmFdZtuItc/YfmAONhVpiHksXKMBnlM8d1FHibGZpvMiFM52RuHx1WjpW58IEIx2H3G81TLbeaVo7ldhyaZozJf6khwzKaKHqxeromrlWR8no2PmzjQe3FNv1rjca9gdW6wo9zVBib0aqvxEtpq5oKt18DEELLKMLr9IuRIcOV+v3WqLRoJmf2feuYFvF8SXMWJ0V1SJH41H29uDWZDhEi3rEIuIca+uxudYxs3mGcSrDVbF4nAdlvJDzf96oHjB0m+i2pMlHQjwxeVWP1Zp0SOWYX2CvUPua/7Kj27k5etBTv4Sa+TZt1MDt7sgdZdA+JQ/eGScYRhcmGDktPqnZ0zJZzsZsXRq895FORcJW3C1BOi3LnAI171WOdcVWaL9UJRBh3wYi3SETXTlS3pKCJq7zAS9dArYiakCoxXUDyxMJDbnOTIKDmf6OtEID7j1enHuBDz19UujNjzpbkyAzgxPl9evy/dpN41sA9JlOaD2QyRL0Xali2PR9wbuiwGqMG1Jrne2Cf/MRkmUcTsoDviAxPxjMGrVOYUFh4dpTksY64vlQaok6+FVL3PJYW2kt10RWegSm8b4HWShPKJBcTq5Pv5fzLt7z26VILMNn4CZBv40aMP+1riQ22/w3IKVKWaYaITZ54petaZDd+21zeHPxRXAsPMNwDlTsm3UdN9X1DUavBxI+MXSqOxn93l3K/qu2cGkw96R3k0mFCXHg+tgW9IfBnS9lwywOMoXOwU2aj9ioUdfsLFBChl/DHobeATEt5auZrievuqND30ofcE3MafpPtPI5JBp8eFe1WovSC3YtwIVK878la1U0pxTz7Za8dRWw+pGIoHpYCWQI74IuKLl41YjqOFr/3aevfDHBtzOuXgswU/wJgI2YpyizJZfh4Ngrbs+bzcCG9rSjWG+mTeYi7nugmxW74chn03cHGXTISXGxbfqgdci505YQF7yAAAAAQAFWC41MDkAAANjMIIDXzCCAkegAwIBAgIEM7Re6TANBgkqhkiG9w0BAQsFADBgMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExEjAQBgNVBAcTCVBhbG8gQXRsbzEMMAoGA1UEChMDSFBFMQwwCgYDVQQLEwNDTVMxFDASBgNVBAMTC2hwZWNvcnAubmV0MB4XDTIwMDIwOTA5MjYyMVoXDTI1MDIwNzA5MjYyMVowYDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRIwEAYDVQQHEwlQYWxvIEF0bG8xDDAKBgNVBAoTA0hQRTEMMAoGA1UECxMDQ01TMRQwEgYDVQQDEwtocGVjb3JwLm5ldDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAILdpPdjj0DB2yfApHz63CLzVxdfzzN26ZSBztxS2MP2UcbyxvLcqThv9Kao6+DKqzmnu5vUfJ4Gv0DPCRE4s70IGw5fHE3fa9Nrl8Usah4YogiD9i3T+tzaRJoa4ZpdQVIjAnHCWvo/UI76mcJ4Fssf4XYruYThwlTZFkBPijMeU0+YGGuQ6PUV4gmbNyqUKhyFby5iDuhgmjNtj9oKblibEBewAT5qu+dlAKcHdcaOa5Re0xrB85xCD+KLOWqGOyPibt/IuiLJRIhuupfvpc0ci7/WcEskc97bdBwbAqqKHPnRzROyZsKcrKFoAuOqRM8GgKx8RLAuLIen7viaYJECAwEAAaMhMB8wHQYDVR0OBBYEFOf6Ae1MFM/A3keQM0UdBM8mR1cRMA0GCSqGSIb3DQEBCwUAA4IBAQBUCC5uHyLg+sBupMlZZUfcsYEEC9U87WyCkB5HRHErwlOCw6ERt5hxZ2wuj7rK1YmVIf3EjMmv9sL4iiV38x2AjKf3FNK9ejNen+nJqKJUN3PFwGoGL4v5o2QBon0ZOh4VDu/m02oQjoVT/49WBvmBSLNvCkWszcgniiB2MGLVFAsnofCyuD0R34/tnc1ihmakEVUhY++HgOve5LfI2340AjuCtQ/06F3Xjh9DWLgF1kOw9l/BOJkECtUEkJKh6TzQOJ4izKi84dQa05SZRml9aARWgKa8BYck1YQTBsPh/IPRh5ifAFc8uP4E/VjWHMnN75MSMoHNdpCvqujnGwjHIsOk5QnVDbbP8SeNkrpnB4Cu0+A=
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-call-tracing
    namespace: ~PROJECT~
  data:
    call-tracing-provisioning.yaml: |
      ue-provisioning:
        - ue-id:
            - "imsi-0555555555"
            - "msisdn-6666666666"
          traced-service:
            - ~NAME~
          propagate-trace: true
          trace-depth: "MEDIUM"
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-log4j
    namespace: ~PROJECT~
  data:
    log4j2.xml: |
  `
  +log4j2xml+
  `
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-nnrf-registration
    namespace: ~PROJECT~
  data:
    nnrf-register.config: |
      {
      "nfInstanceId": "0590E150-4C69-4d86-A49C-990BF056F992",
      "nfType":"UDM",
      "nfStatus":"REGISTERED",
      "heartBeatTimer": "45",
      "ipv4Addresses":["127.0.0.1"],
      "plmnList":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],
      "fqdn":"localhost",
      "allowedPlmns":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],
      "allowedNfTypes": ["AMF","SMF", "NEF","GMLC"],
      "nfServices" : [ {
          "serviceInstanceId" : "UDM-UECM-HPE",
          "serviceName" : "nudm-uecm",
          "versions" : [ {
            "apiVersionInUri" : "v1",
            "apiFullVersion" : "1.0.2"
          } ],
          "scheme" : "https",
          "nfServiceStatus" : "REGISTERED",
          "fqdn":"localhost",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",
            "port" : "30044"
          } ],
            "allowedPlmns":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],
          "allowedNfTypes": ["AMF","SMF","NEF","GMLC"]
        } ]
      }
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-udr-discovery
    namespace: ~PROJECT~
  data:
    udr-disc.json: |
      [ {
      "nfInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
      "nfType" : "UDR",
      "nfStatus" : "REGISTERED",
      "plmnList" : [ {
        "mcc" : "111",
        "mnc" : "222"
      } ],
      "ipv4Addresses":["127.0.0.1"],
      "nfServicePersistence" : false,
      "nfServices" : [ {
          "serviceInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
          "serviceName" : "~nudr-dr_NAME~",
          "versions" : [ {
            "apiVersionInUri" : "v1",
            "apiFullVersion" : "1.0.0"
          } ],
          "scheme" : "https",
          "nfServiceStatus" : "REGISTERED",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",
            "port" : "5090"
          } ],
        "allowedPlmns" : [ {
          "mcc" : "208",
          "mnc" : "01"
        } ],
        "allowedNfTypes" : [ "NEF", "UDM", "PCF", "BSF" ],
        "allowedNfDomains" : [ "pfdmanagement.nnef.cms5g.hpe.com" ]
      } ]
      } ]
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nudm-uecm-nf-config.yaml: |
      #
      # Sample Network function configuration.
      #
      # HTTP/2 REST client subsystem
      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.okhttp.connector.OkhttpConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 50
          jersey.config.client.followRedirects: false
          jersey.config.client.connectTimeout: 1000
          jersey.config.client.readTimeout: 10000
        security:
          keyCertificateLocation:
          keystoreLocation:
          keystorePassword: password
          keyCertificatePKLocation:
          keyCertificateKeyPairPassword:
          keyManagerFactoryAlgorithm:
          truststoreLocation:
          trustCertificateLocation:
          truststorePassword:
          trustCertificatePKLocation:
          trustCertificateKeyPairPassword:
          trustManagerFactoryAlgorithm:
          cryptoProtocol: TLSv1.2
          passwordEncoded: false
      udm-uecm:
        hplmn.mcc: 909
        hplmn.mnc: 88
        features:
          ee-enable: false
          roamingODBDataCheck: false
          OperatorPolicyForSharedData:
            Registration: AllowedWithSharedData
          LIEnbld: false
      nnrf-client:
        server-scheme: https
        server-fqdn: nrf.server.hpecorp.net
        server-port: 8443
        server-version: v1
        nfprofile-uri: /etc/opt/hpe/nf/udm/uecm/nnrf-register.config
        enable-cache: false
        default-cache-validity-period-secs: 3600
        discover-stub-mode: false
        # json file containing remote NF profile to be discovered in stub-mode
        stub-remote-nf-profile: /etc/opt/hpe/nf/udm/uecm/udr-disc.json
      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl
          - name: fluentd
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.fluent.FluentI18nLoggerFactoryImpl
            properties:
              host: fluentd.logging
              port: 24224
      statistics-configuration:
        id: nudm-uecm-statistics
        enabled: true
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: 8086
          com.hpe.imsc.statistics.influxdb.server.protocol: http
          com.hpe.imsc.statistics.influxdb.server.database: nudm-nf
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
        jmx:
          enabled: false
      call-tracing:
        properties:
          JAEGER_SERVICE_NAME: ~NAME~
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 8090
          JAEGER_ENDPOINT: http://localhost:6831/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: false
          JAEGER_SAMPLER_TYPE: "probabilistic"
          JAEGER_SAMPLER_PARAM: 1.0
        enabled: true
        trace-all-operations: true
        trace-all-ues: false
        provisioning-uri: "file:/etc/opt/hpe/nf/udm/uecm/call-tracing-provisioning.yaml"
        max-trace-depth: MINIMUM
        max-body-length: 1200
        autorefresh-provisioning-period: 30
      caching-providers:
        - cache-managers:
          - caches: null
            classloader: '#notused'
            properties: null
            uri: paas://redis-cache-manager
          classloader: '#notused'
          properties:
            caching.provider.class.name: com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider
          uri: paas://redis-caching-provider
      # Kafka configuration
      pubsub:
        brokers:
         - 10.233.3.53:9092
        properties:
          group.id: UDMMsgConsumerGroup
          max.block.ms: 1000
        ServingSystemMsgQueue: UDMServingSystem
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-5g-nudm-uecm.yml: |
      #
      # Sample Thorntail global configuration.
      #
      swarm:
        
        https:
          only: false
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost
  
        io:
          workers:
            default:
              io-threads: 4
              task-max-threads: 32
        undertow:
          alias: localhost
          servers:
            default-server:
              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx
                  buffer-pool: 
                  http2-header-table-size: 
                  http2-initial-window-size: 
                  http2-max-concurrent-streams: 
                  http2-max-frame-size: 
                  http2-max-header-list-size:
                  max-buffered-request-size:
                  max-connections: 2000
                  max-header-size:
                  max-headers:
                  max-processing-time:
                  no-request-timeout: 
                  read-timeout:
                  receive-buffer:
                  send-buffer: 
                  ssl-session-cache-size:
                  ssl-session-timeout:
                  url-charset:
                  verify-client:
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: password
          key-stores:
            ks:
              path: /etc/opt/hpe/nf/udm/uecm/security/keystore.jks
              credential-reference:
                clear-text: password
              type: JKS
          file-audit-logs:
            local-audit:
              path: /var/opt/hpe/nf/udm/uecm/logs/audit.log
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:
            com.hpe:
              level: INFO
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{1.1.1.20.}] (%t) %s%e%n"
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: NodePort
    ports:
      - port: 8443
        protocol: TCP
        name:  https-nudm-nf
        targetPort: 30044
  selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-application-configmap-nnrf-registration
              - configMap:
                  name: ~NAME~-application-configmap-log4j
              - configMap:
                  name: ~NAME~-application-configmap-udr-discovery
              - configMap:
                  name: ~NAME~-application-configmap-call-tracing    
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret
        containers:
          - name: ~NAME~
            image: ~IMAGE_STREAM~
            imagePullPolicy: IfNotPresent
            volumeMounts:
            - name:  ~NAME~-config-volume
              mountPath: /etc/opt/hpe/nf/udm/uecm
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/nf/udm/uecm/security
            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
            ports:
              - name: health
                containerPort: 8080
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true -Dgeneric.configuration.uri=file:/etc/opt/hpe/nf/udm/uecm/nudm-uecm-nf-config.yaml
            livenessProbe:
              httpGet:
                path: /rest/probes/healthy
                port: health             
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            readinessProbe:
              httpGet:
                path: /rest/probes/healthz
                port: health              
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            resources:
              limits:
                cpu: 1000m
                memory: 2048Mi
              requests:
                cpu: 500m
                memory: 1024Mi
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;

//================================================
hpe5gResources.defaults['nudm-sdm']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data: 
    "keystore.jks": |- 
      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

- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-call-tracing
    namespace: ~PROJECT~
  data:
    call-tracing-provisioning.yaml: |
      ue-provisioning:
        - ue-id:
            - "imsi-0555555555"
            - "msisdn-6666666666"
          traced-service:
            - ~NAME~
          propagate-trace: true
          trace-depth: "MEDIUM"
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-log4j
    namespace: ~PROJECT~
  data:
    log4j2.xml: |
      <?xml version="1.0" encoding="UTF-8"?>
        
      <!-- ===================================================================== -->
      <!-- -->
      <!-- Log4j Configuration -->
      <!-- -->
      <!-- ===================================================================== -->

      <!-- | For more configuration information and examples see the Jakarta Log4j 
           | website: http://jakarta.apache.org/log4j -->

      <Configuration status="WARN">

        <!-- ============================== -->
        <!-- Append messages to the console -->
        <!-- ============================== -->
        
        <Appenders>
          <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %msg%n"/>
              <Filters>
                  <ThresholdFilter level="TRACE" onMatch="ACCEPT" />
              </Filters>
          </Console>
        </Appenders>

        <!-- ================ -->
        <!-- Limit categories -->
        <!-- ================ -->
        <Loggers>
          <Logger name="com.hpe" level="DEBUG"/>
          <Logger name="org.apache" level="WARN"/>
          <Logger name="kafka" level="WARN"/>
        
        <!-- ======================= -->
        <!-- Setup the Root category -->
        <!-- ======================= -->
        
          <Root level="INFO">
            <AppenderRef ref="Console"/>
          </Root>
        </Loggers>

      </Configuration>
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-nnrf-registration
    namespace: ~PROJECT~
  data:
    nnrf-register.config: |
      {
      "nfInstanceId": "0590E150-4C69-4d86-A49C-990BF056F991",
      "nfType":"UDM",
      "nfStatus":"REGISTERED",
      "heartBeatTimer": "45",
      "ipv4Addresses":["127.0.0.1"],
      "plmnList":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],

      "fqdn":"localhost",
      "allowedNfTypes": ["AMF","SMF"],
      "nfServices" : [ {
          "serviceInstanceId" : "UDM-SDM-HPE",
          "serviceName" : "nudm-sdm",
          "versions" : [ {
            "apiVersionInUri" : "v2",
            "apiFullVersion" : "2.0.2"
          } ],

          "scheme" : "https",

          "nfServiceStatus" : "REGISTERED",
          "fqdn":"localhost",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",

            "port" : "30043"

          } ],
          "allowedNfTypes": ["AMF","SMF"]
        } ]
      }

- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-udr-discovery
    namespace: ~PROJECT~
  data:
    udr-disc.json: |
      [ {
      "nfInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
      "nfType" : "UDR",
      "nfStatus" : "REGISTERED",
      "plmnList" : [ {
        "mcc" : "111",
        "mnc" : "222"
      } ],
      "ipv4Addresses":["127.0.0.1"],
      "nfServicePersistence" : false,
      "nfServices" : [ {
          "serviceInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
          "serviceName" : "~nudr-dr_NAME~",
          "versions" : [ {
            "apiVersionInUri" : "v1",
            "apiFullVersion" : "1.0.0"
          } ],
          "scheme" : "https",
          "nfServiceStatus" : "REGISTERED",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",
            "port" : "5090"
          } ],
        "allowedPlmns" : [ {
          "mcc" : "208",
          "mnc" : "01"
        } ],
        "allowedNfTypes" : [ "NEF", "UDM", "PCF", "BSF" ],
        "allowedNfDomains" : [ "pfdmanagement.nnef.cms5g.hpe.com" ]
      } ]
      } ]
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nudm-sdm-nf-config.yaml: |
      #
      # Sample Network function configuration.

      #
      # HTTP/2 REST client subsystem

      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.okhttp.connector.OkhttpConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 50
          jersey.config.client.followRedirects: false
          jersey.config.client.connectTimeout: 1000
          jersey.config.client.readTimeout: 10000

        security:
          keyCertificateLocation:
          keystoreLocation:
          keystorePassword: password
          keyCertificatePKLocation:
          keyCertificateKeyPairPassword:
          keyManagerFactoryAlgorithm:
          truststoreLocation:
          trustCertificateLocation:
          truststorePassword:
          trustCertificatePKLocation:
          trustCertificateKeyPairPassword:
          trustManagerFactoryAlgorithm:
          cryptoProtocol: TLSv1.2
          passwordEncoded: false

      nudm-sdm:
        hplmn.mcc: 909
        hplmn.mnc: 88
        features:
          UDR-Support-Multi-data-set: true
          OperatorPolicyForSharedData: SendSubscriptionDataWithSharedData
          SubsToNotifyCallbackUri: https://localhost.com:8080/nudm-notify/v1/notify/sendNotification
          SdmSubscribeInUdr: true
          AMFRegMonitorInUDR: true
          ODBMonitorInUDR: false
          MultipleHplmnEnabled: false


      nnrf-client:
        server-scheme: https
        server-fqdn: nrf.server.hpecorp.net
        server-port: 8443
        server-version: v1
        nfprofile-uri: /etc/opt/hpe/nf/udm/sdm/nnrf-register.config
        enable-cache: false
        default-cache-validity-period-secs: 3600
        discover-stub-mode: false
        # json file containing remote NF profile to be discovered in stub-mode
        stub-remote-nf-profile: /etc/opt/hpe/nf/udm/sdm/udr-disc.json


      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl


          - name: fluentd
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.fluent.FluentI18nLoggerFactoryImpl
            properties:
              host: fluentd.logging
              port: 24224

      statistics-configuration:
        id: nudm-sdm-statistics
        enabled: true
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: 8086
          com.hpe.imsc.statistics.influxdb.server.protocol: http
          com.hpe.imsc.statistics.influxdb.server.database: nudm-nf
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
        jmx:
          enabled: false
      call-tracing:
        properties:
          JAEGER_SERVICE_NAME: ~NAME~
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 8090
          JAEGER_ENDPOINT: http://localhost:6831/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: false
          JAEGER_SAMPLER_TYPE: "probabilistic"
          JAEGER_SAMPLER_PARAM: 1.0
        enabled: true
        trace-all-operations: true
        trace-all-ues: false
        provisioning-uri: file:/etc/opt/hpe/nf/udm/sdm/call-tracing-provisioning.yaml
        max-trace-depth: MINIMUM
        max-body-length: 1200
        autorefresh-provisioning-period: 30

      caching-providers:

        - cache-managers:
          - caches: null
            classloader: '#notused'
            properties: null
            uri: paas://redis-cache-manager
          classloader: '#notused'
          properties:
            caching.provider.class.name: com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider
          uri: paas://redis-caching-provider
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-5g-nudm-sdm.yml: |
      #
      # Sample Thorntail global configuration.
      #
      swarm:
        
        https:
          only: false
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost

        io:
          workers:
            default:
              io-threads: 4
              task-max-threads: 32
        undertow:
          alias: localhost
          servers:
            default-server:

              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx

                  buffer-pool: 
                  http2-header-table-size: 
                  http2-initial-window-size: 
                  http2-max-concurrent-streams:  
                  http2-max-frame-size: 
                  http2-max-header-list-size:
                  max-buffered-request-size:
                  max-connections: 2000
                  max-header-size:
                  max-headers:
                  max-processing-time:
                  no-request-timeout: 
                  read-timeout:
                  receive-buffer:
                  send-buffer: 
                  ssl-session-cache-size:
                  ssl-session-timeout:
                  url-charset:
                  verify-client:
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: password
          key-stores:
            ks:
              path: /etc/opt/hpe/nf/udm/sdm/security/keystore.jks
              credential-reference:
                clear-text: password
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:

            com.hpe:
              level: INFO
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{1.1.1.20.}] (%t) %s%e%n"
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    labels:
      name: ~NAME~
      deploymentconfig: ~NAME~
  spec:
    type: LoadBalancer
    ports:
      - port: 8443
        protocol: TCP
        name:  https-nudm-nf
        targetPort: 30043
    selector:
        name: ~NAME~
        deploymentconfig: ~NAME~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels:
          app.kubernetes.io/name: ~NAME~
          app.kubernetes.io/instance: ~PROJECT~
      spec:
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-application-configmap-nnrf-registration
              - configMap:
                  name: ~NAME~-application-configmap-log4j
              - configMap:
                  name: ~NAME~-application-configmap-udr-discovery
              - configMap:
                  name: ~NAME~-application-configmap-call-tracing    
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret

        containers:
          - name: ~NAME~
            namespace: ~PROJECT~
            image: ~IMAGE_STREAM~

            volumeMounts:
            - name:  ~NAME~-config-volume
              mountPath: /etc/opt/hpe/nf/udm/sdm
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/nf/udm/sdm/security

            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
            ports:
              - name: health
                
                containerPort: 8080
               
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true   -Dgeneric.configuration.uri=file:/etc/opt/hpe/nf/udm/sdm/nudm-sdm-nf-config.yaml
            livenessProbe:
              httpGet:
                path: /rest/probes/healthy
                port: health
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            readinessProbe:
              httpGet:
                path: /rest/probes/healthz
                port: health
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            resources:
              limits:
                cpu: 1000m
                memory: 2048Mi
              requests:
                cpu: 500m
                memory: 1024Mi
`;

//================================================
hpe5gResources.defaults['nudm-notify']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~-secret
    namespace: ~PROJECT~
  type: Opaque
  data: 
    "keystore.jks": |- 
      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

- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-call-tracing
    namespace: ~PROJECT~
  data:
    call-tracing-provisioning.yaml: |
      ue-provisioning:
        - ue-id:
            - "imsi-0555555555"
            - "msisdn-6666666666"
          traced-service:
            - ~NAME~
          propagate-trace: true
          trace-depth: "MEDIUM"

- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-log4j
    namespace: ~PROJECT~
  data:
    log4j2.xml: |
      <?xml version="1.0" encoding="UTF-8"?>
        
      <!-- ===================================================================== -->
      <!-- -->
      <!-- Log4j Configuration -->
      <!-- -->
      <!-- ===================================================================== -->

      <!-- | For more configuration information and examples see the Jakarta Log4j 
           | website: http://jakarta.apache.org/log4j -->

      <Configuration status="WARN">

        <!-- ============================== -->
        <!-- Append messages to the console -->
        <!-- ============================== -->
        
        <Appenders>
          <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %msg%n"/>
              <Filters>
                  <ThresholdFilter level="TRACE" onMatch="ACCEPT" />
              </Filters>
          </Console>
        </Appenders>

        <!-- ================ -->
        <!-- Limit categories -->
        <!-- ================ -->
        <Loggers>
          <Logger name="com.hpe" level="DEBUG"/>
          <Logger name="org.apache" level="WARN"/>
          <Logger name="kafka" level="WARN"/>
        
        <!-- ======================= -->
        <!-- Setup the Root category -->
        <!-- ======================= -->
        
          <Root level="INFO">
            <AppenderRef ref="Console"/>
          </Root>
        </Loggers>

      </Configuration>
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-nnrf-registration
    namespace: ~PROJECT~
  data:
    nnrf-register.config: |
      {
      "nfInstanceId": "0590E150-4C69-4d86-A49C-990BF056F995",
      "nfType":"UDM",
      "nfStatus":"REGISTERED",
      "heartBeatTimer": "45",
      "ipv4Addresses":["127.0.0.1"],
      "plmnList":[{"mcc":111,"mnc":222}, {"mcc":111,"mnc":333}],

      "fqdn":"localhost",
      "allowedNfTypes": ["AMF","SMF"],
      "nfServices" : [ {
          "serviceInstanceId" : "UDM-NOTIFY-HPE",
          "serviceName" : "~NAME~",
          "versions" : [ {
            "apiVersionInUri" : "v2",
            "apiFullVersion" : "2.0.2"
          } ],

          "scheme" : "https",

          "nfServiceStatus" : "REGISTERED",
          "fqdn":"localhost",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",

            "port" : "30047"

          } ],
          "allowedNfTypes": ["AMF","SMF"]
        } ]
      }

- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap-udr-discovery
    namespace: ~PROJECT~
  data:
    udr-disc.json: |
      [ {
      "nfInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
      "nfType" : "UDR",
      "nfStatus" : "REGISTERED",
      "plmnList" : [ {
        "mcc" : "111",
        "mnc" : "222"
      } ],
      "ipv4Addresses":["127.0.0.1"],
      "nfServicePersistence" : false,
      "nfServices" : [ {
          "serviceInstanceId" : "57fc19a1-b366-477a-8c2b-080044e680b5",
          "serviceName" : "~nudr-dr_NAME~",
          "versions" : [ {
            "apiVersionInUri" : "v1",
            "apiFullVersion" : "1.0.0"
          } ],
          "scheme" : "https",
          "nfServiceStatus" : "REGISTERED",
          "ipEndPoints" : [ {
            "ipv4Address" : "127.0.0.1",
            "transport" : "TCP",
            "port" : "5090"
          } ],
        "allowedPlmns" : [ {
          "mcc" : "208",
          "mnc" : "01"
        } ],
        "allowedNfTypes" : [ "NEF", "UDM", "PCF", "BSF" ],
        "allowedNfDomains" : [ "pfdmanagement.nnef.cms5g.hpe.com" ]
      } ]
      } ]
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-application-configmap
    namespace: ~PROJECT~
  data:
    nudm-notify-nf-config.yaml: |
      #
      # Sample Network function configuration.

      #
      # HTTP/2 REST client subsystem

      rest-client:
        connector-provider: com.hpe.paas.middleware.jersey.okhttp.connector.OkhttpConnectorProvider
        properties:
          jersey.config.client.async.threadPoolSize: 50
          jersey.config.client.followRedirects: false
          jersey.config.client.connectTimeout: 1000
          jersey.config.client.readTimeout: 10000

        security:
          keyCertificateLocation:
          keystoreLocation:
          keystorePassword: password
          keyCertificatePKLocation:
          keyCertificateKeyPairPassword:
          keyManagerFactoryAlgorithm:
          truststoreLocation:
          trustCertificateLocation:
          truststorePassword:
          trustCertificatePKLocation:
          trustCertificateKeyPairPassword:
          trustManagerFactoryAlgorithm:
          cryptoProtocol: TLSv1.2
          passwordEncoded: false

      nudm-notify:
        hplmn.mcc: 909
        hplmn.mnc: 88
        features:
          NotifyThreadPoolSize: 50
          OperatorPolicyForSharedData: SendSubscriptionDataWithSharedData
          SubsToNotifyCallbackUri: https://localhost.com:8080/nudm-notify/v1/notify/sendNotification
          SdmSubscribeInUdr: true
          AMFRegMonitorInUDR: true
          ODBMonitorInUDR: false
          MultipleHplmnEnabled: false


      nnrf-client:
        server-scheme: https
        server-fqdn: nrf.server.hpecorp.net
        server-port: 8443
        server-version: v1
        nfprofile-uri: /etc/opt/hpe/nf/udm/notify/nnrf-register.config
        enable-cache: false
        default-cache-validity-period-secs: 3600
        discover-stub-mode: false
        # json file containing remote NF profile to be discovered in stub-mode
        stub-remote-nf-profile: /etc/opt/hpe/nf/udm/notify/udr-disc.json


      logging:
        locale: en-US
        loggers:
          - name: log4j2
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.log4j.Log4j2I18nLoggerFactoryImpl


          - name: fluentd
            factory-class: com.hpe.paas.middleware.sdk.impl.logging.fluent.FluentI18nLoggerFactoryImpl
            properties:
              host: fluentd.logging
              port: 24224

      statistics-configuration:
        id: nudm-notify-statistics
        enabled: true
        jvm-metrics: true
        properties:
          com.hpe.imsc.statistics.influxdb.server.host: ~influxdb_NAME~.~PROJECT~.svc.cluster.local
          com.hpe.imsc.statistics.influxdb.server.port: 8086
          com.hpe.imsc.statistics.influxdb.server.protocol: http
          com.hpe.imsc.statistics.influxdb.server.database: nudm-nf
          com.hpe.imsc.statistics.influxdb.server.polling.interval: 10
        jmx:
          enabled: false
      call-tracing:
        properties:
          JAEGER_SERVICE_NAME: ~NAME~
          JAEGER_AGENT_HOST: localhost
          JAEGER_AGENT_PORT: 8090
          JAEGER_ENDPOINT: http://localhost:6831/api/traces
          JAEGER_REPORTER_FLUSH_INTERVAL: 100
          JAEGER_REPORTER_LOG_SPANS: false
          JAEGER_SAMPLER_TYPE: "probabilistic"
          JAEGER_SAMPLER_PARAM: 1.0
        enabled: true
        trace-all-operations: true
        trace-all-ues: false
        provisioning-uri: file:/etc/opt/hpe/nf/udm/notify/call-tracing-provisioning.yaml
        max-trace-depth: MINIMUM
        max-body-length: 1200
        autorefresh-provisioning-period: 30

      caching-providers:

        - cache-managers:
          - caches: null
            classloader: '#notused'
            properties: null
            uri: paas://redis-cache-manager
          classloader: '#notused'
          properties:
            caching.provider.class.name: com.hpe.paas.middleware.sdk.impl.cache.redis.RedisCachingProvider
          uri: paas://redis-caching-provider
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~-swarm-configmap
    namespace: ~PROJECT~
  data:
    project-5g-nudm-notify.yml: |
      #
      # Sample Thorntail global configuration.
      #
      swarm:
        
        https:
          only: false
          port: 8443
          keystore:
            embedded: true
          certificate:
            generate: true
            host: localhost

        io:
          workers:
            default:
              io-threads: 4
              task-max-threads: 32
        undertow:
          alias: localhost
          servers:
            default-server:

              https-listeners:
                default-https:
                  socket-binding: https
                  enable-http2: true
                  ssl-context: sslctx

                  buffer-pool: 
                  http2-header-table-size: 
                  http2-initial-window-size: 
                  http2-max-concurrent-streams:  
                  http2-max-frame-size: 
                  http2-max-header-list-size:
                  max-buffered-request-size:
                  max-connections: 2000
                  max-header-size:
                  max-headers:
                  max-processing-time:
                  no-request-timeout: 
                  read-timeout:
                  receive-buffer:
                  send-buffer: 
                  ssl-session-cache-size:
                  ssl-session-timeout:
                  url-charset:
                  verify-client:
        elytron:
          server-ssl-contexts:
            sslctx:
              protocols: TLSv1.2
              key-manager: km
          key-managers:
            km:
              key-store: ks
              credential-reference:
                clear-text: password
          key-stores:
            ks:
              path: /etc/opt/hpe/nf/udm/notify/security/keystore.jks
              credential-reference:
                clear-text: password
              type: JKS
        logging:
          root-logger:
            level: INFO
            handlers:
            - CONSOLE
          loggers:

            com.hpe:
              level: INFO
            io.netty:
              level: INFO
            io.undertow:
              level: INFO
            okhttp3:
              level: INFO
            org.jboss.as:
              level: INFO
            org.wildfly:
              level: INFO
            stdout:
              handlers:
              - STDOUT
              level: INFO
          console-handlers:
            STDOUT:
              named-formatter: null
              formatter: "%s%e%n"
            CONSOLE:
              named-formatter: null
              formatter: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{1.1.1.20.}] (%t) %s%e%n"
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    labels:
      name: ~NAME~
      deploymentconfig: ~NAME~
  spec:
    type: LoadBalancer
    ports:
      - port: 8443
        protocol: TCP
        name:  https-nudm-nf
        targetPort: 30047
    selector:
        name: ~NAME~
        deploymentconfig: ~NAME~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    replicas: ~REPLICAS~
    template:
      metadata:
        labels:
          app.kubernetes.io/name: ~NAME~
          app.kubernetes.io/instance: ~PROJECT~
      spec:
        volumes:
          - name: ~NAME~-config-volume
            projected:
              sources:
              - configMap:
                  name: ~NAME~-swarm-configmap
              - configMap:
                  name: ~NAME~-application-configmap
              - configMap:
                  name: ~NAME~-application-configmap-nnrf-registration
              - configMap:
                  name: ~NAME~-application-configmap-log4j
              - configMap:
                  name: ~NAME~-application-configmap-udr-discovery
              - configMap:
                  name: ~NAME~-application-configmap-call-tracing    
          - name: ~NAME~-secrets-volume
            projected:
              sources:
              - secret:
                  name: ~NAME~-secret

        containers:
          - name: ~NAME~
            namespace: ~PROJECT~
            image: ~IMAGE_STREAM~

            volumeMounts:
            - name:  ~NAME~-config-volume
              mountPath: /etc/opt/hpe/nf/udm/sdm
            - name:  ~NAME~-secrets-volume
              mountPath: /etc/opt/hpe/nf/udm/sdm/security

            ports:
              - name: https
                containerPort: 8443
                protocol: TCP
            ports:
              - name: health
                
                containerPort: 8080
               
                protocol: TCP
            env:
              - name: JAVA_OPTS
                value:  -Xms512m -Xmx512m -Djava.net.preferIPv4Stack=true   -Dgeneric.configuration.uri=file:/etc/opt/hpe/nf/udm/sdm/nudm-notify-nf-config.yaml
            livenessProbe:
              httpGet:
                path: /rest/probes/healthy
                port: health
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            readinessProbe:
              httpGet:
                path: /rest/probes/healthz
                port: health
              initialDelaySeconds: 100
              periodSeconds: 10
              timeoutSeconds: 10
            resources:
              limits:
                cpu: 1000m
                memory: 2048Mi
              requests:
                cpu: 500m
                memory: 1024Mi
`;

//================================================
hpe5gResources.defaults['ignite']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
~PERSISTENCE_START~
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~-work
  spec:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: ~STORAGE~
    ~VOLUME~
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~-wal
  spec:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: ~STORAGE~
    ~VOLUME~
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~-walarchive
  spec:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: ~STORAGE~
    ~VOLUME~
~PERSISTENCE_END~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        serviceAccountName: ~NAME~
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          image: ~IMAGE_STREAM~
          env:
          - name: OPTION_LIBS
            value: ignite-kubernetes,ignite-rest-http
          - name: CONFIG_URI
            value: file:/etc/opt/hpe-5g/ignite/igniteConfig.xml
~PERSISTENCE_START~
          - name: JVM_OPTS
            value: "-DIGNITE_WAL_MMAP=false"
~PERSISTENCE_END~
          ports:
          # Ports to open.
          # Might be optional depending on your Kubernetes environment.
          - containerPort: 11211 # REST port number.
          - containerPort: 47100 # communication SPI port number.
          - containerPort: 47500 # discovery SPI port number.
          - containerPort: 49112 # JMX port number.
          - containerPort: 10800 # SQL port number.
          - containerPort: 10900 # Thin clients port number.
          volumeMounts:
            - name: ~NAME~
              namespace: ~PROJECT~
              mountPath: /etc/opt/hpe-5g/ignite/
~PERSISTENCE_START~
            - mountPath: /gridgain/work
              name: ~NAME~-work
            - mountPath: /gridgain/wal
              name: ~NAME~-wal
            - mountPath: /gridgain/walarchive
              name: ~NAME~-walarchive
~PERSISTENCE_END~
        volumes:
          - name: ~NAME~
            namespace: ~PROJECT~
            configMap:
              name: ~NAME~
~PERSISTENCE_START~
          - name: ~NAME~-work
            persistentVolumeClaim:
              claimName: ~NAME~-work
          - name: ~NAME~-wal
            persistentVolumeClaim:
              claimName: ~NAME~-wal
          - name: ~NAME~-walarchive
            persistentVolumeClaim:
              claimName: ~NAME~-walarchive
~PERSISTENCE_END~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: LoadBalancer
    ports:
      - name: rest
        port: 8080
        targetPort: 8080
      - name: sql
        port: 10800
        targetPort: 10800
      - name: thinclients
        port: 10900
        targetPort: 10900
    # Optional - remove 'sessionAffinity' property if the Ignite cluster
    # and applications deployed within Kubernetes
    sessionAffinity: ClientIP   
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    igniteConfig.xml: |+
      <beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation=" http://www.springframework.org/schema/beans  http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">
       <bean id="ignite.cfg" class="org.apache.ignite.configuration.IgniteConfiguration">
~PERSISTENCE_START~
       <property name="workDirectory" value="/gridgain/work"/>
           <property name="dataStorageConfiguration">
               <bean class="org.apache.ignite.configuration.DataStorageConfiguration">
                   <property name="defaultDataRegionConfiguration">
                       <bean class="org.apache.ignite.configuration.DataRegionConfiguration">
                           <property name="persistenceEnabled" value="true"/>
                       </bean>
                   </property>
                   <property name="walPath" value="/gridgain/wal"/>
                   <property name="walArchivePath" value="/gridgain/walarchive"/>
               </bean>
           </property>
~PERSISTENCE_END~
         <property name="discoverySpi">
            <bean class="org.apache.ignite.spi.discovery.tcp.TcpDiscoverySpi">
              <property name="ipFinder">
                 <bean class="org.apache.ignite.spi.discovery.tcp.ipfinder.kubernetes.TcpDiscoveryKubernetesIpFinder">
                 <property name="namespace" value="~PROJECT~"/>
                 <property name="serviceName" value="~NAME~"/>
                 <property name="masterUrl" value="https://#{systemEnvironment['KUBERNETES_SERVICE_HOST']}:443"/>
                 </bean>
              </property>
            </bean>
         </property>
        </bean>
       </beans>
`;
//================================================
hpe5gResources.defaults['redis']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  name: ~NAME~
  stringData:
    database-password: ~NAME~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    ports:
    - name: redis
      nodePort: 0
      port: 6379
      protocol: TCP
      targetPort: 6379
    selector:
      name: ~NAME~
      deploymentconfig: ~NAME~
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~
  spec:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: ~STORAGE~
    ~VOLUME~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    annotations:
      template.alpha.openshift.io/wait-for-ready: 'true'
    name: ~NAME~
  spec:
    replicas: ~REPLICAS~
    selector:
      name: ~NAME~
    strategy:
      type: Recreate
    template:
      metadata:
        labels:
          name: ~NAME~
      spec:
        containers:
        - capabilities: {}
          env:
          - name: REDIS_PORT
            value: "6379"
          - name: REDIS_PASSWORD
            valueFrom:
              secretKeyRef:
                key: database-password
                name: ~NAME~
          image: ~IMAGE_STREAM~
          livenessProbe:
            initialDelaySeconds: 30
            tcpSocket:
              port: 6379
            timeoutSeconds: 1
          name: redis
          ports:
          - containerPort: 6379
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - "/bin/bash"
              - "-i"
              - "-c"
              - "test \\\"$(redis-cli -h 127.0.0.1 -a ~NAME~ ping)\\\" == \\"PONG\\\""
            initialDelaySeconds: 5
            timeoutSeconds: 1
          resources:
            limits:
              memory: ~STORAGE~
          securityContext:
            capabilities: {}
            privileged: false
          terminationMessagePath: "/dev/termination-log"
          volumeMounts:
          - mountPath: "/var/lib/redis/data"
            name: "~NAME~-data"
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        volumes:
        - name: "~NAME~-data"
          persistentVolumeClaim:
            claimName: ~NAME~
  status: {}
`;
//================================================
hpe5gResources.defaults['influxdb']['template']=
//================================================
`
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  name: ~NAME~
  stringData:
    admin-user-password: ~NAME~
  type: Opaque
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~
  spec:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: ~STORAGE~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: ClusterIP
    ports:
      - port: 8086
        targetPort: http
        protocol: TCP
        name: http
        nodePort: null
      - port: 8088
        targetPort: rpc
        protocol: TCP
        name: rpc
        nodePort: null
    selector:
        name: ~NAME~
        deploymentconfig: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    annotations:
      template.alpha.openshift.io/wait-for-ready: 'true'
    name: ~NAME~
  spec:
    replicas: ~REPLICAS~
    selector:
        name: ~NAME~
    template:
      metadata:
        labels:
          name: ~NAME~
      spec:
        containers:
          - name: ~NAME~
            image: ~IMAGE_STREAM~
            imagePullPolicy: IfNotPresent
            env:
              - name: BITNAMI_DEBUG
                value: "false"
              - name: POD_IP
                valueFrom:
                  fieldRef:
                    fieldPath: status.podIP
              - name: INFLUXDB_HTTP_AUTH_ENABLED
                value: "false"
              - name: INFLUXDB_ADMIN_USER
                value: "admin"
              - name: INFLUXDB_ADMIN_USER_PASSWORD
                valueFrom:
                  secretKeyRef:
                    name: ~NAME~
                    key: admin-user-password
              - name: INFLUXDB_DB
                value: ~NAME~
            ports:
              - name: http
                containerPort: 8086
                protocol: TCP
              - name: rpc
                containerPort: 8088
                protocol: TCP
            livenessProbe:
              exec:
                command:
                  - "/bin/bash"
                  - "-i"
                  - "-c"
                  - "INFLUX_USERNAME=\\\"$INFLUXDB_ADMIN_USER\\\" INFLUX_PASSWORD=\\\"$INFLUXDB_ADMIN_USER_PASSWORD\\\" timeout 29s influx -host $POD_IP -port 8086 -execute \\\"SHOW DATABASES\\\" "
              initialDelaySeconds: 180
              periodSeconds: 45
              timeoutSeconds: 30
              successThreshold: 1
              failureThreshold: 6
            readinessProbe:
              exec:
                command:
                  - "/bin/bash"
                  - "-i"
                  - "-c"
                  - "INFLUX_USERNAME=\\\"$INFLUXDB_ADMIN_USER\\\" INFLUX_PASSWORD=\\\"$INFLUXDB_ADMIN_USER_PASSWORD\\\" timeout 29s influx -host $POD_IP -port 8086 -execute \\\"SHOW DATABASES\\\" "
              initialDelaySeconds: 60
              periodSeconds: 45
              timeoutSeconds: 30
              successThreshold: 1
              failureThreshold: 6
            resources:
              limits: {}
              requests: {}
            volumeMounts:
              - name: data
                mountPath: /bitnami/influxdb
        volumes:
          - name: data
            persistentVolumeClaim:
              claimName: ~NAME~
`;
//================================================
hpe5gResources.defaults['jenkins']['template']=
//================================================
`
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: Route
  apiVersion: v1
  metadata:
    annotations:
      haproxy.router.openshift.io/timeout: 4m
      template.openshift.io/expose-uri: http://{.spec.host}{.spec.path}
    name: ~NAME~
  spec:
    tls:
      insecureEdgeTerminationPolicy: Redirect
      termination: edge
    to:
      kind: Service
      name: ~NAME~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    annotations:
      template.alpha.openshift.io/wait-for-ready: "true"
    name: ~NAME~
  spec:
    replicas: 1
    selector:
      name: ~NAME~
    strategy:
      type: Recreate
    template:
      metadata:
        labels:
          name: ~NAME~
      spec:
        containers:
        - capabilities: {}
          env:
          - name: OPENSHIFT_ENABLE_OAUTH
            value: "true"
          - name: OPENSHIFT_ENABLE_REDIRECT_PROMPT
            value: "true"
          - name: KUBERNETES_MASTER
            value: https://kubernetes.default:443
          - name: KUBERNETES_TRUST_CERTIFICATES
            value: "true"
          - name: JENKINS_SERVICE_NAME
            value: ~NAME~
          - name: JNLP_SERVICE_NAME
            value: ~NAME~-jnlp
          image: ~IMAGE_STREAM~
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 2
            httpGet:
              path: /login
              port: 8080
            initialDelaySeconds: 420
            periodSeconds: 360
            timeoutSeconds: 240
          name: jenkins
          readinessProbe:
            httpGet:
              path: /login
              port: 8080
            initialDelaySeconds: 3
            timeoutSeconds: 240
          resources:
            limits:
              memory: 2048Mi
          securityContext:
            capabilities: {}
            privileged: false
          terminationMessagePath: /dev/termination-log
          volumeMounts:
          - mountPath: /var/lib/jenkins
            name: ~NAME~-data
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        serviceAccountName: ~NAME~
        volumes:
        - emptyDir:
            medium: ""
          name: ~NAME~-data
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    annotations:
      serviceaccounts.openshift.io/oauth-redirectreference.jenkins: '{"kind":"OAuthRedirectReference","apiVersion":"v1","reference":{"kind":"Route","name":"~NAME~"}}'
    name: ~NAME~
- apiVersion: v1
  groupNames: null
  kind: RoleBinding
  metadata:
    name: ~NAME~_edit
  roleRef:
    name: edit
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~-jnlp
  spec:
    ports:
    - name: agent
      nodePort: 0
      port: 50000
      protocol: TCP
      targetPort: 50000
    selector:
      name: ~NAME~
    sessionAffinity: None
    type: ClusterIP
- kind: Service
  apiVersion: v1
  metadata:
    annotations:
      service.alpha.openshift.io/dependencies: '[{"name": "~NAME~-jnlp", "namespace": "", "kind": "Service"}]'
      service.openshift.io/infrastructure: "true"
    name: ~NAME~
  spec:
    ports:
    - name: web
      nodePort: 0
      port: 80
      protocol: TCP
      targetPort: 8080
    selector:
      name: ~NAME~
    sessionAffinity: None
    type: ClusterIP
`;
//================================================
hpe5gResources.defaults['elasticsearch']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source        
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~
  spec:
    accessModes:
    - ReadWriteOnce 
    resources:
       requests:
         storage: ~STORAGE~
    ~VOLUME~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        serviceAccountName: ~NAME~
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          image: ~IMAGE_STREAM~
          readinessProbe:
            httpGet:
              path: /_cluster/health
              port: 9200
            initialDelaySeconds: 5
          livenessProbe:
            httpGet:
              path: /_cluster/health?local=true
              port: 9200
            initialDelaySeconds: 90
          env:
            - name: NODE_DATA
              value: 'false'
            - name: NODE_MASTER
              value: 'false'
            - name: DISCOVERY_SERVICE
              value: elasticsearch-discovery
            - name: PROCESSORS
              valueFrom:
                resourceFieldRef:
                  divisor: '0'
                  resource: limits.cpu
            - name: ES_JAVA_OPTS
              value: "-Djava.net.preferIPv4Stack=true -Xms512m -Xmx512m  "
            - name: MINIMUM_MASTER_NODES
              value: '2'
            - name: TAKE_FILE_OWNERSHIP
              value: 'true'
          volumeMounts:
            - mountPath: /usr/share/elasticsearch/data/
              name: ~NAME~
        volumes:
          - name: ~NAME~
            namespace: ~PROJECT~
            persistentVolumeClaim:
              claimName: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: LoadBalancer
    ports:
      - name: rest
        port: 8080
        targetPort: 8080
      - name: sql
        port: 10800
        targetPort: 10800
      - name: thinclients
        port: 10900
        targetPort: 10900
    # Optional - remove 'sessionAffinity' property if the Ignite cluster
    # and applications deployed within Kubernetes
    sessionAffinity: ClientIP   
    selector:
      name: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['prometheus-alertmanager']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source        
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~
  spec:
    accessModes:
    - ReadWriteOnce 
    resources:
       requests:
         storage: ~STORAGE~
    ~VOLUME~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        serviceAccountName: ~NAME~
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          image: ~IMAGE_STREAM~
          env:
            - name: POD_IP
              valueFrom:
                fieldRef:
                  apiVersion: v1
                  fieldPath: status.podIP
          args:
            - --config.file=/etc/config/alertmanager.yml
            - --storage.path=/data
            - --cluster.advertise-address=$(POD_IP):6783
            - --web.external-url=http://localhost:9093
          ports:
            - containerPort: 9093
          readinessProbe:
            httpGet:
              path: /-/ready
              port: 9093
            initialDelaySeconds: 30
            timeoutSeconds: 30
          resources:
            {}
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
            - name: storage-volume
              mountPath: "/data"
        volumes:
          - name: config-volume
            configMap:
              name: ~NAME~
          - name: storage-volume
            namespace: ~PROJECT~
            persistentVolumeClaim:
              claimName: ~NAME~
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    ports:
      - name: http
        port: 80
        protocol: TCP
        targetPort: 9093
    selector:
      name: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    alertmanager.yml: |
      global: {}
      receivers:
      - name: default-receiver
      route:
        group_interval: 5m
        group_wait: 10s
        receiver: default-receiver
        repeat_interval: 3h
`;
//================================================
hpe5gResources.defaults['prometheus']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source        
- kind: PersistentVolumeClaim
  apiVersion: v1
  metadata:
    name: ~NAME~
  spec:
    accessModes:
    - ReadWriteOnce 
    resources:
       requests:
         storage: ~STORAGE~
    ~VOLUME~
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        serviceAccountName: ~NAME~
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          image: ~IMAGE_STREAM~
          args:
            - --storage.tsdb.retention.time=15d
            - --config.file=/etc/config/prometheus.yml
            - --storage.tsdb.path=/data
            - --web.console.libraries=/etc/prometheus/console_libraries
            - --web.console.templates=/etc/prometheus/consoles
            - --web.enable-lifecycle
          ports:
            - containerPort: 9090
          readinessProbe:
            httpGet:
              path: /-/ready
              port: 9090
            initialDelaySeconds: 30
            timeoutSeconds: 30
            failureThreshold: 3
            successThreshold: 1
          livenessProbe:
            httpGet:
              path: /-/healthy
              port: 9090
            initialDelaySeconds: 30
            timeoutSeconds: 30
            failureThreshold: 3
            successThreshold: 1
          resources:
            {}
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
            - mountPath: /data
              name: storage-volume
        volumes:
          - name: config-volume
            configMap:
              name: ~NAME~
          - name: storage-volume
            namespace: ~PROJECT~
            persistentVolumeClaim:
              claimName: ~NAME~
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    ports:
      - name: http
        port: 80
        protocol: TCP
        targetPort: 9090
    selector:
      name: ~NAME~
    sessionAffinity: None
    type: "ClusterIP"
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    alerting_rules.yml: |
      {}
    alerts: |
      {}
    prometheus.yml: |
      global:
        evaluation_interval: 1m
        scrape_interval: 1m
        scrape_timeout: 10s
      rule_files:
      - /etc/config/recording_rules.yml
      - /etc/config/alerting_rules.yml
      - /etc/config/rules
      - /etc/config/alerts
      scrape_configs:
      - job_name: prometheus
        static_configs:
        - targets:
          - localhost:9090
      - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
        job_name: kubernetes-apiservers
        kubernetes_sd_configs:
        - role: endpoints
        relabel_configs:
        - action: keep
          regex: default;kubernetes;https
          source_labels:
          - __meta_kubernetes_namespace
          - __meta_kubernetes_service_name
          - __meta_kubernetes_endpoint_port_name
        scheme: https
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          insecure_skip_verify: true
      - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
        job_name: kubernetes-nodes
        kubernetes_sd_configs:
        - role: node
        relabel_configs:
        - action: labelmap
          regex: __meta_kubernetes_node_label_(.+)
        - replacement: kubernetes.default.svc:443
          target_label: __address__
        - regex: (.+)
          replacement: /api/v1/nodes/$1/proxy/metrics
          source_labels:
          - __meta_kubernetes_node_name
          target_label: __metrics_path__
        scheme: https
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          insecure_skip_verify: true
      - bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
        job_name: kubernetes-nodes-cadvisor
        kubernetes_sd_configs:
        - role: node
        relabel_configs:
        - action: labelmap
          regex: __meta_kubernetes_node_label_(.+)
        - replacement: kubernetes.default.svc:443
          target_label: __address__
        - regex: (.+)
          replacement: /api/v1/nodes/$1/proxy/metrics/cadvisor
          source_labels:
          - __meta_kubernetes_node_name
          target_label: __metrics_path__
        scheme: https
        tls_config:
          ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          insecure_skip_verify: true
      - job_name: kubernetes-service-endpoints
        kubernetes_sd_configs:
        - role: endpoints
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scrape
        - action: replace
          regex: (https?)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scheme
          target_label: __scheme__
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_service_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: kubernetes_namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_service_name
          target_label: kubernetes_name
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_node_name
          target_label: kubernetes_node
      - job_name: kubernetes-service-endpoints-slow
        kubernetes_sd_configs:
        - role: endpoints
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scrape_slow
        - action: replace
          regex: (https?)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_scheme
          target_label: __scheme__
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_service_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: kubernetes_namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_service_name
          target_label: kubernetes_name
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_node_name
          target_label: kubernetes_node
        scrape_interval: 5m
        scrape_timeout: 30s
      - honor_labels: true
        job_name: prometheus-pushgateway
        kubernetes_sd_configs:
        - role: service
        relabel_configs:
        - action: keep
          regex: pushgateway
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_probe
      - job_name: kubernetes-services
        kubernetes_sd_configs:
        - role: service
        metrics_path: /probe
        params:
          module:
          - http_2xx
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_service_annotation_prometheus_io_probe
        - source_labels:
          - __address__
          target_label: __param_target
        - replacement: blackbox
          target_label: __address__
        - source_labels:
          - __param_target
          target_label: instance
        - action: labelmap
          regex: __meta_kubernetes_service_label_(.+)
        - source_labels:
          - __meta_kubernetes_namespace
          target_label: kubernetes_namespace
        - source_labels:
          - __meta_kubernetes_service_name
          target_label: kubernetes_name
      - job_name: kubernetes-pods
        kubernetes_sd_configs:
        - role: pod
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_scrape
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_pod_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_pod_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: kubernetes_namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_name
          target_label: kubernetes_pod_name
      - job_name: kubernetes-pods-slow
        kubernetes_sd_configs:
        - role: pod
        relabel_configs:
        - action: keep
          regex: true
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_scrape_slow
        - action: replace
          regex: (.+)
          source_labels:
          - __meta_kubernetes_pod_annotation_prometheus_io_path
          target_label: __metrics_path__
        - action: replace
          regex: ([^:]+)(?::\d+)?;(\d+)
          replacement: $1:$2
          source_labels:
          - __address__
          - __meta_kubernetes_pod_annotation_prometheus_io_port
          target_label: __address__
        - action: labelmap
          regex: __meta_kubernetes_pod_label_(.+)
        - action: replace
          source_labels:
          - __meta_kubernetes_namespace
          target_label: kubernetes_namespace
        - action: replace
          source_labels:
          - __meta_kubernetes_pod_name
          target_label: kubernetes_pod_name
        scrape_interval: 5m
        scrape_timeout: 30s
      alerting:
        alertmanagers:
        - kubernetes_sd_configs:
            - role: pod
          tls_config:
            ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
          bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
          relabel_configs:
          - source_labels: [__meta_kubernetes_namespace]
            regex: ~NAME~
            action: keep
          - source_labels: [__meta_kubernetes_pod_label_app]
            regex: prometheus
            action: keep
          - source_labels: [__meta_kubernetes_pod_label_component]
            regex: alertmanager
            action: keep
          - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_probe]
            regex: .*
            action: keep
          - source_labels: [__meta_kubernetes_pod_container_port_number]
            regex:
            action: drop
    recording_rules.yml: |
      {}
    rules: |
      {}
`;
//================================================
hpe5gResources.defaults['kube-state-metrics']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ClusterRole
  apiVersion: rbac.authorization.k8s.io/v1beta1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  rules:
  - apiGroups: ["certificates.k8s.io"]
    resources:
    - certificatesigningrequests
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - configmaps
    verbs: ["list", "watch"]
  - apiGroups: ["batch"]
    resources:
    - cronjobs
    verbs: ["list", "watch"]
  - apiGroups: ["extensions", "apps"]
    resources:
    - daemonsets
    verbs: ["list", "watch"]
  - apiGroups: ["extensions", "apps"]
    resources:
    - deployments
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - endpoints
    verbs: ["list", "watch"]
  - apiGroups: ["autoscaling"]
    resources:
    - horizontalpodautoscalers
    verbs: ["list", "watch"]
  - apiGroups: ["extensions", "networking.k8s.io"]
    resources:
    - ingresses
    verbs: ["list", "watch"]
  - apiGroups: ["batch"]
    resources:
    - jobs
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - limitranges
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - namespaces
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - nodes
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - persistentvolumeclaims
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - persistentvolumes
    verbs: ["list", "watch"]
  - apiGroups: ["policy"]
    resources:
      - poddisruptionbudgets
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - pods
    verbs: ["list", "watch"]
  - apiGroups: ["extensions", "apps"]
    resources:
    - replicasets
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - replicationcontrollers
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - resourcequotas
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - secrets
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources:
    - services
    verbs: ["list", "watch"]
  - apiGroups: ["apps"]
    resources:
    - statefulsets
    verbs: ["list", "watch"]
  - apiGroups: ["storage.k8s.io"]
    resources:
      - storageclasses
    verbs: ["list", "watch"]
- kind: ClusterRoleBinding
  apiVersion: rbac.authorization.k8s.io/v1beta1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  roleRef:
    kind: ClusterRole
    name: ~NAME~
    namespace: ~PROJECT~
    apiGroup: rbac.authorization.k8s.io
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source        
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        hostNetwork: false
        serviceAccountName: ~NAME~
        securityContext:
          fsGroup: 65534
          runAsUser: 65534
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          args:
          - --collectors=certificatesigningrequests
          - --collectors=configmaps
          - --collectors=cronjobs
          - --collectors=daemonsets
          - --collectors=deployments
          - --collectors=endpoints
          - --collectors=horizontalpodautoscalers
          - --collectors=ingresses
          - --collectors=jobs
          - --collectors=limitranges
          - --collectors=namespaces
          - --collectors=nodes
          - --collectors=persistentvolumeclaims
          - --collectors=persistentvolumes
          - --collectors=poddisruptionbudgets
          - --collectors=pods
          - --collectors=replicasets
          - --collectors=replicationcontrollers
          - --collectors=resourcequotas
          - --collectors=secrets
          - --collectors=services
          - --collectors=statefulsets
          - --collectors=storageclasses
          imagePullPolicy: IfNotPresent
          image: ~IMAGE_STREAM~
          ports:
          - containerPort: 8080
          livenessProbe:
            httpGet:
              path: /healthz
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 5
          readinessProbe:
            httpGet:
              path: /
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 5
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: "ClusterIP"
    ports:
    - name: "http"
      protocol: TCP
      port: 8080
      targetPort: 8080
    selector:
      name: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['pushgateway']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source        
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        serviceAccountName: ~NAME~
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          image: ~IMAGE_STREAM~
          ports:
            - containerPort: 9091
          livenessProbe:
            httpGet:
              path: /-/healthy
              port: 9091
            initialDelaySeconds: 10
            timeoutSeconds: 10
          readinessProbe:
            httpGet:
              path: /-/ready
              port: 9091
            initialDelaySeconds: 10
            timeoutSeconds: 10
          resources:
            {}
    selector:
      name: ~NAME~
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata: 
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    selector:
      name: ~NAME~
    ports:
      - name: http
        port: 9091
        protocol: TCP
        targetPort: 9091
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
`;
//================================================
hpe5gResources.defaults['fluentd']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: Role
  apiVersion: rbac.authorization.k8s.io/v1beta1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  rules:
  - apiGroups: ['extensions']
    resources: ['podsecuritypolicies']
    verbs:     ['use']
    resourceNames:
    - ~NAME~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template: 
      metadata:
        labels: 
          name: ~NAME~
        name: ~NAME~
      spec:
        serviceAccountName: ~NAME~
        terminationGracePeriodSeconds: 30
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          image: ~IMAGE_STREAM~
          imagePullPolicy: IfNotPresent
          env:
            - name: OUTPUT_HOST
              value: "elasticsearch-client.default.svc.cluster.local"
            - name: OUTPUT_PORT
              value: "9200"
            - name: OUTPUT_SCHEME
              value: "http"
            - name: OUTPUT_SSL_VERSION
              value: "TLSv1"
            - name: OUTPUT_BUFFER_CHUNK_LIMIT
              value: "2M"
            - name: OUTPUT_BUFFER_QUEUE_LIMIT
              value: "8"
          resources:
              {}
          ports:
            - name: monitor-agent
              containerPort: 24220
              protocol: TCP
            - name: http-input
              containerPort: 9880
              protocol: TCP
          livenessProbe:
            httpGet:
              # Use percent encoding for query param.
              # The value is {"log": "health check"}.
              # the endpoint itself results in a new fluentd
              # tag 'fluentd.pod-healthcheck'
              path: /fluentd.pod.healthcheck?json=%7B%22log%22%3A+%22health+check%22%7D
              port: 9880
            initialDelaySeconds: 5
            timeoutSeconds: 1
          volumeMounts:
            - name: ~NAME~-config
              mountPath: /etc/fluent/config.d
            - name: ~NAME~-buffer
              mountPath: "/var/log/fluentd-buffers"
        volumes:
          - name: ~NAME~-config
            configMap:
              name: ~NAME~
              defaultMode: 0777
          - name: ~NAME~-buffer
            emptyDir: {}
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    annotations:
      {}
  spec:
    type: ClusterIP
    ports:
      - name: monitor-agent
        port: 24220
        targetPort: 24220
        protocol: TCP
    selector:
      name: ~NAME~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    forward-input.conf: |-
      <source>
        @type forward
        port 24224
        bind 0.0.0.0
      </source>
      
    general.conf: |-
      # Prevent fluentd from handling records containing its own logs. Otherwise
      # it can lead to an infinite loop, when error in sending one message generates
      # another message which also fails to be sent and so on.
      <match fluentd.**>
        @type null
      </match>
      
      # Used for health checking
      <source>
        @type http
        port 9880
        bind 0.0.0.0
      </source>
      
      # Emits internal metrics to every minute, and also exposes them on port
      # 24220. Useful for determining if an output plugin is retryring/erroring,
      # or determining the buffer queue length.
      <source>
        @type monitor_agent
        bind 0.0.0.0
        port 24220
        tag fluentd.monitor.metrics
      </source>
      
    output.conf: |-
      <match **>
        @id elasticsearch
        @type elasticsearch
        @log_level info
        include_tag_key true
        # Replace with the host/port to your Elasticsearch cluster.
        host "#{ENV['OUTPUT_HOST']}"
        port "#{ENV['OUTPUT_PORT']}"
        scheme "#{ENV['OUTPUT_SCHEME']}"
        ssl_version "#{ENV['OUTPUT_SSL_VERSION']}"
        logstash_format true
        <buffer>
        @type file
      	path /var/log/fluentd-buffers/kubernetes.system.buffer
      	flush_mode interval
      	retry_type exponential_backoff
      	flush_thread_count 2
      	flush_interval 5s
      	retry_forever
      	retry_max_interval 30
      	chunk_limit_size "#{ENV['OUTPUT_BUFFER_CHUNK_LIMIT']}"
      	queue_limit_length "#{ENV['OUTPUT_BUFFER_QUEUE_LIMIT']}"
      	overflow_action block
        </buffer>
      </match>
      
    system.conf: |-
      <system>
        root_dir /tmp/fluentd-buffers/
      </system>
`;
//================================================
hpe5gResources.defaults['grafana']['template']=
//================================================
`
- kind: ServiceAccount
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
- kind: RoleBinding
  apiVersion: authorization.openshift.io/v1
  metadata:
    name: ~NAME~-view
    namespace: ~PROJECT~
  roleRef:
    kind: Role
    name: view
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: PodSecurityPolicy
  apiVersion: policy/v1beta1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
    annotations:
      seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default'
      seccomp.security.alpha.kubernetes.io/defaultProfileName:  'docker/default'
      apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
      apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
  spec:
    privileged: false
    allowPrivilegeEscalation: false
    requiredDropCapabilities:
      # Default set from Docker, without DAC_OVERRIDE or CHOWN
      - FOWNER
      - FSETID
      - KILL
      - SETGID
      - SETUID
      - SETPCAP
      - NET_BIND_SERVICE
      - NET_RAW
      - SYS_CHROOT
      - MKNOD
      - AUDIT_WRITE
      - SETFCAP
    volumes:
      - 'configMap'
      - 'emptyDir'
      - 'projected'
      - 'secret'
      - 'downwardAPI'
      - 'persistentVolumeClaim'
    hostNetwork: false
    hostIPC: false
    hostPID: false
    runAsUser:
      rule: 'RunAsAny'
    seLinux:
      rule: 'RunAsAny'
    supplementalGroups:
      rule: 'RunAsAny'
    fsGroup:
      rule: 'RunAsAny'
    readOnlyRootFilesystem: false
- kind: Secret
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  type: Opaque
  stringData:
    admin-user: "admin"
    admin-password: "~NAME~"
    ldap-toml: ""
- kind: Role
  apiVersion: rbac.authorization.k8s.io/v1beta1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  rules:
  - apiGroups:      ['extensions']
    resources:      ['podsecuritypolicies']
    verbs:          ['use']
    resourceNames:  [~NAME~]
- kind: RoleBinding
  apiVersion: rbac.authorization.k8s.io/v1beta1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: Role
    name: ~NAME~
  subjects:
  - kind: ServiceAccount
    name: ~NAME~
    namespace: ~PROJECT~
- kind: ImageStream
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
      from:
        kind: DockerImage
        name: ~IMAGE_STREAM~
      generation: 1
      importPolicy: {}
      name: ""
      referencePolicy:
        type: Source
- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    template:
      metadata:
        labels:
          app.kubernetes.io/name: ~NAME~
          app.kubernetes.io/instance: ~PROJECT~
        annotations:
          checksum/config: 4475028f2c9539fd7734add184328dab2f3276bb67234eaa341bf31148a57a95
          checksum/dashboards-json-config: 01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b
          checksum/sc-dashboard-provider-config: 01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b
          checksum/secret: ce5751f7f7d101eaf061a9daac6dcc70a2aced1e3099af5448c3fe23c66dd633
      spec:
        serviceAccountName: ~NAME~
        securityContext:
          fsGroup: 472
          runAsUser: 472
        containers:
        - name: ~NAME~
          namespace: ~PROJECT~
          image: ~IMAGE_STREAM~
          env:
            - name: GF_SECURITY_ADMIN_USER
              valueFrom:
                secretKeyRef:
                  name: ~NAME~
                  key: admin-user
            - name: GF_SECURITY_ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: ~NAME~
                  key: admin-password
          ports:
            - name: service
              containerPort: 80
              protocol: TCP
            - name: grafana
              containerPort: 3000
              protocol: TCP
          volumeMounts:
            - name: ~NAME~-config
              namespace: ~PROJECT~
              mountPath: "/etc/grafana/grafana.ini"
              subPath: grafana.ini
            - name: ~NAME~-storage
              mountPath: "/var/lib/grafana"
          livenessProbe:
            failureThreshold: 10
            httpGet:
              path: /api/health
              port: 3000
            initialDelaySeconds: 60
            timeoutSeconds: 30
          readinessProbe:
            httpGet:
              path: /api/health
              port: 3000
          resources:
            {}
        volumes:
          - name: ~NAME~-config
            namespace: ~PROJECT~
            configMap:
              name: ~NAME~
          - name: ~NAME~-storage
            emptyDir: {}
    replicas: ~REPLICAS~
- kind: Service
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    type: ClusterIP
    ports:
      - name: service
        port: 80
        protocol: TCP
        targetPort: 3000
    selector:
      app.kubernetes.io/name: ~NAME~
      app.kubernetes.io/instance: ~PROJECT~
- kind: Route
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    to:
      kind: Service
      name: ~NAME~
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  data:
    grafana.ini: |
      [analytics]
      check_for_updates = true
      [grafana_net]
      url = https://grafana.net
      [log]
      mode = console
      [paths]
      data = /var/lib/grafana/data
      logs = /var/log/grafana
      plugins = /var/lib/grafana/plugins
      provisioning = /etc/grafana/provisioning
`;
//================================================
hpe5gResources.defaults['jaeger']['template']=
//================================================
`
- kind: Jaeger
  apiVersion: jaegertracing.io/v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
`;
//================================================
hpe5gResources.defaults['kiali']['template']=
//================================================
`
- kind: MonitoringDashboard
  apiVersion: monitoring.kiali.io/v1alpha1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    title: My App Dashboard
    items:
      - chart:
        name: My App Processing Duration
        unit: seconds
        spans: 6
        metricName: my_app_duration_seconds
        dataType: histogram
        aggregations:
          - label: id
            displayName: ID
`;
//================================================
hpe5gResources.defaults['svc-mesh-ctlplane']['template']=
//================================================
`
- kind: ServiceMeshControlPlane
  apiVersion: maistra.io/v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    istio:
      gateways:
        istio-egressgateway:
          autoscaleEnabled: false
        istio-ingressgateway:
          autoscaleEnabled: false
      mixer:
        policy:
          autoscaleEnabled: false
        telemetry:
          autoscaleEnabled: false
      pilot:
        autoscaleEnabled: false
        traceSampling: 100
      kiali:
        enabled: true
      grafana:
        enabled: true
      tracing:
        enabled: true
        jaeger:
          template: all-in-one
`;
//================================================
hpe5gResources.defaults['kafka']['template']=
//================================================
`
- kind: Kafka
  apiVersion: kafka.strimzi.io/v1beta1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    kafka:
      version: 2.4.0
      replicas: 3
      listeners:
        plain: {}
        tls: {}
      config:
        offsets.topic.replication.factor: 3
        transaction.state.log.replication.factor: 3
        transaction.state.log.min.isr: 2
        log.message.format.version: '2.4'
      storage:
        type: ephemeral
    zookeeper:
      replicas: 3
      storage:
        type: ephemeral
    entityOperator:
      topicOperator: {}
      userOperator: {}
`;
//================================================
hpe5gResources.defaults['elasticSearchOperator']['template']=
//================================================
`
- kind: Elasticsearch
  apiVersion: logging.openshift.io/v1
  metadata:
    name: ~NAME~
    namespace: ~PROJECT~
  spec:
    managementState: Managed
    nodeSpec:
      image: >-
        registry.redhat.io/openshift4/ose-logging-elasticsearch5@sha256:7ec49695f518ffab41e97fd2eb3c6ce79a4237cf537f6202ee35dbebcbecf444
      resources:
        limits:
          memory: 1Gi
        requests:
          memory: 512Mi
    redundancyPolicy: SingleRedundancy
    nodes:
      - nodeCount: 1
        roles:
          - client
          - data
          - master
`;
</script>


</body>